(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105252,       2748]
NotebookOptionsPosition[     93922,       2576]
NotebookOutlinePosition[     94259,       2591]
CellTagsIndexPosition[     94216,       2588]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["From Giulio and Tim:", "Section",
 CellChangeTimes->{{3.7708127104307947`*^9, 
  3.7708127225333347`*^9}},ExpressionUUID->"7331da9b-b925-4dd3-8495-\
7eb515484d10"],

Cell[CellGroupData[{

Cell["General:", "Subsection",
 CellChangeTimes->{{3.7709144432629547`*^9, 
  3.770914445573207*^9}},ExpressionUUID->"408358db-aa51-4816-abf9-\
7a8cd577489b"],

Cell[BoxData[
 RowBox[{"WolframLanguageData", "[", 
  RowBox[{"\"\<Exp\>\"", ",", "\"\<DocumentationExampleInputs\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.770813433517725*^9, {3.770984328640039*^9, 
   3.770984332011497*^9}},ExpressionUUID->"060d984e-2d88-42ac-a8b3-\
544f57902d7d"],

Cell[BoxData[
 RowBox[{"SyntaxInformation", "[", "Exp", "]"}]], "Input",
 CellChangeTimes->{{3.7708134385892553`*^9, 3.7708134589607162`*^9}, {
  3.770984336204373*^9, 3.770984336709324*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defined functions:", "Subsection",
 CellChangeTimes->{{3.7709144516420717`*^9, 
  3.770914456220595*^9}},ExpressionUUID->"21c511ce-cd28-4abe-8aef-\
bb58362f5c9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseString", "[", "str_String", "]"}], ":=", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flattenParse", "[", "exp_", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{"exp", ",", " ", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "anything___", "}"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"{", "anything", "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.770983991852192*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"makeExpressionString", ",", " ", 
   RowBox[{"{", "HoldFirst", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeExpressionString", "[", "exp_", "]"}], ":=", 
  RowBox[{"StringTake", "[", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"HoldComplete", "[", "exp", "]"}], ",", " ", "InputForm"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"StringLength", "[", "\"\<HoldComplete[\>\"", "]"}], "+", 
       "1"}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"StringLength", "[", "\"\<]\>\"", "]"}]}], "-", "1"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio regarding parsing:", "Section",
 CellChangeTimes->{{3.7710091399881973`*^9, 
  3.771009166068852*^9}},ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-\
4a5d84b2a192"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"parseInput", ",", "takepart"}], "]"}]], "Input",
 CellChangeTimes->{{3.771016726184655*^9, 3.771016734149858*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"a43fdc57-cc7e-47e5-86a2-072480d9bb27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseInput", "[", "str_String", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"RowBox", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ",", 
     RowBox[{"\"\< \>\"", "\[RuleDelayed]", " ", "Nothing"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771071449483674*^9, 3.771071477236809*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"takepart", "[", 
   RowBox[{"expr_String", ",", "level_Integer"}], "]"}], ":=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"level", "[", 
     RowBox[{
      RowBox[{"parseInput", "[", "expr", "]"}], ",", 
      RowBox[{"{", "level", "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x_", "/;", 
      RowBox[{"!", 
       RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
     RowBox[{"Head", "[", "x", "]"}]}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771016789391432*^9, 3.771016790676392*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"11cb3a39-056b-4148-a563-87f74e3992e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"good", "=", "\"\<f[1,g[1,2],3]\>\""}], ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"51fca234-32cb-4dc6-9e78-4d0b880c29a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bad", "=", "\"\<f[1,g[1,2,3]\>\""}], ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"198a1d36-9964-49f9-b2ab-c65a496fbe21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"correction1", "=", "\"\<f[1,g[1,2,3]]\>\""}], ";"}]], "Input",Expre\
ssionUUID->"43e32ac9-bd62-49c9-914d-c50aa29f5bfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"correction2", "=", "\"\<f[1,g[1,2],3]\>\""}], ";"}]], "Input",Expre\
ssionUUID->"d696c5ff-59aa-42c7-ba9c-3549ef217038"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7710162208267393`*^9, 3.7710162517166643`*^9}, {
  3.771016566944702*^9, 
  3.771016657930585*^9}},ExpressionUUID->"2d7e8ce8-16f5-45a6-ade6-\
141021eb3e3e"],

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{"Level", "[", 
    RowBox[{
     RowBox[{"parseInput", "[", "\"\<Exp[1+2Sin[x]]\>\"", "]"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x_", "/;", 
     RowBox[{"!", 
      RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
    RowBox[{"Head", "[", "x", "]"}]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771016289020914*^9, 3.7710163460571957`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"a4244665-0e2e-409a-8d98-0ad0578c9b2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Level", "[", 
     RowBox[{
      RowBox[{"parseInput", "[", "\"\<Exp[1+2Sin[x]]\>\"", "]"}], ",", 
      RowBox[{"{", "4", "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x_", "/;", 
      RowBox[{"!", 
       RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
     RowBox[{"Head", "[", "x", "]"}]}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.771016361433631*^9, 3.771016531555232*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"50aae130-1491-44cc-ad1a-ec24bf620f4f"],

Cell[BoxData["\<\"Sin\"\>"], "Output",
 CellChangeTimes->{{3.771016291993507*^9, 3.771016346869382*^9}, {
  3.771016426445703*^9, 3.771016532093939*^9}},
 CellLabel->
  "Out[167]=",ExpressionUUID->"c67c058d-c55e-4415-b4d5-651447ed1fea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpression", "=", " ", 
   RowBox[{"parseInput", "@", "\"\<Exp[1+2Sin[x]]\>\""}]}], ";", 
  RowBox[{"myexpression", "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.7710095162738028`*^9, 3.771009524082501*^9}, {
  3.7710095551494083`*^9, 3.7710095795558777`*^9}, {3.7710096191892843`*^9, 
  3.771009795696598*^9}, {3.771009826849687*^9, 3.771009873237158*^9}, {
  3.771009968676758*^9, 3.771010170646742*^9}, {3.771010216382496*^9, 
  3.7710102347426853`*^9}, {3.771010339109809*^9, 3.771010579862664*^9}, {
  3.77101063410833*^9, 3.771010638986834*^9}, {3.771010669332863*^9, 
  3.771010729355112*^9}, {3.77101664093419*^9, 3.771016664018055*^9}, {
  3.771071334857849*^9, 3.7710713900232153`*^9}, {3.771071485827303*^9, 
  3.771071515613822*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"dff6ae74-0581-4d40-8836-3ba83559d7e3"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.071008320943125, 2.8560221891816666`}, {0., 
    2.14201664188625}, {0.7140055472954167, 2.14201664188625}, {
    1.4280110945908333`, 2.14201664188625}, {0.7140055472954167, 
    1.4280110945908333`}, {1.4280110945908333`, 1.4280110945908333`}, {
    2.14201664188625, 1.4280110945908333`}, {1.7850138682385417`, 
    0.7140055472954168}, {2.4990194155339585`, 0.7140055472954168}, {
    1.4280110945908333`, 0.}, {2.14201664188625, 0.}, {2.8560221891816666`, 
    0.}, {3.5700277364770834`, 0.}, {2.14201664188625, 2.14201664188625}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 14}, {4, 5}, {4, 6}, {4, 7}, {7, 
       8}, {7, 9}, {9, 10}, {9, 11}, {9, 12}, {9, 13}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Exp\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"1\"", ",", "\"+\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"2\"", ",", 
                    RowBox[{"{", 
                    
                    RowBox[{
                    "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
                    "}"}]}], "}"}]}], "}"}], ",", "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "Exp", "[", {"1", "+", {"2", {"Sin", "[", "x", "]"}}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Exp\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Exp\"", HoldForm]],
       Annotation[#, 
        HoldForm["Exp"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"1\"", ",", "\"+\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"2\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
                   "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"1", "+", {"2", {"Sin", "[", "x", "]"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"2\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
               "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"2", {"Sin", "[", "x", "]"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Sin", "[", "x", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Sin\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"Sin\"", HoldForm]],
       Annotation[#, 
        HoldForm["Sin"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.071008320943125, 2.8560221891816666`}, {0., 
     2.14201664188625}, {0.7140055472954167, 2.14201664188625}, {
     1.4280110945908333`, 2.14201664188625}, {0.7140055472954167, 
     1.4280110945908333`}, {1.4280110945908333`, 1.4280110945908333`}, {
     2.14201664188625, 1.4280110945908333`}, {1.7850138682385417`, 
     0.7140055472954168}, {2.4990194155339585`, 0.7140055472954168}, {
     1.4280110945908333`, 0.}, {2.14201664188625, 0.}, {2.8560221891816666`, 
     0.}, {3.5700277364770834`, 0.}, {2.14201664188625, 2.14201664188625}}]& ],
  AspectRatio->NCache[Rational[1, 3] 10^Rational[1, 2], 1.0540925533894598`],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.77107133559901*^9, 3.7710713906148787`*^9}, {
   3.771071495006576*^9, 3.771071516363367*^9}, 3.771071631256874*^9},
 CellLabel->
  "Out[12]//TreeForm=",ExpressionUUID->"45ff1f3b-050f-4ce0-9630-c0fffacf7b62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{"Level", "[", 
    RowBox[{"myexpression", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x_", "/;", 
     RowBox[{"!", 
      RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
    RowBox[{"Head", "[", "x", "]"}]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771071718918788*^9, 3.771071732924155*^9}, {
  3.7710718151015167`*^9, 
  3.7710718260059767`*^9}},ExpressionUUID->"550114f3-fb63-4024-b85a-\
07bb014e815c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>", 
   ",", "\<\"]\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.771071722717263*^9, 3.7710717339021797`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"3de974f7-0a6d-4658-9af0-267afbc84d52"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Maybe", " ", "use", " ", "with", " ", "here"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.771071907042145*^9, 
  3.771071915054063*^9}},ExpressionUUID->"9b43ac08-d9bf-4efd-809a-\
0ae25f194f77"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7710719159704857`*^9, 
  3.7710719447039537`*^9}},ExpressionUUID->"643966d6-994a-45b0-93c8-\
645503c9f93a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getlevels", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"el", "=", "n"}], "}"}], ",", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"Level", "[", 
       RowBox[{"myexpression", ",", 
        RowBox[{"{", "el", "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x_", "/;", 
        RowBox[{"!", 
         RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
       RowBox[{"Head", "[", "x", "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7710191701613207`*^9, 3.7710191876987677`*^9}, {
  3.771019223056572*^9, 3.771019223738312*^9}, {3.771071641072381*^9, 
  3.7710716558175173`*^9}, {3.7710718970095787`*^9, 3.771071950565898*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"getlevels", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"Depth", "[", 
      RowBox[{"myexpression", "-", "1"}], "]"}], "]"}], "]"}], "]"}], "//", 
  "Column"}]], "Input",
 CellChangeTimes->{{3.771071678241129*^9, 3.771071681210932*^9}, {
  3.771071959730679*^9, 3.7710720080046167`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"da45fadf-72cd-4183-929d-a6197a74b37f"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "List", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"1\"\>", ",", "\<\"+\"\>", ",", "List"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"2\"\>", ",", "List"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.7710716819172077`*^9, {3.771071955035328*^9, 3.77107197168258*^9}, {
   3.7710720034111423`*^9, 3.771072008469898*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"df410961-8b3f-44b4-99fa-1b9965b80d09"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create simple expression to play with:", "Section",
 CellChangeTimes->{{3.770813482953951*^9, 3.770813498975895*^9}, {
  3.771009078616447*^9, 
  3.771009100230598*^9}},ExpressionUUID->"71190df2-94a5-46bf-b001-\
1367a76e379e"],

Cell["Choose an expression, then remove the final bracket for now:", "Text",
 CellChangeTimes->{{3.770815296126754*^9, 3.770815306085696*^9}, {
  3.770815521673751*^9, 
  3.7708155324852877`*^9}},ExpressionUUID->"c9a7a2e6-cd90-43f5-ba7c-\
c792e70e6afb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myexpressionstring", " ", "=", " ", 
  "\"\<Exp[1+2 Sin[x]]\>\""}]], "Input",
 CellChangeTimes->{{3.770815281128812*^9, 3.7708152920825777`*^9}, {
   3.770815467467495*^9, 3.7708154845096292`*^9}, 3.770912102793528*^9, {
   3.770914004930232*^9, 3.770914005919696*^9}, {3.770977900442531*^9, 
   3.770977903059123*^9}, {3.770993496423938*^9, 3.770993501519432*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"46628cd0-eec0-4846-a8fc-f8d4ece96e37"],

Cell[BoxData["\<\"Exp[1+2 Sin[x]]\"\>"], "Output",
 CellChangeTimes->{
  3.770984608062821*^9, {3.77099349937355*^9, 3.7709935034615726`*^9}, 
   3.770996145995708*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"8fd2e6e7-b100-45ee-9bbb-e6a9c2e4758d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"myexpressionstring", " ", "=", " ", 
  "\"\<Exp[Sin[x]]\>\""}]], "Input",
 CellChangeTimes->{{3.770914324164577*^9, 3.7709143289445333`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"011150ec-078f-446c-8167-5a7e3e13af03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bracketpositions", "=", 
  RowBox[{"StringPosition", "[", 
   RowBox[{"myexpressionstring", ",", "\"\<]\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.770815316895523*^9, 3.770815317667819*^9}, {
  3.770815348318055*^9, 3.770815351975916*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"f63ea524-19a4-4874-96a1-3571a6464e48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"14", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "15"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.770984611471843*^9, 3.770996149602768*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"4815923f-93ec-4ab4-892e-5ccf32a57e59"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"brackettodrop", "=", 
  RowBox[{"bracketpositions", "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.77081535666609*^9, 3.7708154081610317`*^9}, {
  3.770815497317651*^9, 3.7708155119962463`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"c775def0-0982-419c-af1d-e87aba102a53"],

Cell[BoxData[
 RowBox[{"mybrokenexpressionstring", "=", " ", 
  RowBox[{"StringDrop", "[", 
   RowBox[{"myexpressionstring", ",", "brackettodrop"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7708154212265882`*^9, 3.770815448577159*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"3e00fede-1dea-41c7-996c-17405c4894bd"],

Cell[BoxData[
 RowBox[{"flattenParse", "@", 
  RowBox[{"parseString", "[", "mybrokenexpressionstring", "]"}]}]], "Input",
 CellChangeTimes->{{3.770813821237262*^9, 3.770813822004253*^9}, 
   3.770814985374545*^9, {3.770815540704009*^9, 3.77081554557968*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"2d8ae4b4-c39f-4e84-a120-e08d6f32d9b5"],

Cell[BoxData[
 RowBox[{"myexpression", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"flattenParse", "@", 
     RowBox[{"parseString", "[", "mybrokenexpressionstring", "]"}]}], ",", 
    "\"\<  \>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.77081382639427*^9, 3.770813827678027*^9}, {
  3.770813909402381*^9, 3.770813910065943*^9}, {3.770815000147097*^9, 
  3.770815020345461*^9}, {3.7708155669831944`*^9, 3.770815568539487*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"300967d1-08b6-4b84-a2b7-bd45b9f44ad9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myexpression", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"flattenParse", "@", 
     RowBox[{"parseString", "[", "myexpressionstring", "]"}]}], ",", 
    "\"\< \>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.77092919851292*^9, 3.770929200348029*^9}, {
   3.770977937381341*^9, 3.770977943392993*^9}, 3.7709779865094976`*^9, {
   3.7709846386499243`*^9, 3.770984654562975*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"52ebedf2-499a-4415-8c6d-1d5fa307e131"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "\<\"1\"\>", ",", "\<\"+\"\>",
    ",", "\<\"2\"\>", ",", "\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>", 
   ",", "\<\"]\"\>", ",", "\<\"]\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.7709846404982157`*^9, 3.770984655409246*^9}, 
   3.770996154420992*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"aecf7a3a-14c2-4794-8b74-96fe934ca8e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "[", "myexpression", "]"}]], "Input",
 CellChangeTimes->{{3.771000282893855*^9, 3.7710002949173183`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"2b5c3bee-a711-4649-97eb-19d750d5572c"],

Cell[BoxData["\<\"Exp[1+2Sin[x]]\"\>"], "Output",
 CellChangeTimes->{3.7710002952098923`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"714fddd2-bb62-47e1-9eef-f8c58b4aabdf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"parseString", "[", "myexpressionstring", "]"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"932b0683-ded0-4a58-8e28-bdc5b45c6d15"],

Cell[BoxData["myexpression"], "Input",
 CellChangeTimes->{{3.7708155854326067`*^9, 3.770815587116352*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"03882fba-808b-45b0-b72b-c3974be60c96"],

Cell["\<\
Tim said, that every time a [ is found, go a level down. Try to do that. \
\>", "Text",
 CellChangeTimes->{{3.770815644950655*^9, 
  3.7708156702114162`*^9}},ExpressionUUID->"95b6b530-0def-43d7-afa1-\
3bc990d978d2"],

Cell["\<\
Or maybe start with turning the function names from String to objects\
\>", "Text",
 CellChangeTimes->{{3.770815799013185*^9, 
  3.7708158194568443`*^9}},ExpressionUUID->"2a08daa1-62e4-42d0-9b83-\
70ae9ab28b6e"],

Cell[BoxData[
 RowBox[{"positions", "=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{"myexpression", ",", 
     RowBox[{"_", "?", "NameQ"}]}], "]"}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.770913918454373*^9, 3.770913934275992*^9}, {
  3.770930889785758*^9, 3.770930895064518*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"298590ef-dc48-4f5b-bb0d-cc1354995387"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myexpression", "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.770996479493507*^9, 3.77099648288275*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"11ddb293-ce32-4c14-b68e-ea11956ecbcd"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.4795908857482156`, 0.3287979746107146}, {0., 
    0.}, {0.3287979746107146, 0.}, {0.6575959492214292, 0.}, {
    0.9863939238321437, 0.}, {1.3151918984428583`, 0.}, {1.643989873053573, 
    0.}, {1.9727878476642875`, 0.}, {2.301585822275002, 0.}, {
    2.6303837968857167`, 0.}, {2.9591817714964312`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {1, 
       9}, {1, 10}, {1, 11}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           
           RowBox[{"\"Exp\"", ",", "\"[\"", ",", "\"1\"", ",", "\"+\"", ",", 
             "\"2\"", ",", "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", 
             "\"]\"", ",", "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Exp", "[", "1", "+", "2", "Sin", "[", "x", "]", "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Exp\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Exp\"", HoldForm]],
       Annotation[#, 
        HoldForm["Exp"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Sin\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"Sin\"", HoldForm]],
       Annotation[#, 
        HoldForm["Sin"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.4795908857482156`, 0.3287979746107146}, {0., 
     0.}, {0.3287979746107146, 0.}, {0.6575959492214292, 0.}, {
     0.9863939238321437, 0.}, {1.3151918984428583`, 0.}, {1.643989873053573, 
     0.}, {1.9727878476642875`, 0.}, {2.301585822275002, 0.}, {
     2.6303837968857167`, 0.}, {2.9591817714964312`, 0.}}]& ],
  AspectRatio->NCache[Rational[2, 7]^Rational[1, 2], 0.5345224838248488],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.770996483172558*^9},
 CellLabel->
  "Out[19]//TreeForm=",ExpressionUUID->"08d6fd38-db67-4a47-8e69-dda6923d0aa8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"StringCount", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<1\>\"", ",", "\"\<+\>\"", ",", "\"\<2\>\"", ",", "\"\<Sin\>\"", 
      ",", "\"\<[\>\"", ",", "\"\<x\>\"", ",", "\"\<[\>\""}], "}"}], ",", 
    "\"\<[\>\""}], "]"}], "//", "Total"}]], "Input",
 CellChangeTimes->{{3.77099763590792*^9, 3.77099767635133*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"25bf150a-f59a-49e4-a8c5-9e1099d6338b"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.7709976525530787`*^9, 3.7709976769865103`*^9}},
 CellLabel->"Out[36]=",ExpressionUUID->"4fabd24d-167d-4c63-9748-65580ab06cab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<1\>\"", ",", "\"\<+\>\"", ",", "\"\<2\>\"", ",", "\"\<Sin\>\"", ",", 
     "\"\<[\>\"", ",", "\"\<x\>\""}], "}"}], ",", "\"\<[\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7709975957490883`*^9, 3.770997626701418*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"c135a756-fa82-4562-8392-addc9a4c9259"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "\<\"[\"\>", "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7709976275330963`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"4c579a3c-8322-4dea-8134-c55882bf2fb1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7709977926657867`*^9, 
  3.7709978420746517`*^9}},ExpressionUUID->"37a8f7ec-2443-4e3f-a759-\
056326078a28"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Playing with the expression:", "Section",
 CellChangeTimes->{{3.770978538180853*^9, 
  3.7709785494279623`*^9}},ExpressionUUID->"736a9492-35c5-4506-8855-\
124c39458c73"],

Cell[CellGroupData[{

Cell[BoxData["myexpression"], "Input",
 CellChangeTimes->{{3.770998681379242*^9, 3.770998683042037*^9}, {
  3.770999735697955*^9, 3.77099975927521*^9}, {3.770999876987673*^9, 
  3.7709998772095957`*^9}},ExpressionUUID->"8ee43984-72ba-409e-95e1-\
cb28e7692ce8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "\<\"1\"\>", ",", "\<\"+\"\>",
    ",", "\<\"2\"\>", ",", "\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>", 
   ",", "\<\"]\"\>", ",", "\<\"]\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.770998683629403*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"04096016-9f6d-4d96-aacb-29427d8918cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Continue with this one:", "Subsection",
 CellChangeTimes->{{3.770999712191401*^9, 
  3.77099972305056*^9}},ExpressionUUID->"6ad86900-a0f0-470f-8f4a-\
a8003f8ae5b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpression", "/.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"head_", "[", 
      RowBox[{"before___", ",", "function_", ",", 
       RowBox[{"\"\<[\>\"", "_"}], ",", "body___", ",", " ", 
       RowBox[{"\"\<]\>\"", "_"}], ",", "after___"}], "]"}], "/;", "   ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "body", "}"}], "]"}], ">", "0"}], ",", " ", 
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "body", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Total", "@", 
               RowBox[{"StringCount", "[", 
                RowBox[{
                 RowBox[{"{", "body", "}"}], ",", "\"\<[\>\""}], "]"}]}], ",", 
              RowBox[{"Total", "@", 
               RowBox[{"StringCount", "[", 
                RowBox[{
                 RowBox[{"{", "body", "}"}], ",", "\"\<]\>\""}], "]"}]}]}], 
             "}"}]}], "}"}], ",", "\"\<Before:\>\""}], "]"}]}], "]"}], "&&", 
      " ", 
      RowBox[{
       RowBox[{"Total", "@", 
        RowBox[{"StringCount", "[", 
         RowBox[{
          RowBox[{"{", "body", "}"}], ",", "\"\<[\>\""}], "]"}]}], "\[Equal]",
        " ", 
       RowBox[{"Total", "@", 
        RowBox[{"StringCount", "[", 
         RowBox[{
          RowBox[{"{", "body", "}"}], ",", "\"\<]\>\""}], "]"}]}]}], "  ", "&&",
       " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "body", "}"}], "]"}], ">", "0"}], ",", " ", 
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<head:\>\"", ",", "head", ",", "\"\<before:\>\"", ",", 
            "before", ",", "\"\<function:\>\"", ",", "function", ",", 
            "\"\<openbracket:\>\"", ",", "openbracket", ",", "\"\<body:\>\"", 
            ",", "body", ",", "\"\<closebracket:\>\"", ",", "closebracket", 
            ",", "\"\<after:\>\"", ",", "after"}], "}"}], ",", 
          "\"\<After:\>\""}], "]"}]}], "]"}]}]}], "\[Rule]", 
    RowBox[{"head", "[", 
     RowBox[{"before", ",", 
      RowBox[{"function", "[", 
       RowBox[{"openbracket", ",", "body", ",", "closebracket"}], "]"}], ",", 
      "after"}], "]"}]}]}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQre3nvXuWxBvHI396j4LoZW8jboHoq4r890F0yo3o
xyB6ymLjdyCaq1GGazaQ3nwvRAVEp9bP0gDRd+pP64HoPxd03UC0TFc8mL5e
FRAIoj+EnA8H0duyMuJBtKZBRiKIPvFSIg1Eay/JyATRi1auLAfRtT8a60H0
D5PjXSA6Nv7iMhDNoZC4FkTrnVq4DUR7mKofAdubvBFM++yfcgLM55l7Hsyf
Z3sDRE9QDHkCogPy7nLPAdLpLvZ8IHrGkiUKINrt/h8tEJ0/75k5iDaXemsJ
ohfJrJwEoh/svzcFRAMAukGWKQ==
  
  "],ExpressionUUID->"28585982-ed80-4871-a187-50e8afc19875"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Before:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"1\"\>", ",", "\<\"+\"\>", ",", "\<\"2\"\>", 
      ",", "\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.770999247924795*^9},ExpressionUUID->"5701708f-845a-495d-901a-\
b8f8146f7e9f"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Before:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"1\"\>", ",", "\<\"+\"\>", ",", "\<\"2\"\>", 
      ",", "\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>", 
      ",", "\<\"]\"\>"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.770999248006796*^9},ExpressionUUID->"0ee85351-4757-44fe-a26a-\
7b274334836f"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"After:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{"\<\"head:\"\>", ",", "List", ",", "\<\"before:\"\>", 
    ",", "\<\"function:\"\>", ",", "\<\"Exp\"\>", ",", "\<\"openbracket:\"\>",
     ",", "\<\"[\"\>", ",", "\<\"body:\"\>", ",", "\<\"1\"\>", 
    ",", "\<\"+\"\>", ",", "\<\"2\"\>", ",", "\<\"Sin\"\>", ",", "\<\"[\"\>", 
    ",", "\<\"x\"\>", ",", "\<\"]\"\>", ",", "\<\"closebracket:\"\>", 
    ",", "\<\"]\"\>", ",", "\<\"after:\"\>"}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.7709992480428143`*^9},ExpressionUUID->"5b054c09-4f93-4bad-8d1e-\
6d2418fb2377"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Before:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "\<\"x\"\>", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.770999248118355*^9},ExpressionUUID->"1a6cb0ce-c2a2-4257-94c1-\
61b7db58ff97"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"After:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{"\<\"head:\"\>", ",", "List", ",", "\<\"before:\"\>", 
    ",", "\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "\<\"1\"\>", ",", "\<\"+\"\>", 
    ",", "\<\"2\"\>", ",", "\<\"function:\"\>", ",", "\<\"Sin\"\>", 
    ",", "\<\"openbracket:\"\>", ",", "\<\"[\"\>", ",", "\<\"body:\"\>", 
    ",", "\<\"x\"\>", ",", "\<\"closebracket:\"\>", ",", "\<\"]\"\>", 
    ",", "\<\"after:\"\>", ",", "\<\"]\"\>"}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.770999248149734*^9},ExpressionUUID->"c516bc76-b659-4e4c-95d6-\
97d65d35731c"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Before:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"x\"\>", ",", "\<\"]\"\>"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.770999248221575*^9},ExpressionUUID->"ca615058-42fa-41f0-b691-\
febbce00e962"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.4795908857482156`, 0.3287979746107146}, {0., 
    0.}, {0.3287979746107146, 0.}, {0.6575959492214292, 0.}, {
    0.9863939238321437, 0.}, {1.3151918984428583`, 0.}, {1.643989873053573, 
    0.}, {1.9727878476642875`, 0.}, {2.301585822275002, 0.}, {
    2.6303837968857167`, 0.}, {2.9591817714964312`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {1, 
       9}, {1, 10}, {1, 11}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           
           RowBox[{"\"Exp\"", ",", "\"[\"", ",", "\"1\"", ",", "\"+\"", ",", 
             "\"2\"", ",", "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", 
             "\"]\"", ",", "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Exp", "[", "1", "+", "2", "Sin", "[", "x", "]", "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Exp\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Exp\"", HoldForm]],
       Annotation[#, 
        HoldForm["Exp"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Sin\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"Sin\"", HoldForm]],
       Annotation[#, 
        HoldForm["Sin"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.4795908857482156`, 0.3287979746107146}, {0., 
     0.}, {0.3287979746107146, 0.}, {0.6575959492214292, 0.}, {
     0.9863939238321437, 0.}, {1.3151918984428583`, 0.}, {1.643989873053573, 
     0.}, {1.9727878476642875`, 0.}, {2.301585822275002, 0.}, {
     2.6303837968857167`, 0.}, {2.9591817714964312`, 0.}}]& ],
  AspectRatio->NCache[Rational[2, 7]^Rational[1, 2], 0.5345224838248488],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.77099786646943*^9, 3.770997895344548*^9}, {
   3.770997957654481*^9, 3.770998034512847*^9}, 3.770998072943287*^9, 
   3.7709981290244837`*^9, 3.770998168584175*^9, 3.770998202672146*^9, {
   3.770998369533372*^9, 3.770998397845991*^9}, {3.7709985528179407`*^9, 
   3.770998563726655*^9}, 3.770998899279352*^9, 3.770999055062265*^9, {
   3.770999091459029*^9, 3.7709991290144987`*^9}, {3.770999232208767*^9, 
   3.770999248251752*^9}},
 CellLabel->
  "Out[66]//TreeForm=",ExpressionUUID->"e8b09dd6-d570-4cfa-b008-bfd04804b071"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"myexpression", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.770978187433042*^9, 3.770978210089719*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"2f97b97c-a951-4a48-8700-3087ea4d1bfa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpression", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"head_", "[", 
      RowBox[{
      "before___", ",", "function_", ",", "openbracket_", ",", "body___", ",",
        "closebracket_", ",", "otherclosebracket___", ",", "after___"}], 
      "]"}], "/;", 
     RowBox[{
      RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
      RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}], "&&", " ", 
      RowBox[{"otherclosebracket", "\[Equal]", "\"\<]\>\""}]}]}], " ", 
    "\[Rule]", 
    RowBox[{"head", "[", 
     RowBox[{"before", ",", 
      RowBox[{"function", "[", 
       RowBox[{
       "openbracket", ",", "body", ",", "closebracket", ",", 
        "otherclosebracket"}], "]"}], ",", "after"}], "]"}]}]}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.770978237910767*^9, 3.7709783539468813`*^9}, {
   3.770978397252467*^9, 3.770978456953472*^9}, 3.770978583694621*^9, 
   3.770978671585494*^9, 3.770978703319969*^9, 3.770984675634968*^9, 
   3.770984709863267*^9, {3.770984856179367*^9, 3.770984913675206*^9}, {
   3.770985226962076*^9, 3.77098524672244*^9}, {3.770985283167972*^9, 
   3.7709853157817373`*^9}, {3.770985353685083*^9, 3.770985377608577*^9}, {
   3.770985426031233*^9, 3.770985672256319*^9}, {3.770985768766625*^9, 
   3.770985775503633*^9}, {3.770985873322723*^9, 3.770985877318707*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"a4d08686-c63d-4d44-822b-2be516fc1e69"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.6666666666666667`, 2.}, {1.3333333333333333`, 
    1.3333333333333335`}, {0., 0.6666666666666667}, {0.6666666666666666, 
    0.6666666666666667}, {1.3333333333333333`, 0.6666666666666667}, {2., 
    0.6666666666666667}, {2.6666666666666665`, 0.6666666666666667}, {2., 
    0.}, {2.6666666666666665`, 0.}, {3.3333333333333335`, 0.}, {2., 
    1.3333333333333335`}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 11}, {2, 3}, {2, 4}, {2, 5}, {2, 6}, {2, 7}, {7, 
       8}, {7, 9}, {7, 10}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Exp\"", "[", 
               RowBox[{"\"[\"", ",", "\"1\"", ",", "\"+\"", ",", "\"2\"", ",", 
                 RowBox[{"\"Sin\"", "[", 
                   RowBox[{"\"[\"", ",", "\"x\"", ",", "\"]\""}], "]"}]}], 
               "]"}], ",", "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Exp"["[", "1", "+", "2", 
           "Sin"["[", "x", "]"]], "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Exp\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"Exp\"", "[", 
           RowBox[{"\"[\"", ",", "\"1\"", ",", "\"+\"", ",", "\"2\"", ",", 
             RowBox[{"\"Sin\"", "[", 
               RowBox[{"\"[\"", ",", "\"x\"", ",", "\"]\""}], "]"}]}], "]"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[
         "Exp"["[", "1", "+", "2", 
          "Sin"["[", "x", "]"]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Sin\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"\"Sin\"", "[", 
           RowBox[{"\"[\"", ",", "\"x\"", ",", "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Sin"["[", "x", "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.6666666666666667`, 2.}, {1.3333333333333333`,
      1.3333333333333335`}, {0., 0.6666666666666667}, {0.6666666666666666, 
     0.6666666666666667}, {1.3333333333333333`, 0.6666666666666667}, {2., 
     0.6666666666666667}, {2.6666666666666665`, 0.6666666666666667}, {2., 
     0.}, {2.6666666666666665`, 0.}, {3.3333333333333335`, 0.}, {2., 
     1.3333333333333335`}}]& ],
  AspectRatio->NCache[2 Rational[2, 7]^Rational[1, 2], 1.0690449676496976`],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.770985427283915*^9, 3.7709854600781603`*^9}, {
   3.7709855135820208`*^9, 3.77098556331566*^9}, {3.770985609030375*^9, 
   3.7709856729223967`*^9}, {3.7709857693754673`*^9, 3.770985775970539*^9}, 
   3.77098588540385*^9},
 CellLabel->
  "Out[266]//TreeForm=",ExpressionUUID->"4bef0022-7879-4a5f-9fb7-\
8c8a7d563135"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myexpression", "//.", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "before___", ",", "function_String", ",", "openbracket_String", ",", 
        "body___", ",", "closebracket_String", ",", "after___"}], "}"}], "/;", 
      RowBox[{
       RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
       RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}]}]}], " ", "\[Rule]", 
     
     RowBox[{"{", 
      RowBox[{"before", ",", " ", 
       RowBox[{"function", "[", 
        RowBox[{"openbracket", ",", 
         RowBox[{"{", 
          RowBox[{"body", ",", "closebracket"}], "}"}]}], "]"}], ",", 
       "after"}], "}"}]}]}], "//", "TreeForm"}], ";"}]], "Input",
 CellChangeTimes->{
  3.770934880883193*^9, {3.77097769851462*^9, 3.770977704821905*^9}, {
   3.770977744200881*^9, 3.770977750213791*^9}, {3.7709846776930943`*^9, 
   3.770984688517796*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"08d74036-8318-420d-b1d8-2a6d2e814607"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myexpression", "//.", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "before___", ",", "function_String", ",", "openbracket_String", ",", 
        "body___", ",", "closebracket_String", ",", "after___"}], "}"}], "/;", 
      RowBox[{
       RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
       RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}]}]}], " ", "\[Rule]", 
     
     RowBox[{"{", 
      RowBox[{"before", ",", " ", "function", " ", ",", 
       RowBox[{"{", 
        RowBox[{"openbracket", ",", "body", ",", "closebracket"}], "}"}], ",",
        "after"}], "}"}]}]}], "//", "TreeForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709777613973827`*^9, 3.770977777371624*^9}, 
   3.770978052388534*^9, {3.77097809034212*^9, 3.770978111660121*^9}, 
   3.770978221025312*^9, {3.770984691837716*^9, 3.7709847080669394`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"3a9e1e5a-e372-43d8-93e0-98536b886112"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7709775496667223`*^9, 
  3.770977551272771*^9}},ExpressionUUID->"f7c2b4a1-6e53-430d-bbc1-\
5d221b9db04d"],

Cell[BoxData[
 RowBox[{"mynewexpression", "=", 
  RowBox[{
   RowBox[{"myexpression", "/.", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "function_", ",", "openbracket_String", ",", "body___", ",", 
        "closebracket_String"}], "}"}], "/;", 
      RowBox[{
       RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
       RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}]}]}], " ", "\[Rule]", 
     
     RowBox[{"{", " ", 
      RowBox[{"function", ",", 
       RowBox[{"{", 
        RowBox[{"openbracket", ",", "body", ",", "closebracket"}], "}"}]}], 
      "}"}]}]}], "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.7709271929002666`*^9, 3.7709273996879463`*^9}, {
   3.770927653872323*^9, 3.7709277097995243`*^9}, {3.770927882499382*^9, 
   3.7709278877067747`*^9}, 3.770928084471786*^9, {3.770928119741349*^9, 
   3.770928126463676*^9}, {3.770928968097022*^9, 3.770928989516981*^9}, {
   3.7709290196734457`*^9, 3.770929027402988*^9}, {3.7709290626352777`*^9, 
   3.770929140410026*^9}, {3.770929281564863*^9, 3.7709293056351137`*^9}, {
   3.770929761608139*^9, 3.770929825094718*^9}, {3.770929970201207*^9, 
   3.770930003915024*^9}, {3.7709300437326612`*^9, 3.7709300680163097`*^9}, {
   3.7709302366756153`*^9, 3.770930243510648*^9}, {3.7709302736525717`*^9, 
   3.770930375504177*^9}, {3.770930434961562*^9, 3.770930454959063*^9}, {
   3.770930506064144*^9, 3.770930531246571*^9}, {3.770931140184679*^9, 
   3.7709311581439123`*^9}, 3.770938311753839*^9, 3.77097596755371*^9, {
   3.7709764880325727`*^9, 3.7709765186141653`*^9}, {3.770976553288419*^9, 
   3.770976553649085*^9}, {3.7709775008903513`*^9, 3.7709775338649054`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"4b71d795-026d-4227-8581-b829f48e9957"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mynewexpression", "//.", " ", 
   RowBox[{
    RowBox[{"List_Symbol", "[", "stuff___", "]"}], " ", "\[Rule]", 
    "stuff"}]}], " ", "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7709305331042013`*^9, 3.770930653660185*^9}, {
  3.770930806108152*^9, 3.770930815041354*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"ffc6da32-6a0f-40f0-ba8d-8bee2872d5c5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.770935787100004*^9, 
  3.7709357888557568`*^9}},ExpressionUUID->"ca138ea2-4ffd-454f-b4ec-\
b8c0760479e5"],

Cell[BoxData[
 RowBox[{"Delete", "[", "x", "]"}]], "Input",
 CellChangeTimes->{{3.7709358437729607`*^9, 3.7709358469084463`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"90eddc50-d5f4-4bb8-95e9-a20009382d35"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Playing with the reverse expression", "Section",
 CellChangeTimes->{{3.770937894423748*^9, 
  3.7709379058478537`*^9}},ExpressionUUID->"68403388-637d-4e7e-8d17-\
8dd80689ee01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpressionreversed", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Reverse", "[", " ", 
       RowBox[{"myexpression", ",", "1"}], "]"}], "/.", " ", 
      RowBox[{
       RowBox[{"item_", " ", "/;", " ", 
        RowBox[{"item", "\[Equal]", " ", "\"\<]\>\""}]}], " ", "\[Rule]", 
       " ", "\"\<Q\>\""}]}], "  ", "/.", " ", 
     RowBox[{
      RowBox[{"item_", "/;", " ", 
       RowBox[{"item", "\[Equal]", "\"\<[\>\""}]}], " ", "\[Rule]", " ", 
      "\"\<]\>\""}]}], "/.", " ", 
    RowBox[{
     RowBox[{"item_", " ", "/;", " ", 
      RowBox[{"item", "\[Equal]", "\"\<Q\>\""}]}], " ", "\[Rule]", " ", 
     "\"\<[\>\""}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770934836824132*^9, 3.7709348650739603`*^9}, {
   3.770935602738867*^9, 3.770935898199193*^9}, {3.770938446843314*^9, 
   3.77093845176434*^9}, {3.770938801848681*^9, 3.770938810790944*^9}, 
   3.770979939852582*^9},ExpressionUUID->"bf1969fe-f9bc-47e3-9e5d-\
7f1f97e1c37a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpressionreversed", "=", 
   RowBox[{"myexpression", "//", "Reverse"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770979945023521*^9, 3.770979954819721*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"7bba0f72-35f8-4c10-8424-ba4c512bcc83"],

Cell[BoxData[
 RowBox[{"myexpressionreversed", " ", "//", "TreeForm"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"1a8d2bb5-a5b8-4392-875e-7436917dbd18"],

Cell[BoxData[
 RowBox[{"myexpressionreversed", "[", 
  RowBox[{"[", "4", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7709804911391993`*^9, 3.770980504106826*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"69b1ae7d-466b-4034-8b09-3707e093d752"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"myexpressionreversed", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", "4"}], "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], "//",
    "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.7709804140940866`*^9, 3.77098046881527*^9}, {
  3.77098050677271*^9, 3.770980535115265*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"175167e2-2d7d-4359-8689-4bc4ab3b02c4"],

Cell[BoxData[
 RowBox[{"StringContainsQ", "[", 
  RowBox[{
   TagBox[
    FrameBox["\<\"\!\(\*StyleBox[\\\"string\\\", \\\"TI\\\"]\)\"\>"],
    "Placeholder"], ",", 
   TagBox[
    FrameBox["patt"],
    "Placeholder"]}], "]"}]], "Input",
 CellChangeTimes->{{3.7709816267073727`*^9, 
  3.770981632317636*^9}},ExpressionUUID->"6a4cb470-af6f-42cc-b402-\
1e7680e65fc5"],

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"myexpressionreversed", "[", 
   RowBox[{"[", 
    RowBox[{"2", ";;", "4"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7709817167881327`*^9, 3.7709817271902742`*^9}, {
  3.770981907421256*^9, 3.770981915212708*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"daf9d1d2-8a0b-42d5-add6-1573ea333f46"],

Cell[BoxData["AnyTrue"], "Input",
 CellChangeTimes->{{3.7709815639909*^9, 
  3.770981566820223*^9}},ExpressionUUID->"4ca7e66d-cac7-4acd-8e11-\
4d5fe1cf6d23"],

Cell[BoxData[
 RowBox[{"!", 
  RowBox[{
   RowBox[{"AnyTrue", "[", 
    RowBox[{"StringContainsQ", "[", "\"\<]\>\"", "]"}], "]"}], "@", 
   RowBox[{"myexpressionreversed", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "4"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.770981126783395*^9, 3.770981127735003*^9}, {
   3.770981159346322*^9, 3.7709812991058702`*^9}, {3.770982058905549*^9, 
   3.770982069773982*^9}, 3.770982264819023*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"4f041d54-aaab-40d0-8ffe-8faa2cdc0496"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpression", "//", "Reverse"}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.770982321938054*^9, 3.7709823415679493`*^9}, {
  3.7709824651885967`*^9, 3.770982478227271*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"d1eb33dd-9e32-401d-ae76-d5c47f5e39ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceRepeated", "[", 
   RowBox[{"%194", ",", " ", 
    RowBox[{
     RowBox[{"List", "[", 
      RowBox[{"{", "anything___", "}"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"{", "anything", "}"}]}]}], "]"}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7709838702444363`*^9, 3.77098396058906*^9}, {
  3.770984007507347*^9, 3.770984165789763*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"783c16e4-43f2-4a42-8729-594b85c345f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpressionreversed", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"head_", "[", 
      RowBox[{
      "before___", ",", "closebracket_", ",", "body___", ",", "openbracket_", 
       ",", "function_", ",", "after___"}], "]"}], " ", "/;", 
     RowBox[{
      RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
      RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}], " ", "&&", "  ", 
      RowBox[{
       RowBox[{"NoneTrue", "[", 
        RowBox[{"StringContainsQ", "[", "\"\<]\>\"", "]"}], "]"}], "@", 
       RowBox[{"{", "body", "}"}]}]}]}], "\[Rule]", 
    RowBox[{"head", "[", 
     RowBox[{"before", ",", "function", ",", 
      RowBox[{"{", 
       RowBox[{"closebracket", ",", "body", ",", "openbracket"}], "}"}], ",", 
      "after"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770979907630632*^9, 3.77097990839605*^9}, {
   3.770979972362499*^9, 3.770980076335609*^9}, {3.770980371628459*^9, 
   3.770980403806439*^9}, {3.7709805421755047`*^9, 3.7709805860408363`*^9}, 
   3.77098063824117*^9, {3.770980744729247*^9, 3.7709807583320923`*^9}, {
   3.770981102309886*^9, 3.770981110887538*^9}, {3.770981325963697*^9, 
   3.770981356498536*^9}, {3.770981392743187*^9, 3.770981398503083*^9}, {
   3.770981572134572*^9, 3.7709816148425293`*^9}, {3.770981655466103*^9, 
   3.770981688081134*^9}, {3.770981735942862*^9, 3.770981743694067*^9}, {
   3.770981776598132*^9, 3.770981810622478*^9}, {3.770981842924574*^9, 
   3.77098204062357*^9}, {3.770982270824111*^9, 3.77098227685678*^9}, 
   3.770982367228249*^9, {3.770982759783122*^9, 3.770982777269384*^9}, {
   3.7709828161323977`*^9, 3.7709828190802393`*^9}, {3.7709828650733852`*^9, 
   3.7709828851709414`*^9}, {3.770983158349298*^9, 3.770983159661525*^9}, {
   3.770983197559619*^9, 3.770983216312784*^9}, {3.77098350239495*^9, 
   3.770983504792644*^9}, {3.770983552251499*^9, 3.770983580841083*^9}, {
   3.7709837927102413`*^9, 3.770983801600216*^9}, {3.770984152574942*^9, 
   3.770984160127604*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"688cb974-9be8-4b7d-9d2f-b767ce236f65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"%165", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "//", "Head"}]], "Input",
 CellChangeTimes->{{3.770983227195632*^9, 3.770983264918891*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"b985666c-50aa-44ec-b113-7dfa20d9e11a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mynewexpressionreversed", "=", 
   RowBox[{"myexpressionreversed", "/.", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "openbracket_", ",", "body___", ",", "closebracket_", ",", "function_",
         ",", "therest___"}], "}"}], " ", "/;", 
      RowBox[{
       RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
       RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}]}]}], " ", "\[Rule]", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "openbracket", ",", "body", ",", "closebracket", ",", "function"}], 
        "}"}], ",", "therest"}], "}"}]}]}]}], ";", 
  RowBox[{"mynewexpressionreversed", "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.770934911338327*^9, 3.770935028452718*^9}, {
   3.770935076878889*^9, 3.770935098930591*^9}, {3.770935206998872*^9, 
   3.770935227782648*^9}, 3.770935511138694*^9, {3.770937988764182*^9, 
   3.7709379893848667`*^9}, {3.7709381528194237`*^9, 
   3.7709381738112373`*^9}, {3.770938220140926*^9, 3.770938229049247*^9}, {
   3.7709382724784718`*^9, 3.770938353491394*^9}, {3.770938481573554*^9, 
   3.770938540481264*^9}, {3.770938738436924*^9, 3.770938743419619*^9}, {
   3.770938778925427*^9, 3.770938787008842*^9}, {3.770938835673223*^9, 
   3.770938854850894*^9}, {3.7709389037022038`*^9, 3.770939048893029*^9}, 
   3.770939332399272*^9, {3.770939422439803*^9, 3.7709394242483587`*^9}, {
   3.77094033604963*^9, 3.770940350351323*^9}, {3.770940440283153*^9, 
   3.770940469121437*^9}, {3.7709405174267263`*^9, 3.770940522672123*^9}, {
   3.7709405576889887`*^9, 3.77094056430301*^9}, {3.770940636727429*^9, 
   3.770940660801017*^9}, {3.770940716008195*^9, 3.7709407519658947`*^9}, 
   3.7709408026259003`*^9, {3.770940839177497*^9, 3.770940863764493*^9}, {
   3.770982844485085*^9, 3.770982850198045*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"22e9ebdb-fdc9-4d95-ae6f-894360f498fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"//.", " ", 
   RowBox[{
    RowBox[{"List_Symbol", "[", "stuff___", "]"}], " ", "\[Rule]", 
    "stuff"}]}], ";"}]], "Input",ExpressionUUID->"ef5f93c2-5614-4ee3-80b5-\
7d86286eda46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mynewexpressionreversedcleaned", " ", "=", " ", 
   RowBox[{"mynewexpressionreversed", "//.", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"openbracket_", ",", "body___", ",", "closebracket_"}], "}"}], 
      " ", "/;", 
      RowBox[{
       RowBox[{"openbracket", "\[Equal]", "\"\<[\>\""}], " ", "&&", " ", 
       RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}]}]}], " ", "\[Rule]", 
     "body"}]}]}], ";", 
  RowBox[{"mynewexpressionreversedcleaned", "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.7709391806964293`*^9, 3.770939254757284*^9}, {
  3.7709393013337793`*^9, 3.770939308373073*^9}, {3.770939784205977*^9, 
  3.7709397846039963`*^9}, {3.770940198223565*^9, 3.7709402115657377`*^9}, {
  3.770940973303776*^9, 3.770940974628183*^9}, {3.770941182084425*^9, 
  3.770941187746162*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0c7747ee-7a94-46c6-84d4-8ee91ddf154e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Reverse", "[", "mynewexpressionreversed", "]"}], "/.", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"_", ",", "closebracket_"}], "}"}], " ", "/;", 
     RowBox[{"closebracket", "\[Equal]", "\"\<]\>\""}]}], "  ", "\[Rule]", 
    "555"}]}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.77094101472423*^9, 3.770941063436693*^9}, {
  3.770941214857283*^9, 3.770941792809115*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"26818b52-aba0-4ba9-9b39-07983dd144d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mynewexpressionreversed", "[", 
   RowBox[{"[", "0", "]"}], "]"}], "//", "Head"}]], "Input",
 CellChangeTimes->{{3.770941104971715*^9, 3.7709411708370247`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"c6a3716a-6c42-432a-855c-600324aaa8d0"],

Cell[BoxData[
 RowBox[{"Delete", "[", "x", "]"}]], "Input",
 CellChangeTimes->{{3.7709415615482073`*^9, 3.770941563969388*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"d9b61ffc-aa40-4187-848a-e709c65a3592"],

Cell[BoxData[
 RowBox[{"myexpression", "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.770978839339568*^9, 3.770978865597743*^9}, {
  3.770978914244801*^9, 3.77097892079205*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"4764c923-102c-4fc1-b28e-ffe23e1831ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reverse", "[", "myexpression", "]"}], "//", "TreeForm"}]], "Input",\

 CellChangeTimes->{{3.770978892252931*^9, 3.7709789078261967`*^9}, {
  3.7709792363654547`*^9, 3.77097939085207*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d3be8533-377e-4c3d-bcbe-d0ac74ca20dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Play with functions:", "Section",
 CellChangeTimes->{{3.77098434826217*^9, 
  3.770984351341613*^9}},ExpressionUUID->"cf629272-b99d-4be7-8f31-\
ece37d6849cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myexpression", "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.770984480461483*^9, 3.7709844871090384`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"a6626491-4428-4729-bbf2-57ac3c9b454c"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.4795908857482156`, 0.3287979746107146}, {0., 
    0.}, {0.3287979746107146, 0.}, {0.6575959492214292, 0.}, {
    0.9863939238321437, 0.}, {1.3151918984428583`, 0.}, {1.643989873053573, 
    0.}, {1.9727878476642875`, 0.}, {2.301585822275002, 0.}, {
    2.6303837968857167`, 0.}, {2.9591817714964312`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, {1, 8}, {1, 
       9}, {1, 10}, {1, 11}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           
           RowBox[{"\"Exp\"", ",", "\"[\"", ",", "\"1\"", ",", "\"+\"", ",", 
             "\"2\"", ",", "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", 
             "\"]\"", ",", "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Exp", "[", "1", "+", "2", "Sin", "[", "x", "]", "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Exp\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Exp\"", HoldForm]],
       Annotation[#, 
        HoldForm["Exp"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Sin\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"Sin\"", HoldForm]],
       Annotation[#, 
        HoldForm["Sin"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.4795908857482156`, 0.3287979746107146}, {0., 
     0.}, {0.3287979746107146, 0.}, {0.6575959492214292, 0.}, {
     0.9863939238321437, 0.}, {1.3151918984428583`, 0.}, {1.643989873053573, 
     0.}, {1.9727878476642875`, 0.}, {2.301585822275002, 0.}, {
     2.6303837968857167`, 0.}, {2.9591817714964312`, 0.}}]& ],
  AspectRatio->NCache[Rational[2, 7]^Rational[1, 2], 0.5345224838248488],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.770984487518963*^9},
 CellLabel->
  "Out[204]//TreeForm=",ExpressionUUID->"26b27779-7784-4f6c-aa64-\
bab1d2fcb9e1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"WolframLanguageData", "[", 
   RowBox[{"\"\<Exp\>\"", ",", "\"\<DocumentationExampleInputs\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.770813433517725*^9, {3.770984328640039*^9, 3.770984332011497*^9}, 
   3.770984389541271*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"a334251d-2ed2-47e4-83b6-e048b1f2b5b9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "Exp", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.7709844449058447`*^9, 3.770984457115386*^9}, {
  3.77098449611659*^9, 3.770984529572425*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"4c1e2ec3-096f-48a7-a7fb-6c8e2d6a0a10"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.770984421114438*^9, {3.770984451471712*^9, 3.770984457602212*^9}, {
   3.7709844984550953`*^9, 3.770984529946103*^9}},
 CellLabel->
  "Out[210]=",ExpressionUUID->"ba23b752-2ed4-4678-bc50-f867c2d5261d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.77099450090058*^9, 
  3.770994509767075*^9}},ExpressionUUID->"cd7ab1aa-89a7-412e-a7b8-\
0bb7d342713f"],

Cell[BoxData[
 RowBox[{"[", " ", 
  RowBox[{"[", " ", 
   RowBox[{"[", "   ", "]"}], " ", "]"}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.7710000695764217`*^9, 
  3.7710000813373404`*^9}},ExpressionUUID->"851d48d6-d3db-42a1-a341-\
6a08a1fcc34a"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 169, 3, 67, "Section",ExpressionUUID->"7331da9b-b925-4dd3-8495-7eb515484d10"],
Cell[CellGroupData[{
Cell[774, 29, 158, 3, 54, "Subsection",ExpressionUUID->"408358db-aa51-4816-abf9-7a8cd577489b"],
Cell[935, 34, 293, 7, 30, "Input",ExpressionUUID->"060d984e-2d88-42ac-a8b3-544f57902d7d"],
Cell[1231, 43, 274, 5, 30, "Input",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1542, 53, 168, 3, 54, "Subsection",ExpressionUUID->"21c511ce-cd28-4abe-8aef-bb58362f5c9d"],
Cell[1713, 58, 305, 7, 30, "Input",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],
Cell[2021, 67, 464, 11, 30, "Input",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],
Cell[2488, 80, 779, 21, 52, "Input",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3316, 107, 177, 3, 67, "Section",ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-4a5d84b2a192"],
Cell[3496, 112, 244, 4, 30, "Input",ExpressionUUID->"a43fdc57-cc7e-47e5-86a2-072480d9bb27"],
Cell[3743, 118, 727, 18, 30, "Input",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],
Cell[4473, 138, 667, 18, 30, "Input",ExpressionUUID->"11cb3a39-056b-4148-a563-87f74e3992e3"],
Cell[5143, 158, 168, 3, 30, "Input",ExpressionUUID->"51fca234-32cb-4dc6-9e78-4d0b880c29a9"],
Cell[5314, 163, 166, 3, 30, "Input",ExpressionUUID->"198a1d36-9964-49f9-b2ab-c65a496fbe21"],
Cell[5483, 168, 154, 3, 30, "Input",ExpressionUUID->"43e32ac9-bd62-49c9-914d-c50aa29f5bfa"],
Cell[5640, 173, 154, 3, 30, "Input",ExpressionUUID->"d696c5ff-59aa-42c7-ba9c-3549ef217038"],
Cell[5797, 178, 205, 4, 30, "Input",ExpressionUUID->"2d7e8ce8-16f5-45a6-ade6-141021eb3e3e"],
Cell[6005, 184, 567, 15, 30, "Input",ExpressionUUID->"a4244665-0e2e-409a-8d98-0ad0578c9b2a"],
Cell[CellGroupData[{
Cell[6597, 203, 627, 17, 30, "Input",ExpressionUUID->"50aae130-1491-44cc-ad1a-ec24bf620f4f"],
Cell[7227, 222, 236, 4, 34, "Output",ExpressionUUID->"c67c058d-c55e-4415-b4d5-651447ed1fea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7500, 231, 869, 14, 30, "Input",ExpressionUUID->"dff6ae74-0581-4d40-8836-3ba83559d7e3"],
Cell[8372, 247, 11790, 317, 407, "Output",ExpressionUUID->"45ff1f3b-050f-4ce0-9630-c0fffacf7b62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20199, 569, 545, 15, 30, "Input",ExpressionUUID->"550114f3-fb63-4024-b85a-07bb014e815c"],
Cell[20747, 586, 278, 5, 34, "Output",ExpressionUUID->"3de974f7-0a6d-4658-9af0-267afbc84d52"]
}, Open  ]],
Cell[21040, 594, 245, 6, 30, "Input",ExpressionUUID->"9b43ac08-d9bf-4efd-809a-0ae25f194f77"],
Cell[21288, 602, 156, 3, 30, "Input",ExpressionUUID->"643966d6-994a-45b0-93c8-645503c9f93a"],
Cell[21447, 607, 871, 21, 30, "Input",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"],
Cell[CellGroupData[{
Cell[22343, 632, 431, 10, 30, "Input",ExpressionUUID->"da45fadf-72cd-4183-929d-a6197a74b37f"],
Cell[22777, 644, 915, 28, 123, "Output",ExpressionUUID->"df410961-8b3f-44b4-99fa-1b9965b80d09"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23741, 678, 232, 4, 67, "Section",ExpressionUUID->"71190df2-94a5-46bf-b001-1367a76e379e"],
Cell[23976, 684, 253, 4, 35, "Text",ExpressionUUID->"c9a7a2e6-cd90-43f5-ba7c-c792e70e6afb"],
Cell[CellGroupData[{
Cell[24254, 692, 468, 7, 30, "Input",ExpressionUUID->"46628cd0-eec0-4846-a8fc-f8d4ece96e37"],
Cell[24725, 701, 247, 4, 34, "Output",ExpressionUUID->"8fd2e6e7-b100-45ee-9bbb-e6a9c2e4758d"]
}, Open  ]],
Cell[24987, 708, 244, 4, 30, "Input",ExpressionUUID->"011150ec-078f-446c-8167-5a7e3e13af03"],
Cell[CellGroupData[{
Cell[25256, 716, 348, 6, 30, "Input",ExpressionUUID->"f63ea524-19a4-4874-96a1-3571a6464e48"],
Cell[25607, 724, 318, 8, 34, "Output",ExpressionUUID->"4815923f-93ec-4ab4-892e-5ccf32a57e59"]
}, Open  ]],
Cell[25940, 735, 345, 7, 30, "Input",ExpressionUUID->"c775def0-0982-419c-af1d-e87aba102a53"],
Cell[26288, 744, 314, 5, 30, "Input",ExpressionUUID->"3e00fede-1dea-41c7-996c-17405c4894bd"],
Cell[26605, 751, 337, 5, 30, "Input",ExpressionUUID->"2d8ae4b4-c39f-4e84-a120-e08d6f32d9b5"],
Cell[26945, 758, 526, 10, 30, "Input",ExpressionUUID->"300967d1-08b6-4b84-a2b7-bd45b9f44ad9"],
Cell[CellGroupData[{
Cell[27496, 772, 499, 10, 30, "Input",ExpressionUUID->"52ebedf2-499a-4415-8c6d-1d5fa307e131"],
Cell[27998, 784, 418, 7, 34, "Output",ExpressionUUID->"aecf7a3a-14c2-4794-8b74-96fe934ca8e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28453, 796, 221, 3, 30, "Input",ExpressionUUID->"2b5c3bee-a711-4649-97eb-19d750d5572c"],
Cell[28677, 801, 172, 2, 34, "Output",ExpressionUUID->"714fddd2-bb62-47e1-9eef-f8c58b4aabdf"]
}, Open  ]],
Cell[28864, 806, 160, 2, 30, "Input",ExpressionUUID->"932b0683-ded0-4a58-8e28-bdc5b45c6d15"],
Cell[29027, 810, 185, 2, 30, "Input",ExpressionUUID->"03882fba-808b-45b0-b72b-c3974be60c96"],
Cell[29215, 814, 225, 5, 35, "Text",ExpressionUUID->"95b6b530-0def-43d7-afa1-3bc990d978d2"],
Cell[29443, 821, 221, 5, 35, "Text",ExpressionUUID->"2a08daa1-62e4-42d0-9b83-70ae9ab28b6e"],
Cell[29667, 828, 383, 8, 30, "Input",ExpressionUUID->"298590ef-dc48-4f5b-bb0d-cc1354995387"],
Cell[CellGroupData[{
Cell[30075, 840, 212, 3, 30, "Input",ExpressionUUID->"11ddb293-ce32-4c14-b68e-ea11956ecbcd"],
Cell[30290, 845, 8494, 236, 221, "Output",ExpressionUUID->"08d6fd38-db67-4a47-8e69-dda6923d0aa8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38821, 1086, 444, 10, 30, "Input",ExpressionUUID->"25bf150a-f59a-49e4-a8c5-9e1099d6338b"],
Cell[39268, 1098, 177, 2, 34, "Output",ExpressionUUID->"4fabd24d-167d-4c63-9748-65580ab06cab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39482, 1105, 395, 9, 30, "Input",ExpressionUUID->"c135a756-fa82-4562-8392-addc9a4c9259"],
Cell[39880, 1116, 363, 10, 34, "Output",ExpressionUUID->"4c579a3c-8322-4dea-8134-c55882bf2fb1"]
}, Open  ]],
Cell[40258, 1129, 156, 3, 30, "Input",ExpressionUUID->"37a8f7ec-2443-4e3f-a759-056326078a28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40451, 1137, 175, 3, 67, "Section",ExpressionUUID->"736a9492-35c5-4506-8855-124c39458c73"],
Cell[CellGroupData[{
Cell[40651, 1144, 260, 4, 30, "Input",ExpressionUUID->"8ee43984-72ba-409e-95e1-cb28e7692ce8"],
Cell[40914, 1150, 366, 6, 34, "Output",ExpressionUUID->"04096016-9f6d-4d96-aacb-29427d8918cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41317, 1161, 170, 3, 54, "Subsection",ExpressionUUID->"6ad86900-a0f0-470f-8f4a-a8003f8ae5b1"],
Cell[CellGroupData[{
Cell[41512, 1168, 2828, 71, 136, "Input",ExpressionUUID->"28585982-ed80-4871-a187-50e8afc19875"],
Cell[CellGroupData[{
Cell[44365, 1243, 437, 13, 25, "Echo",ExpressionUUID->"5701708f-845a-495d-901a-b8f8146f7e9f"],
Cell[44805, 1258, 462, 14, 25, "Echo",ExpressionUUID->"0ee85351-4757-44fe-a26a-7b274334836f"],
Cell[45270, 1274, 617, 13, 25, "Echo",ExpressionUUID->"5b054c09-4f93-4bad-8d1e-6d2418fb2377"],
Cell[45890, 1289, 322, 11, 25, "Echo",ExpressionUUID->"1a6cb0ce-c2a2-4257-94c1-61b7db58ff97"],
Cell[46215, 1302, 615, 13, 25, "Echo",ExpressionUUID->"c516bc76-b659-4e4c-95d6-97d65d35731c"],
Cell[46833, 1317, 356, 12, 25, "Echo",ExpressionUUID->"ca615058-42fa-41f0-b691-febbce00e962"]
}, Open  ]],
Cell[47204, 1332, 8909, 242, 221, "Output",ExpressionUUID->"e8b09dd6-d570-4cfa-b008-bfd04804b071"]
}, Open  ]],
Cell[56128, 1577, 213, 3, 30, "Input",ExpressionUUID->"2f97b97c-a951-4a48-8700-3087ea4d1bfa"],
Cell[CellGroupData[{
Cell[56366, 1584, 1468, 31, 73, "Input",ExpressionUUID->"a4d08686-c63d-4d44-822b-2be516fc1e69"],
Cell[57837, 1617, 9246, 251, 413, "Output",ExpressionUUID->"4bef0022-7879-4a5f-9fb7-8c8a7d563135"]
}, Open  ]],
Cell[67098, 1871, 1027, 26, 52, "Input",ExpressionUUID->"08d74036-8318-420d-b1d8-2a6d2e814607"],
Cell[68128, 1899, 1007, 23, 52, "Input",ExpressionUUID->"3a9e1e5a-e372-43d8-93e0-98536b886112"],
Cell[69138, 1924, 154, 3, 30, "Input",ExpressionUUID->"f7c2b4a1-6e53-430d-bbc1-5d221b9db04d"],
Cell[69295, 1929, 1775, 33, 73, "Input",ExpressionUUID->"4b71d795-026d-4227-8581-b829f48e9957"],
Cell[71073, 1964, 393, 8, 30, "Input",ExpressionUUID->"ffc6da32-6a0f-40f0-ba8d-8bee2872d5c5"],
Cell[71469, 1974, 154, 3, 30, "Input",ExpressionUUID->"ca138ea2-4ffd-454f-b4ec-b8c0760479e5"],
Cell[71626, 1979, 212, 4, 30, "Input",ExpressionUUID->"90eddc50-d5f4-4bb8-95e9-a20009382d35"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71887, 1989, 182, 3, 67, "Section",ExpressionUUID->"68403388-637d-4e7e-8d17-8dd80689ee01"],
Cell[72072, 1994, 1003, 24, 30, "Input",ExpressionUUID->"bf1969fe-f9bc-47e3-9e5d-7f1f97e1c37a"],
Cell[73078, 2020, 273, 5, 30, "Input",ExpressionUUID->"7bba0f72-35f8-4c10-8424-ba4c512bcc83"],
Cell[73354, 2027, 160, 2, 30, "Input",ExpressionUUID->"1a8d2bb5-a5b8-4392-875e-7436917dbd18"],
Cell[73517, 2031, 243, 4, 30, "Input",ExpressionUUID->"69b1ae7d-466b-4034-8b09-3707e093d752"],
Cell[73763, 2037, 454, 12, 30, "Input",ExpressionUUID->"175167e2-2d7d-4359-8689-4bc4ab3b02c4"],
Cell[74220, 2051, 365, 11, 34, "Input",ExpressionUUID->"6a4cb470-af6f-42cc-b402-1e7680e65fc5"],
Cell[74588, 2064, 353, 8, 30, "Input",ExpressionUUID->"daf9d1d2-8a0b-42d5-add6-1573ea333f46"],
Cell[74944, 2074, 157, 3, 30, "Input",ExpressionUUID->"4ca7e66d-cac7-4acd-8e11-4d5fe1cf6d23"],
Cell[75104, 2079, 527, 12, 30, "Input",ExpressionUUID->"4f041d54-aaab-40d0-8ffe-8faa2cdc0496"],
Cell[75634, 2093, 300, 6, 30, "Input",ExpressionUUID->"d1eb33dd-9e32-401d-ae76-d5c47f5e39ea"],
Cell[75937, 2101, 472, 11, 30, "Input",ExpressionUUID->"783c16e4-43f2-4a42-8729-594b85c345f9"],
Cell[76412, 2114, 2114, 39, 73, "Input",ExpressionUUID->"688cb974-9be8-4b7d-9d2f-b767ce236f65"],
Cell[78529, 2155, 257, 6, 30, "Input",ExpressionUUID->"b985666c-50aa-44ec-b113-7dfa20d9e11a"],
Cell[78789, 2163, 1961, 38, 94, "Input",ExpressionUUID->"22e9ebdb-fdc9-4d95-ae6f-894360f498fb"],
Cell[80753, 2203, 217, 6, 30, "Input",ExpressionUUID->"ef5f93c2-5614-4ee3-80b5-7d86286eda46"],
Cell[80973, 2211, 943, 19, 52, "Input",ExpressionUUID->"0c7747ee-7a94-46c6-84d4-8ee91ddf154e"],
Cell[81919, 2232, 528, 12, 30, "Input",ExpressionUUID->"26818b52-aba0-4ba9-9b39-07983dd144d1"],
Cell[82450, 2246, 278, 6, 30, "Input",ExpressionUUID->"c6a3716a-6c42-432a-855c-600324aaa8d0"],
Cell[82731, 2254, 210, 4, 30, "Input",ExpressionUUID->"d9b61ffc-aa40-4187-848a-e709c65a3592"],
Cell[82944, 2260, 261, 4, 30, "Input",ExpressionUUID->"4764c923-102c-4fc1-b28e-ffe23e1831ec"],
Cell[83208, 2266, 301, 6, 30, "Input",ExpressionUUID->"d3be8533-377e-4c3d-bcbe-d0ac74ca20dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83546, 2277, 164, 3, 67, "Section",ExpressionUUID->"cf629272-b99d-4be7-8f31-ece37d6849cd"],
Cell[CellGroupData[{
Cell[83735, 2284, 219, 4, 30, "Input",ExpressionUUID->"a6626491-4428-4729-bbf2-57ac3c9b454c"],
Cell[83957, 2290, 8497, 237, 221, "Output",ExpressionUUID->"26b27779-7784-4f6c-aa64-bab1d2fcb9e1"]
}, Open  ]],
Cell[92469, 2530, 360, 9, 30, "Input",ExpressionUUID->"a334251d-2ed2-47e4-83b6-e048b1f2b5b9"],
Cell[CellGroupData[{
Cell[92854, 2543, 378, 9, 30, "Input",ExpressionUUID->"4c1e2ec3-096f-48a7-a7fb-6c8e2d6a0a10"],
Cell[93235, 2554, 254, 5, 34, "Output",ExpressionUUID->"ba23b752-2ed4-4678-bc50-f867c2d5261d"]
}, Open  ]],
Cell[93504, 2562, 151, 3, 30, "Input",ExpressionUUID->"cd7ab1aa-89a7-412e-a7b8-0bb7d342713f"],
Cell[93658, 2567, 248, 6, 30, "Input",ExpressionUUID->"851d48d6-d3db-42a1-a341-6a08a1fcc34a"]
}, Open  ]]
}
]
*)

