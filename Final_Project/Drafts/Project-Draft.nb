(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50317,       1350]
NotebookOptionsPosition[     45265,       1262]
NotebookOutlinePosition[     45602,       1277]
CellTagsIndexPosition[     45559,       1274]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["From Giulio and Tim:", "Section",
 CellChangeTimes->{{3.7708127104307947`*^9, 
  3.7708127225333347`*^9}},ExpressionUUID->"7331da9b-b925-4dd3-8495-\
7eb515484d10"],

Cell[CellGroupData[{

Cell["General:", "Subsection",
 CellChangeTimes->{{3.7709144432629547`*^9, 
  3.770914445573207*^9}},ExpressionUUID->"408358db-aa51-4816-abf9-\
7a8cd577489b"],

Cell[BoxData[
 RowBox[{"WolframLanguageData", "[", 
  RowBox[{"\"\<Exp\>\"", ",", "\"\<DocumentationExampleInputs\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.770813433517725*^9, {3.770984328640039*^9, 
   3.770984332011497*^9}},ExpressionUUID->"060d984e-2d88-42ac-a8b3-\
544f57902d7d"],

Cell[BoxData[
 RowBox[{"SyntaxInformation", "[", "Exp", "]"}]], "Input",
 CellChangeTimes->{{3.7708134385892553`*^9, 3.7708134589607162`*^9}, {
  3.770984336204373*^9, 3.770984336709324*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defined functions:", "Subsection",
 CellChangeTimes->{{3.7709144516420717`*^9, 
  3.770914456220595*^9}},ExpressionUUID->"21c511ce-cd28-4abe-8aef-\
bb58362f5c9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseString", "[", "str_String", "]"}], ":=", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flattenParse", "[", "exp_", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{"exp", ",", " ", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "anything___", "}"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"{", "anything", "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.770983991852192*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"makeExpressionString", ",", " ", 
   RowBox[{"{", "HoldFirst", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeExpressionString", "[", "exp_", "]"}], ":=", 
  RowBox[{"StringTake", "[", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"HoldComplete", "[", "exp", "]"}], ",", " ", "InputForm"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"StringLength", "[", "\"\<HoldComplete[\>\"", "]"}], "+", 
       "1"}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"StringLength", "[", "\"\<]\>\"", "]"}]}], "-", "1"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio regarding parsing:", "Section",
 CellChangeTimes->{{3.7710091399881973`*^9, 
  3.771009166068852*^9}},ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-\
4a5d84b2a192"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"parseInput", ",", "takepart"}], "]"}]], "Input",
 CellChangeTimes->{{3.771016726184655*^9, 3.771016734149858*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"a43fdc57-cc7e-47e5-86a2-072480d9bb27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseInput", "[", "str_String", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"RowBox", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ",", 
     RowBox[{"\"\< \>\"", "\[RuleDelayed]", " ", "Nothing"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771071449483674*^9, 3.771071477236809*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"takepart", "[", 
   RowBox[{"expr_String", ",", "level_Integer"}], "]"}], ":=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"level", "[", 
     RowBox[{
      RowBox[{"parseInput", "[", "expr", "]"}], ",", 
      RowBox[{"{", "level", "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x_", "/;", 
      RowBox[{"!", 
       RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
     RowBox[{"Head", "[", "x", "]"}]}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771016789391432*^9, 3.771016790676392*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"11cb3a39-056b-4148-a563-87f74e3992e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"good", "=", "\"\<f[1,g[1,2],3]\>\""}], ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"51fca234-32cb-4dc6-9e78-4d0b880c29a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bad", "=", "\"\<f[1,g[1,2,3]\>\""}], ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"198a1d36-9964-49f9-b2ab-c65a496fbe21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"correction1", "=", "\"\<f[1,g[1,2,3]]\>\""}], ";"}]], "Input",Expre\
ssionUUID->"43e32ac9-bd62-49c9-914d-c50aa29f5bfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"correction2", "=", "\"\<f[1,g[1,2],3]\>\""}], ";"}]], "Input",Expre\
ssionUUID->"d696c5ff-59aa-42c7-ba9c-3549ef217038"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7710162208267393`*^9, 3.7710162517166643`*^9}, {
  3.771016566944702*^9, 
  3.771016657930585*^9}},ExpressionUUID->"2d7e8ce8-16f5-45a6-ade6-\
141021eb3e3e"],

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{"Level", "[", 
    RowBox[{
     RowBox[{"parseInput", "[", "\"\<Exp[1+2Sin[x]]\>\"", "]"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x_", "/;", 
     RowBox[{"!", 
      RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
    RowBox[{"Head", "[", "x", "]"}]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771016289020914*^9, 3.7710163460571957`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"a4244665-0e2e-409a-8d98-0ad0578c9b2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Level", "[", 
     RowBox[{
      RowBox[{"parseInput", "[", "\"\<Exp[1+2Sin[x]]\>\"", "]"}], ",", 
      RowBox[{"{", "4", "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x_", "/;", 
      RowBox[{"!", 
       RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
     RowBox[{"Head", "[", "x", "]"}]}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.771016361433631*^9, 3.771016531555232*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"50aae130-1491-44cc-ad1a-ec24bf620f4f"],

Cell[BoxData["\<\"Sin\"\>"], "Output",
 CellChangeTimes->{{3.771016291993507*^9, 3.771016346869382*^9}, {
  3.771016426445703*^9, 3.771016532093939*^9}},
 CellLabel->
  "Out[167]=",ExpressionUUID->"c67c058d-c55e-4415-b4d5-651447ed1fea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpression", "=", " ", 
   RowBox[{"parseInput", "@", "\"\<Exp[1+2Sin[x]\>\""}]}], ";", 
  RowBox[{"myexpression", "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.7710095162738028`*^9, 3.771009524082501*^9}, {
  3.7710095551494083`*^9, 3.7710095795558777`*^9}, {3.7710096191892843`*^9, 
  3.771009795696598*^9}, {3.771009826849687*^9, 3.771009873237158*^9}, {
  3.771009968676758*^9, 3.771010170646742*^9}, {3.771010216382496*^9, 
  3.7710102347426853`*^9}, {3.771010339109809*^9, 3.771010579862664*^9}, {
  3.77101063410833*^9, 3.771010638986834*^9}, {3.771010669332863*^9, 
  3.771010729355112*^9}, {3.77101664093419*^9, 3.771016664018055*^9}, {
  3.771071334857849*^9, 3.7710713900232153`*^9}, {3.771071485827303*^9, 
  3.771071515613822*^9}, {3.7710806384038687`*^9, 3.771080651969123*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"dff6ae74-0581-4d40-8836-3ba83559d7e3"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.7470873676376284, 2.9883494705505136`}, {0., 
    2.241262102912885}, {0.7470873676376284, 2.241262102912885}, {
    1.4941747352752568`, 2.241262102912885}, {0.7470873676376284, 
    1.4941747352752568`}, {1.4941747352752568`, 1.4941747352752568`}, {
    2.241262102912885, 1.4941747352752568`}, {1.867718419094071, 
    0.7470873676376284}, {2.6148057867316994`, 0.7470873676376284}, {
    1.4941747352752568`, 0.}, {2.241262102912885, 0.}, {2.9883494705505136`, 
    0.}, {3.735436838188142, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {4, 5}, {4, 6}, {4, 7}, {7, 8}, {7, 
       9}, {9, 10}, {9, 11}, {9, 12}, {9, 13}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Exp\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"1\"", ",", "\"+\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"2\"", ",", 
                    RowBox[{"{", 
                    
                    RowBox[{
                    "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
                    "}"}]}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Exp", "[", {"1", "+", {"2", {"Sin", "[", "x", "]"}}}}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Exp\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"Exp\"", HoldForm]],
       Annotation[#, 
        HoldForm["Exp"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"1\"", ",", "\"+\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"2\"", ",", 
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
                   "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"1", "+", {"2", {"Sin", "[", "x", "]"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"2\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
               "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"2", {"Sin", "[", "x", "]"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Sin", "[", "x", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Sin\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\"Sin\"", HoldForm]],
       Annotation[#, 
        HoldForm["Sin"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.7470873676376284, 2.9883494705505136`}, {0., 
     2.241262102912885}, {0.7470873676376284, 2.241262102912885}, {
     1.4941747352752568`, 2.241262102912885}, {0.7470873676376284, 
     1.4941747352752568`}, {1.4941747352752568`, 1.4941747352752568`}, {
     2.241262102912885, 1.4941747352752568`}, {1.867718419094071, 
     0.7470873676376284}, {2.6148057867316994`, 0.7470873676376284}, {
     1.4941747352752568`, 0.}, {2.241262102912885, 0.}, {2.9883494705505136`, 
     0.}, {3.735436838188142, 0.}}]& ],
  AspectRatio->NCache[Rational[1, 2] 5^Rational[1, 2], 1.118033988749895],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.77107133559901*^9, 3.7710713906148787`*^9}, {
   3.771071495006576*^9, 3.771071516363367*^9}, 3.771071631256874*^9, 
   3.7710781777465887`*^9, {3.771080639480455*^9, 3.771080653002334*^9}},
 CellLabel->
  "Out[112]//TreeForm=",ExpressionUUID->"18a06318-b8b0-452a-bcf9-\
7727a50ecef4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getlevels", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"el", "=", "n"}], "}"}], ",", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"Level", "[", 
       RowBox[{"myexpression", ",", 
        RowBox[{"{", "el", "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x_", "/;", 
        RowBox[{"!", 
         RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", "x", "]"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7710191701613207`*^9, 3.7710191876987677`*^9}, {
  3.771019223056572*^9, 3.771019223738312*^9}, {3.771071641072381*^9, 
  3.7710716558175173`*^9}, {3.7710718970095787`*^9, 3.771071950565898*^9}, {
  3.771078660019331*^9, 3.771078672625184*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "I", " ", "hardcoded", " ", "the", " ", "number", " ", "4", " ", "here"}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771079070898686*^9, 
  3.771079081209824*^9}},ExpressionUUID->"e9722cd7-7163-4d1f-8eaa-\
e76b8c7ef2a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"alllevels", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"getlevels", "[", 
     RowBox[{"Range", "[", "4", "]"}], "]"}], "]"}]}], ";", 
  RowBox[{"alllevels", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.771071678241129*^9, 3.771071681210932*^9}, {
  3.771071959730679*^9, 3.7710720080046167`*^9}, {3.771078159074766*^9, 
  3.771078165483149*^9}, {3.771079006592578*^9, 3.771079024423977*^9}, {
  3.77107905932076*^9, 3.771079068284321*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"da45fadf-72cd-4183-929d-a6197a74b37f"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"1\"\>", ",", "\<\"+\"\>", ",", "\<\"List\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"2\"\>", ",", "\<\"List\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Sin\"\>", ",", "\<\"[\"\>", ",", "\<\"x\"\>", 
       ",", "\<\"]\"\>"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.7710716819172077`*^9, {3.771071955035328*^9, 3.77107197168258*^9}, {
   3.7710720034111423`*^9, 3.771072008469898*^9}, {3.771078166949224*^9, 
   3.7710781821636057`*^9}, 3.771078681511201*^9, {3.771079007243085*^9, 
   3.771079068528101*^9}, 3.771079126089938*^9, 3.77108068071486*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"16322257-6be1-4e5d-8881-875ee641207b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Depth", "[", "myexpression", "]"}]], "Input",
 CellChangeTimes->{{3.77107902611244*^9, 3.771079030412115*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"8df32770-8b3a-42df-b549-46b3de64237e"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.7710790307644863`*^9, 3.771079129126029*^9, 
  3.7710806836305017`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"b075829b-867a-4501-9015-ff5aa1435353"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{"Head", "[", "alllevels", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.771079914158115*^9, 3.7710799937015543`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"a52a4b08-8047-4e20-b16f-bd0eb43c3c0d"],

Cell[BoxData["List"], "Output",
 CellChangeTimes->{{3.771079916008298*^9, 3.771079994141687*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"ea9a17bc-ef40-446a-bef1-54b90334d1c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alllevels", "//", "TreeForm"}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"b86b0790-5e25-4bad-93c7-f29116e319d4"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{2.60975301720504, 0.9941916256019201}, {
    0.49709581280096005`, 0.49709581280096005`}, {0., 0.}, {
    0.49709581280096005`, 0.}, {0.9941916256019201, 0.}, {1.9883832512038402`,
     0.49709581280096005`}, {1.49128743840288, 0.}, {1.9883832512038402`, 
    0.}, {2.4854790640048003`, 0.}, {3.2311227832062404`, 
    0.49709581280096005`}, {2.98257487680576, 0.}, {3.47967068960672, 0.}, {
    4.72241022160912, 0.49709581280096005`}, {3.9767665024076804`, 0.}, {
    4.47386231520864, 0.}, {4.970958128009601, 0.}, {5.46805394081056, 
    0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 6}, {1, 10}, {1, 13}, {2, 3}, {2, 4}, {2, 5}, {6, 
       7}, {6, 8}, {6, 9}, {10, 11}, {10, 12}, {13, 14}, {13, 15}, {13, 16}, {
       13, 17}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Exp\"", ",", "\"[\"", ",", "\"List\""}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"1\"", ",", "\"+\"", ",", "\"List\""}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"2\"", ",", "\"List\""}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
               "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Exp", "[", "List"}, {"1", "+", "List"}, {"2", "List"}, {
          "Sin", "[", "x", "]"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Exp\"", ",", "\"[\"", ",", "\"List\""}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{"Exp", "[", "List"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Exp\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"Exp\"", HoldForm]],
       Annotation[#, 
        HoldForm["Exp"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"List\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"List\"", HoldForm]],
       Annotation[#, 
        HoldForm["List"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"1\"", ",", "\"+\"", ",", "\"List\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"1", "+", "List"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"1\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"1\"", HoldForm]],
       Annotation[#, 
        HoldForm["1"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"+\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"+\"", HoldForm]],
       Annotation[#, 
        HoldForm["+"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"List\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"List\"", HoldForm]],
       Annotation[#, 
        HoldForm["List"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"2\"", ",", "\"List\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"2", "List"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"2\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"2\"", HoldForm]],
       Annotation[#, 
        HoldForm["2"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"List\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"List\"", HoldForm]],
       Annotation[#, 
        HoldForm["List"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Sin\"", ",", "\"[\"", ",", "\"x\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Sin", "[", "x", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Sin\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"Sin\"", HoldForm]],
       Annotation[#, 
        HoldForm["Sin"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"x\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"x\"", HoldForm]],
       Annotation[#, 
        HoldForm["x"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.032],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{2.60975301720504, 0.9941916256019201}, {
     0.49709581280096005`, 0.49709581280096005`}, {0., 0.}, {
     0.49709581280096005`, 0.}, {0.9941916256019201, 0.}, {
     1.9883832512038402`, 0.49709581280096005`}, {1.49128743840288, 0.}, {
     1.9883832512038402`, 0.}, {2.4854790640048003`, 0.}, {
     3.2311227832062404`, 0.49709581280096005`}, {2.98257487680576, 0.}, {
     3.47967068960672, 0.}, {4.72241022160912, 0.49709581280096005`}, {
     3.9767665024076804`, 0.}, {4.47386231520864, 0.}, {4.970958128009601, 
     0.}, {5.46805394081056, 0.}}]& ],
  AspectRatio->NCache[Rational[1, 5] 6^Rational[1, 2], 0.4898979485566356],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.771078298479493*^9, 3.771078685533819*^9, 
  3.771079130941648*^9, 3.7710806887742147`*^9},
 CellLabel->
  "Out[117]//TreeForm=",ExpressionUUID->"f436d47d-68fe-4a7b-b587-\
43683aed5ccc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{"StringCount", "[", 
   RowBox[{"alllevels", ",", "\"\<[\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.771078189547805*^9, 3.77107822946455*^9}, {
  3.771078418494541*^9, 3.771078443512226*^9}, {3.771078490066066*^9, 
  3.7710785282900248`*^9}, {3.771079193776092*^9, 3.7710792022971983`*^9}, {
  3.771079480212205*^9, 3.771079540230267*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"9896d5a6-17c2-493b-b1ab-3860169fc356"],

Cell[BoxData[
 TemplateBox[{
  "StringCount","strse",
   "\"String or list of strings expected at position \\!\\(\\*RowBox[{\\\"1\\\
\"}]\\) in \\!\\(\\*RowBox[{\\\"StringCount\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\\\\\\\"Exp\
\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"[\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"List\\\\\\\"\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"1\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"+\\\\\\\"\\\", \
\\\",\\\", \\\"\\\\\\\"List\\\\\\\"\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"\\\\\\\"2\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"List\\\\\\\
\"\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"Sin\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"[\\\\\\\"\\\", \\\
\",\\\", \\\"\\\\\\\"x\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"]\\\\\\\"\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"\\\\\\\"[\\\\\\\"\\\"}], \
\\\"]\\\"}]\\).\"",2,118,57,20116379799573901373,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7710785289088573`*^9, 3.7710786883873997`*^9, 3.7710791353509903`*^9, {
   3.771079196764427*^9, 3.771079202804235*^9}, {3.771079493257163*^9, 
   3.7710795407403383`*^9}, 3.771080701059847*^9},
 CellLabel->
  "During evaluation of \
In[118]:=",ExpressionUUID->"838642a9-a5c2-475c-915f-9f1218dd0d96"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.771078218064855*^9, 3.771078230032057*^9}, {
   3.7710784199231997`*^9, 3.771078443831222*^9}, {3.771078493187812*^9, 
   3.771078528938232*^9}, 3.771078688393384*^9, 3.771079135367484*^9, {
   3.771079196775672*^9, 3.771079202811095*^9}, {3.771079493271165*^9, 
   3.771079540746675*^9}, 3.7710807010681973`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"66a6b48f-c064-4704-9666-5706b892d559"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"listA", "=", 
   RowBox[{"Total", "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{
        RowBox[{"alllevels", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "alllevels", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7710798446714687`*^9, 3.7710798844764357`*^9}, {
  3.77108001806703*^9, 3.771080035595872*^9}, {3.7710803922070837`*^9, 
  3.771080410689652*^9}, {3.771080522453794*^9, 3.7710805264867487`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"11a95029-781d-4f43-a331-2dbdd399aeed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"StringCount", "[", 
     RowBox[{"#", ",", "\"\<[\>\""}], "]"}], "&"}], ",", "alllevels", ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.77108134164423*^9, 3.771081380450028*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"3c84da31-d979-4bcd-9037-230839f81a60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7710813811470013`*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"bf2f07e7-66d5-4405-9f12-7feed76acaf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listB", "=", 
  RowBox[{"Total", "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringCount", "[", 
      RowBox[{
       RowBox[{"alllevels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "alllevels", "]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7710804164268017`*^9, 3.771080419266552*^9}, {
  3.7710805290851994`*^9, 3.771080530216126*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"f8cb2ae7-17eb-46a0-9709-710940ecb611"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.771079879890634*^9, 3.771079885314229*^9}, {
   3.771080027977469*^9, 3.771080036170003*^9}, 3.771080419794464*^9, 
   3.7710805307855186`*^9, 3.77108071375203*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"a99cf1b2-add5-4409-9f9e-dc5b8163c8b6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{
        RowBox[{"alllevels", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "alllevels", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{
        RowBox[{"alllevels", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "alllevels", "]"}]}], "}"}]}], "]"}]}], "]"}], 
  "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.77108030062713*^9, 3.771080374450643*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"7473564b-40d4-4286-883e-114bb2a75e6b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.771080314007509*^9, 
  3.771080322654484*^9}},ExpressionUUID->"bf7c0111-bb76-4b3a-882f-\
dbbb372441ce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Function \>\"", ",", "  ", 
   RowBox[{"getlevels", "[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{"Equal", ",", 
         RowBox[{"{", 
          RowBox[{"listA", ",", "listB"}], "}"}]}], "]"}], " ", ",", 
       "False"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
   "\"\< is missing a bracket\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7710806038973494`*^9, 3.77108060390359*^9}, {
  3.7710807609667673`*^9, 3.771080806400106*^9}, {3.771080842555409*^9, 
  3.771080846721093*^9}, {3.7710808780760603`*^9, 3.771080936196335*^9}, {
  3.771081004383502*^9, 3.7710810426157217`*^9}, {3.7710810751125*^9, 
  3.771081197450775*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"23da56b0-963d-4c2f-baeb-46a4e9548fc4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Function \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>"}], "}"}], 
   "\[InvisibleSpace]", "\<\" is missing a bracket\"\>"}],
  SequenceForm["Function ", {"Exp", "[", "List"}, " is missing a bracket"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7710811305627127`*^9, 3.771081198367169*^9}},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"1f3b73f3-8ecf-4cd4-973c-89512c110267"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getlevels", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.7710810522135477`*^9, 3.7710810620148706`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"4c68b49b-e1d0-4f06-b95f-f4f925f69b8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Exp\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.771081063879805*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"bcd5bd0e-d1d3-4784-912a-6583502001ef"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 169, 3, 67, "Section",ExpressionUUID->"7331da9b-b925-4dd3-8495-7eb515484d10"],
Cell[CellGroupData[{
Cell[774, 29, 158, 3, 54, "Subsection",ExpressionUUID->"408358db-aa51-4816-abf9-7a8cd577489b"],
Cell[935, 34, 293, 7, 30, "Input",ExpressionUUID->"060d984e-2d88-42ac-a8b3-544f57902d7d"],
Cell[1231, 43, 274, 5, 30, "Input",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1542, 53, 168, 3, 54, "Subsection",ExpressionUUID->"21c511ce-cd28-4abe-8aef-bb58362f5c9d"],
Cell[1713, 58, 305, 7, 30, "Input",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],
Cell[2021, 67, 464, 11, 30, "Input",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],
Cell[2488, 80, 779, 21, 52, "Input",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3316, 107, 177, 3, 67, "Section",ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-4a5d84b2a192"],
Cell[3496, 112, 244, 4, 30, "Input",ExpressionUUID->"a43fdc57-cc7e-47e5-86a2-072480d9bb27"],
Cell[3743, 118, 727, 18, 30, "Input",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],
Cell[4473, 138, 662, 17, 30, "Input",ExpressionUUID->"11cb3a39-056b-4148-a563-87f74e3992e3"],
Cell[5138, 157, 168, 3, 30, "Input",ExpressionUUID->"51fca234-32cb-4dc6-9e78-4d0b880c29a9"],
Cell[5309, 162, 166, 3, 30, "Input",ExpressionUUID->"198a1d36-9964-49f9-b2ab-c65a496fbe21"],
Cell[5478, 167, 154, 3, 30, "Input",ExpressionUUID->"43e32ac9-bd62-49c9-914d-c50aa29f5bfa"],
Cell[5635, 172, 154, 3, 30, "Input",ExpressionUUID->"d696c5ff-59aa-42c7-ba9c-3549ef217038"],
Cell[5792, 177, 205, 4, 30, "Input",ExpressionUUID->"2d7e8ce8-16f5-45a6-ade6-141021eb3e3e"],
Cell[6000, 183, 567, 15, 30, "Input",ExpressionUUID->"a4244665-0e2e-409a-8d98-0ad0578c9b2a"],
Cell[CellGroupData[{
Cell[6592, 202, 627, 17, 30, "Input",ExpressionUUID->"50aae130-1491-44cc-ad1a-ec24bf620f4f"],
Cell[7222, 221, 236, 4, 34, "Output",ExpressionUUID->"c67c058d-c55e-4415-b4d5-651447ed1fea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7495, 230, 920, 15, 30, "Input",ExpressionUUID->"dff6ae74-0581-4d40-8836-3ba83559d7e3"],
Cell[8418, 247, 11133, 300, 430, "Output",ExpressionUUID->"18a06318-b8b0-452a-bcf9-7727a50ecef4"]
}, Open  ]],
Cell[19566, 550, 965, 24, 30, "Input",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"],
Cell[20534, 576, 274, 7, 30, "Input",ExpressionUUID->"e9722cd7-7163-4d1f-8eaa-e76b8c7ef2a4"],
Cell[CellGroupData[{
Cell[20833, 587, 567, 12, 30, "Input",ExpressionUUID->"da45fadf-72cd-4183-929d-a6197a74b37f"],
Cell[21403, 601, 1020, 26, 87, "Output",ExpressionUUID->"16322257-6be1-4e5d-8881-875ee641207b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22460, 632, 217, 4, 30, "Input",ExpressionUUID->"8df32770-8b3a-42df-b549-46b3de64237e"],
Cell[22680, 638, 204, 4, 34, "Output",ExpressionUUID->"b075829b-867a-4501-9015-ff5aa1435353"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22921, 647, 245, 4, 30, "Input",ExpressionUUID->"a52a4b08-8047-4e20-b16f-bd0eb43c3c0d"],
Cell[23169, 653, 176, 2, 34, "Output",ExpressionUUID->"ea9a17bc-ef40-446a-bef1-54b90334d1c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23382, 660, 148, 3, 30, "Input",ExpressionUUID->"b86b0790-5e25-4bad-93c7-f29116e319d4"],
Cell[23533, 665, 13520, 369, 205, "Output",ExpressionUUID->"f436d47d-68fe-4a7b-b587-43683aed5ccc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37090, 1039, 482, 9, 30, "Input",ExpressionUUID->"9896d5a6-17c2-493b-b1ab-3860169fc356"],
Cell[37575, 1050, 1355, 23, 24, "Message",ExpressionUUID->"838642a9-a5c2-475c-915f-9f1218dd0d96"],
Cell[38933, 1075, 748, 17, 34, "Output",ExpressionUUID->"66a6b48f-c064-4704-9666-5706b892d559"]
}, Open  ]],
Cell[39696, 1095, 715, 18, 30, "Input",ExpressionUUID->"11a95029-781d-4f43-a331-2dbdd399aeed"],
Cell[CellGroupData[{
Cell[40436, 1117, 362, 9, 30, "Input",ExpressionUUID->"3c84da31-d979-4bcd-9037-230839f81a60"],
Cell[40801, 1128, 456, 13, 34, "Output",ExpressionUUID->"bf2f07e7-66d5-4405-9f12-7feed76acaf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41294, 1146, 591, 16, 30, "Input",ExpressionUUID->"f8cb2ae7-17eb-46a0-9709-710940ecb611"],
Cell[41888, 1164, 363, 7, 34, "Output",ExpressionUUID->"a99cf1b2-add5-4409-9f9e-dc5b8163c8b6"]
}, Open  ]],
Cell[42266, 1174, 889, 24, 30, "Input",ExpressionUUID->"7473564b-40d4-4286-883e-114bb2a75e6b"],
Cell[43158, 1200, 152, 3, 30, "Input",ExpressionUUID->"bf7c0111-bb76-4b3a-882f-dbbb372441ce"],
Cell[CellGroupData[{
Cell[43335, 1207, 886, 21, 30, "Input",ExpressionUUID->"23da56b0-963d-4c2f-baeb-46a4e9548fc4"],
Cell[44224, 1230, 518, 11, 24, "Print",ExpressionUUID->"1f3b73f3-8ecf-4cd4-973c-89512c110267"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44779, 1246, 215, 4, 30, "Input",ExpressionUUID->"4c68b49b-e1d0-4f06-b95f-f4f925f69b8d"],
Cell[44997, 1252, 240, 6, 34, "Output",ExpressionUUID->"bcd5bd0e-d1d3-4784-912a-6583502001ef"]
}, Open  ]]
}, Open  ]]
}
]
*)

