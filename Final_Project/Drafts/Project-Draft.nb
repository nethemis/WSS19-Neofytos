(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    240565,       6235]
NotebookOptionsPosition[    218410,       5890]
NotebookOutlinePosition[    218754,       5905]
CellTagsIndexPosition[    218711,       5902]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["From Riccardo:", "Section",
 CellChangeTimes->{{3.771104820444283*^9, 
  3.771104824806036*^9}},ExpressionUUID->"3191dbce-93fd-4477-884c-\
0bff78e6c4b9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Probs", " ", "not", " ", "needed"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771104829219104*^9, 
  3.77110483886907*^9}},ExpressionUUID->"470bf7bb-3068-49b4-b635-\
b9d8a8e24da4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"argumentLength", "[", "func_Symbol", "]"}], " ", ":=", " ", 
  RowBox[{"Lookup", "[", 
   RowBox[{
    RowBox[{"SyntaxInformation", "[", "func", "]"}], ",", " ", 
    "\"\<ArgumentsPattern\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"argumentLength", "[", "\"\<Plot\>\"", "]"}]}], "Input",ExpressionUUI\
D->"f4c25372-018e-4a88-9017-7a9edcee4526"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio and Tim:", "Section",
 CellChangeTimes->{{3.7708127104307947`*^9, 
  3.7708127225333347`*^9}},ExpressionUUID->"7331da9b-b925-4dd3-8495-\
7eb515484d10"],

Cell[CellGroupData[{

Cell["General:", "Subsection",
 CellChangeTimes->{{3.7709144432629547`*^9, 
  3.770914445573207*^9}},ExpressionUUID->"408358db-aa51-4816-abf9-\
7a8cd577489b"],

Cell[BoxData[
 RowBox[{"WolframLanguageData", "[", 
  RowBox[{"\"\<Exp\>\"", ",", "\"\<DocumentationExampleInputs\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.770813433517725*^9, {3.770984328640039*^9, 
   3.770984332011497*^9}},ExpressionUUID->"060d984e-2d88-42ac-a8b3-\
544f57902d7d"],

Cell[BoxData[
 RowBox[{"SyntaxInformation", "[", "Exp", "]"}]], "Input",
 CellChangeTimes->{{3.7708134385892553`*^9, 3.7708134589607162`*^9}, {
  3.770984336204373*^9, 3.770984336709324*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defined functions:", "Subsection",
 CellChangeTimes->{{3.7709144516420717`*^9, 
  3.770914456220595*^9}},ExpressionUUID->"21c511ce-cd28-4abe-8aef-\
bb58362f5c9d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"No", " ", "longer", " ", "useful"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.77109373184024*^9, 
  3.771093737195661*^9}},ExpressionUUID->"b88e4ffb-ac8e-4f35-854c-\
b3ef5db68881"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseString", "[", "str_String", "]"}], ":=", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flattenParse", "[", "exp_", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{"exp", ",", " ", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "anything___", "}"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"{", "anything", "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.770983991852192*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"makeExpressionString", ",", " ", 
   RowBox[{"{", "HoldFirst", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeExpressionString", "[", "exp_", "]"}], ":=", 
  RowBox[{"StringTake", "[", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"HoldComplete", "[", "exp", "]"}], ",", " ", "InputForm"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"StringLength", "[", "\"\<HoldComplete[\>\"", "]"}], "+", 
       "1"}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"StringLength", "[", "\"\<]\>\"", "]"}]}], "-", "1"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"functionargs", "[", "function_", "]"}], ":=", 
    RowBox[{"Length", "/@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SyntaxInformation", "[", "function", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Equal]", "_"}], "&"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "_."}], "&"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", 
           RowBox[{"OptionsPattern", "[", "]"}]}], "&"}]}], "}"}]}], 
      "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.77109352501967*^9, 
  3.771093527762093*^9}},ExpressionUUID->"09dc6fc4-37ec-484f-9e9c-\
57a45393165e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"functionargs", "[", "function_String", "]"}], " ", ":=", " ", 
  RowBox[{"functionargs", "[", 
   RowBox[{"Symbol", "[", "function", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functionargs", "[", "function_Symbol", "]"}], ":=", 
   RowBox[{"Length", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{
           RowBox[{"SyntaxInformation", "[", "function", "]"}], ",", " ", 
           "\"\<ArgumentsPattern\>\""}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Equal]", "_"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Equal]", "_"}], "||", 
          RowBox[{"#", "\[Equal]", "_."}], "||", 
          RowBox[{"#", "\[Equal]", 
           RowBox[{"OptionsPattern", "[", "]"}]}]}], "&"}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7710935414221153`*^9, 3.7710935836359673`*^9}, {
   3.771104786503063*^9, 3.771104802202396*^9}, 3.7711048842107563`*^9, {
   3.7711049425064573`*^9, 3.771104947878119*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"1b1a3bda-aee8-4d64-8c54-6620ec47b4c9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio regarding parsing:", "Section",
 CellChangeTimes->{{3.7710091399881973`*^9, 
  3.771009166068852*^9}},ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-\
4a5d84b2a192"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.771087583422986*^9, 3.771087608428813*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"2ebfdf41-6723-4414-a1b3-5460e5dde60b"],

Cell[CellGroupData[{

Cell["\<\
Convert the expression to a tree structure, regardless of whether it parses \
or not:\
\>", "Subsubsection",
 CellChangeTimes->{{3.771086292682269*^9, 
  3.771086315040605*^9}},ExpressionUUID->"acfd93ad-a969-4bde-aea4-\
49cbbde656e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseInput", "[", "str_String", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"RowBox", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ",", 
     RowBox[{"\"\< \>\"", "\[RuleDelayed]", " ", "Nothing"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771071449483674*^9, 3.771071477236809*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"takepart", "[", 
    RowBox[{"expr_String", ",", "level_Integer"}], "]"}], ":=", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"level", "[", 
      RowBox[{
       RowBox[{"parseInput", "[", "expr", "]"}], ",", 
       RowBox[{"{", "level", "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"x_", "/;", 
       RowBox[{"!", 
        RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
      RowBox[{"Head", "[", "x", "]"}]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.771016789391432*^9, 3.771016790676392*^9}, {
  3.77108653742286*^9, 
  3.771086543335803*^9}},ExpressionUUID->"11cb3a39-056b-4148-a563-\
87f74e3992e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get slices of the expression:", "Subsubsection",
 CellChangeTimes->{{3.771086347523155*^9, 
  3.7710863943006983`*^9}},ExpressionUUID->"df132a6e-dbce-43bf-b230-\
48b0ef57369d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getlevel", "[", 
   RowBox[{"expr_String", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"el", "=", "n"}], "}"}], ",", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"Level", "[", 
       RowBox[{
        RowBox[{"parseInput", "[", "expr", "]"}], ",", 
        RowBox[{"{", "el", "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x_", "/;", 
        RowBox[{"!", 
         RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", "x", "]"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7710191701613207`*^9, 3.7710191876987677`*^9}, {
   3.771019223056572*^9, 3.771019223738312*^9}, {3.771071641072381*^9, 
   3.7710716558175173`*^9}, {3.7710718970095787`*^9, 3.771071950565898*^9}, {
   3.771078660019331*^9, 3.771078672625184*^9}, 3.7710843833422956`*^9, {
   3.77108447740523*^9, 3.771084502982625*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get all the tree structure of the expression:", "Subsubsection",
 CellChangeTimes->{{3.7710863987455397`*^9, 
  3.771086409331916*^9}},ExpressionUUID->"d96fc860-14ff-492b-ac46-\
6f71c934b734"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getalllevels", "[", "expr_String", "]"}], ":=", 
   RowBox[{"Thread", "[", 
    RowBox[{"getlevel", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Depth", "[", 
         RowBox[{"parseInput", "[", "expr", "]"}], "]"}], "-", "1"}], "]"}]}],
      "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[194]:=",ExpressionUUID->"5f0b3a75-d452-420e-8a01-3ea25be17c4d"]
}, Open  ]],

Cell["\<\
functionargs returns the minimum and maximum number of arguments a function \
can have\
\>", "Subsubsection",
 CellChangeTimes->{{3.771090274532531*^9, 3.771090344599094*^9}, {
  3.7710936031165037`*^9, 
  3.771093619532844*^9}},ExpressionUUID->"2cd03372-1dd5-4bb8-9c06-\
690450722bbf"],

Cell[CellGroupData[{

Cell["Playing with uneven number of brackets:", "Subsubsection",
 CellChangeTimes->{{3.771087712227626*^9, 3.77108771634932*^9}, {
  3.771093679078897*^9, 
  3.771093686992795*^9}},ExpressionUUID->"2e6eee46-e43a-41ce-adb4-\
5c5b1aa9698e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mystring", "=", "\"\<SortBy[Range[10], Mod[#,3&]\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.771087740382039*^9, {3.7710880906425123`*^9, 3.7710880908509483`*^9}, {
   3.771088156455411*^9, 3.771088199688445*^9}, {3.771108696209776*^9, 
   3.7711087071307993`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c232d318-9cc0-4505-96ed-93c5e419fcc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"parseInput", "[", "mystring", "]"}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.771108710379532*^9, 3.771108711336488*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"9ce541ae-5b2e-440f-b948-56a44a9a0563"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eRMsOn2fb/sITSXw/uq1DZ2ng/2rxbfiY1PZXWA
ycP4OfyKRZt3MDnA+DD1H8A0gwMDFEDkv0L1PbWH8V+iiH+1fw/VB+PD7IOZ
l5DIr5iczevwAUUdK5p6LgdU8wQw5N9A3QGTh/Eh/hGC8/VcnWtikwTh/lh9
8186J78InA9TDzMfAHfzkC0=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {4, 5}, {4, 10}, {4, 11}, {5, 6}, {5, 
       7}, {5, 8}, {5, 9}, {11, 12}, {11, 13}, {11, 14}, {11, 20}, {14, 15}, {
       14, 16}, {14, 17}, {17, 18}, {17, 19}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], ",", 
                    "\"]\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, ",", {
           "Mod", "[", {"#", ",", {"3", "&"}}, "]"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], ",", 
                 "\"]\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, ",", {
          "Mod", "[", {"#", ",", {"3", "&"}}, "]"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", {"3", "&"}}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", {"3", "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"3\"", ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"3", "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eRMsOn2fb/sITSXw/uq1DZ2ng/2rxbfiY1PZXWA
ycP4OfyKRZt3MDnA+DD1H8A0gwMDFEDkv0L1PbWH8V+iiH+1fw/VB+PD7IOZ
l5DIr5iczevwAUUdK5p6LgdU8wQw5N9A3QGTh/Eh/hGC8/VcnWtikwTh/lh9
8186J78InA9TDzMfAHfzkC0=
     "]]& ],
  AspectRatio->NCache[Rational[2, 3]^Rational[1, 2], 0.816496580927726],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.771108711683021*^9},
 CellLabel->
  "Out[257]//TreeForm=",ExpressionUUID->"5e2ce31c-c1d9-4df3-93a1-\
6aef7f2f9ba7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"parseInput", "[", "mystring", "]"}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.771087632785275*^9, 3.7710876393432903`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"d0b6fa73-7bab-4132-8ff3-b53bcf023f7f"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {5, 7}, {5, 8}, {5, 9}, {11, 12}, {11, 20}, {12, 13}, {12, 14}, {
       12, 15}, {12, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
     "]]& ],
  AspectRatio->NCache[Rational[6, 7]^Rational[1, 2], 0.9258200997725514],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7710876396718693`*^9, 3.771087720098084*^9, 3.771087759100359*^9, 
   3.771088093877491*^9, {3.771088158336491*^9, 3.771088201716598*^9}, 
   3.771088245090414*^9, 3.771093906811249*^9, 3.771105068959261*^9, {
   3.77110869768817*^9, 3.771108704293124*^9}},
 CellLabel->
  "Out[255]//TreeForm=",ExpressionUUID->"615dadbb-0fe2-454e-b9b1-\
acb8915c8a13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"alllevels", "=", " ", 
   RowBox[{"getalllevels", "[", "mystring", "]"}]}], ";", 
  RowBox[{"alllevels", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.771086555540482*^9, 3.771086575131207*^9}, {
  3.771087571382249*^9, 3.771087576090201*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"e8b1f735-3ab1-4b3c-a98b-47837effb613"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"SortBy\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"List\"\>", ",", "\<\",\"\>", ",", "\<\"List\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
       ",", "\<\"]\"\>", ",", "\<\"List\"\>", ",", "\<\"&\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.7710876214972973`*^9, 3.7710878106160707`*^9, 
  3.7710881030688677`*^9, 3.771088248316053*^9, 3.77110507129478*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"8e642136-22e1-4b52-b4a9-0ca586509726"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listA", "=", 
  RowBox[{"Total", "/@", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{"#", ",", "\"\<[\>\""}], "]"}], "&"}], ",", "alllevels", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.771084253540374*^9, {3.771084359499206*^9, 3.771084388182954*^9}, {
   3.771084513249896*^9, 3.771084524736081*^9}, {3.771084583453003*^9, 
   3.771084584460314*^9}, {3.771084618916945*^9, 3.771084733640876*^9}, 
   3.771084764135775*^9, {3.771084797168809*^9, 3.7710847985364*^9}, 
   3.771085011387048*^9, {3.771085055301738*^9, 3.77108507242555*^9}, {
   3.77108550051519*^9, 3.7710855214225817`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"e6ef3c6e-88bd-4cbf-ab67-649ec8f27349"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.771085073344433*^9, {3.771085504252873*^9, 3.771085521982852*^9}, 
   3.771086022073792*^9, {3.771086547979677*^9, 3.7710865774039583`*^9}, 
   3.771086873433241*^9, 3.771087685137474*^9, 3.771087818844447*^9, 
   3.7710881055926857`*^9, 3.771088249742777*^9, 3.771105073319778*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"5cbca1b3-3c6a-4dc3-af07-e662dc62bc52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listB", "=", 
  RowBox[{"Total", "/@", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{"#", ",", "\"\<]\>\""}], "]"}], "&"}], ",", "alllevels", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771085064700062*^9, 3.77108507484408*^9}, 
   3.771085527933729*^9},
 CellLabel->
  "In[208]:=",ExpressionUUID->"1b4aa7e7-0347-44eb-b30e-429f6326a2d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7710850753620167`*^9, 3.7710855285555468`*^9, 
  3.7710860242590113`*^9, 3.7710865826723433`*^9, 3.771086874823698*^9, 
  3.771087687450665*^9, 3.771087820526587*^9, 3.77108810932312*^9, 
  3.771088250809189*^9, 3.771105075306201*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"d2fc199d-00a6-41ed-93ce-e3f75eb52455"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Positive", "[", 
  RowBox[{"listA", "-", "listB"}], "]"}]], "Input",
 CellChangeTimes->{{3.771086997493496*^9, 3.7710870268555737`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"3cf6ce29-13e4-4c14-a553-f46511eddf71"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.771087008828951*^9, 3.771087027524345*^9}, 
   3.771087070434478*^9, 3.7710876893130627`*^9, 3.771087825250001*^9, 
   3.771088113609326*^9, 3.771088252152701*^9, 3.771105076884367*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"a6246607-a2bc-489e-a52c-3ae45e974268"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Negative", "[", 
  RowBox[{"listA", "-", "listB"}], "]"}]], "Input",
 CellChangeTimes->{{3.771088074321496*^9, 3.771088081884233*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"0478d555-4d55-48a5-9e15-a239ca0f803e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.771088083144175*^9, 3.771088115849516*^9, 
  3.771088255043581*^9, 3.7711050784834547`*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"f41290b3-9a92-40e9-8473-bb0e8b29bd5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{"Greater", ",", 
   RowBox[{"{", 
    RowBox[{"listA", ",", "listB"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[211]:=",ExpressionUUID->"441c3372-c065-40a3-8eeb-c40e8fce9924"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.771088231295618*^9, 3.7711050801507053`*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"387a7a37-e5a4-4314-b6a9-1026126201ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Count the # arguments in functions:", "Subsubsection",
 CellChangeTimes->{{3.771093692257164*^9, 3.771093704039006*^9}, {
  3.771100527069023*^9, 
  3.771100530287149*^9}},ExpressionUUID->"968142cc-3908-4fc2-a763-\
1e03ef146791"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "upper___", ",", "function_", ",", "open_", ",", "body___", ",", 
       "close_", ",", "lower___"}], "}"}], "/;", " ", 
     RowBox[{
      RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
      RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], "  ", "\[RuleDelayed]", 
    " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"Length", "@", 
           RowBox[{
            RowBox[{"Cases", "[", "\"\<,\>\"", "]"}], "@", "body"}]}]}], ",", 
         
         RowBox[{"functionargs", "[", "function", "]"}]}], "}"}], "]"}], ",", 
      " ", "body", ",", " ", "lower"}], "}"}]}]}], "//", 
  "TreeForm"}]], "Input",ExpressionUUID->"8597eac9-656e-4954-91f9-\
4cb34d53bcfd"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQA2IQPdF8V3uX2n97btWaqJgjIg6HWa87Xd993T7YRbHo
4RlBON/keI/w2VW8DgxQABFnh8o/t0flw/QzOkDoj3D+jbD4+fz6PA4w82Hi
MPMh9F+4eTA+TB1E/Lv9ESgNE4fxYeoPQN0F8ReLAzof1b3scPvXb/F7Ns9D
GM5HDQd2NHGEu2H21zwz1A7azAW379vlz3+VAwXgfPRwhJkP48PiATX8BOHm
w+RhfIi7xDHkYe4FAFsa05A=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 8}, {2, 3}, {3, 4}, {3, 5}, {5, 6}, {5, 7}, {8, 
       9}, {8, 17}, {8, 18}, {9, 10}, {9, 16}, {10, 11}, {11, 12}, {11, 13}, {
       13, 14}, {13, 15}, {18, 19}, {18, 30}, {19, 20}, {19, 26}, {20, 21}, {
       21, 22}, {21, 23}, {23, 24}, {23, 25}, {26, 27}, {26, 28}, {26, 
       29}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", 
               RowBox[{"{", 
                 RowBox[{"2", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Range\"", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                    "\"10\""}], "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                    "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"[{2, {1, 3}}], {{
            "Range"[{1, {1, 3}}], "10"}, ",", {{
             "Mod"[{2, {2, 3}}], {"#", ",", "3"}}, "&"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", 
           RowBox[{"{", 
             RowBox[{"2", ",", 
               RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[{2, {1, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", 
             RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, {1, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Range\"", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                 "\"10\""}], "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                   "}"}], ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"[{1, {1, 3}}], "10"}, ",", {{
            "Mod"[{2, {2, 3}}], {"#", ",", "3"}}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Range\"", "[", 
               RowBox[{"{", 
                 RowBox[{"1", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             "\"10\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"[{1, {1, 3}}], "10"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"\"Range\"", "[", 
           RowBox[{"{", 
             RowBox[{"1", ",", 
               RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"[{1, {1, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", 
             RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, {1, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Mod\"", "[", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
               "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"[{2, {2, 3}}], {"#", ",", "3"}}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Mod\"", "[", 
               RowBox[{"{", 
                 RowBox[{"2", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"[{2, {2, 3}}], {"#", ",", "3"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox[
         RowBox[{"\"Mod\"", "[", 
           RowBox[{"{", 
             RowBox[{"2", ",", 
               RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"[{2, {2, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", 
             RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, {2, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 22],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 23],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 24],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 25],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 26],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 27],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 28],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 29],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 30],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQA2IQPdF8V3uX2n97btWaqJgjIg6HWa87Xd993T7YRbHo
4RlBON/keI/w2VW8DgxQABFnh8o/t0flw/QzOkDoj3D+jbD4+fz6PA4w82Hi
MPMh9F+4eTA+TB1E/Lv9ESgNE4fxYeoPQN0F8ReLAzof1b3scPvXb/F7Ns9D
GM5HDQd2NHGEu2H21zwz1A7azAW379vlz3+VAwXgfPRwhJkP48PiATX8BOHm
w+RhfIi7xDHkYe4FAFsa05A=
     "]]& ],
  AspectRatio->NCache[4 17^Rational[-1, 2], 0.9701425001453319],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.771100545831553*^9, {3.771100602089704*^9, 3.7711006219335203`*^9}, 
   3.7711006693644533`*^9, {3.771100756712397*^9, 3.771100761777763*^9}, 
   3.771105044095984*^9, {3.771106152563485*^9, 3.7711061761582317`*^9}},
 CellLabel->
  "Out[217]//TreeForm=",ExpressionUUID->"1e84e46c-9437-4379-a9f8-\
034e12570c5e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other stuff:", "Subsubsection",
 CellChangeTimes->{{3.771100537668374*^9, 
  3.771100542814341*^9}},ExpressionUUID->"7b792bbc-5629-4e56-a71e-\
87272bf0be00"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.771100210365686*^9},ExpressionUUID->"535c5026-367d-4057-ae39-\
23eff2d57ec5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "upper___", ",", "function_", ",", "open_", ",", "body___", ",", 
       "close_", ",", "lower___"}], "}"}], "/;", " ", 
     RowBox[{
      RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
      RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], "  ", "\[RuleDelayed]", 
    " ", 
    RowBox[{"{", 
     RowBox[{"upper", ",", " ", 
      RowBox[{"function", "[", 
       RowBox[{"1", "+", 
        RowBox[{"Length", "@", 
         RowBox[{
          RowBox[{"Cases", "[", "\"\<,\>\"", "]"}], "@", "body"}]}]}], "]"}], 
      ",", " ", "body", ",", " ", "lower"}], "}"}]}]}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{
  3.771099515517374*^9, {3.771099556334687*^9, 3.77109956269461*^9}, {
   3.7710996938908873`*^9, 3.771099743045671*^9}, {3.771100060976138*^9, 
   3.771100082718751*^9}, {3.771100160887362*^9, 3.771100184366568*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"65c540b3-3257-4e45-af3e-4105e8f22fc3"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.8086075400626399, 4.043037700313199}, {0., 
    3.2344301602505596`}, {0., 2.42582262018792}, {1.6172150801252798`, 
    3.2344301602505596`}, {0.8086075400626399, 2.42582262018792}, {
    0.40430377003131995`, 1.6172150801252796`}, {0.40430377003131995`, 
    0.8086075400626398}, {1.21291131009396, 1.6172150801252796`}, {
    1.6172150801252798`, 2.42582262018792}, {2.42582262018792, 
    2.42582262018792}, {2.0215188501565997`, 1.6172150801252796`}, {
    1.21291131009396, 0.8086075400626398}, {1.21291131009396, 0.}, {
    2.8301263902192395`, 0.8086075400626398}, {2.0215188501565997`, 0.}, {
    2.8301263902192395`, 0.}, {3.6387339302818797`, 0.}, {2.8301263902192395`,
     1.6172150801252796`}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 4}, {2, 3}, {4, 5}, {4, 9}, {4, 10}, {5, 6}, {5, 
       8}, {6, 7}, {10, 11}, {10, 18}, {11, 12}, {11, 14}, {12, 13}, {14, 
       15}, {14, 16}, {14, 17}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", "2", "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                    "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"[2], {{
            "Range"[1], "10"}, ",", {{
             "Mod"[2], {"#", ",", "3"}}, "&"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", "2", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], "}"}],
              ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                   "}"}], ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"[1], "10"}, ",", {{
            "Mod"[2], {"#", ",", "3"}}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"[1], "10"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"\"Range\"", "[", "1", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"[1]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
               "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"[2], {"#", ",", "3"}}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"[2], {"#", ",", "3"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"\"Mod\"", "[", "2", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"[2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.8086075400626399, 4.043037700313199}, {0., 
     3.2344301602505596`}, {0., 2.42582262018792}, {1.6172150801252798`, 
     3.2344301602505596`}, {0.8086075400626399, 2.42582262018792}, {
     0.40430377003131995`, 1.6172150801252796`}, {0.40430377003131995`, 
     0.8086075400626398}, {1.21291131009396, 1.6172150801252796`}, {
     1.6172150801252798`, 2.42582262018792}, {2.42582262018792, 
     2.42582262018792}, {2.0215188501565997`, 1.6172150801252796`}, {
     1.21291131009396, 0.8086075400626398}, {1.21291131009396, 0.}, {
     2.8301263902192395`, 0.8086075400626398}, {2.0215188501565997`, 0.}, {
     2.8301263902192395`, 0.}, {3.6387339302818797`, 0.}, {
     2.8301263902192395`, 1.6172150801252796`}}]& ],
  AspectRatio->1,
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.77110013513527*^9, 3.771100186061811*^9}},
 CellLabel->
  "Out[133]//TreeForm=",ExpressionUUID->"5225a11d-6d32-48f9-b545-\
0473275fa30b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"/;", 
   RowBox[{"Echo", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"body", ",", 
       RowBox[{"Length", "[", "body", "]"}]}], "}"}], ",", 
     "\"\<Body Length\>\""}], "]"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771097215775105*^9, 
  3.7710972220179777`*^9}},ExpressionUUID->"aa5a3f0a-f5ea-48dc-a21e-\
a9269c0d4f15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cases", "[", 
   RowBox[{"myexpr", ",", 
    RowBox[{"{", 
     RowBox[{"___", ",", "open_", ",", "body___", ",", "close_", ",", "___"}],
      "}"}], ",", 
    RowBox[{"Depth", "[", "myexpr", "]"}]}], "]"}], "//", "Column"}]], "Input",\

 CellChangeTimes->{{3.7710975975791903`*^9, 3.77109769676134*^9}, {
  3.771097827179023*^9, 3.771097836665967*^9}, {3.771097948489615*^9, 
  3.7710979607106657`*^9}, {3.7710980671149397`*^9, 3.771098131616016*^9}, {
  3.771098839006569*^9, 3.771098929585428*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"38674d8e-ed32-4dc9-aa3f-f84be66368d4"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
       RowBox[{"{", 
        RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
         RowBox[{"{", 
          RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
         ",", "\<\"]\"\>"}], "}"}], ",", "\<\"&\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
         ",", "\<\"]\"\>"}], "}"}], ",", "\<\",\"\>", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
           RowBox[{"{", 
            RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
           ",", "\<\"]\"\>"}], "}"}], ",", "\<\"&\"\>"}], "}"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.771097662420046*^9, 3.771097697096024*^9}, {
  3.771098833084075*^9, 3.7710989331842813`*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"5003cce1-3f80-416c-8bb4-e3ff8a2cd008"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.771154758579706*^9, 
  3.771154785988488*^9}},ExpressionUUID->"4bb4cad2-75ec-42aa-9747-\
5691d846299c"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{3.771154781957446*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"8dcc0549-d026-49e5-88c1-50def4436f07"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Back to Tim\[CloseCurlyQuote]s Idea:", "Section",
 CellChangeTimes->{{3.771109250852078*^9, 3.77110925961491*^9}, {
  3.7711674542436447`*^9, 
  3.771167457920483*^9}},ExpressionUUID->"4dd3a727-e898-4808-8f8c-\
297eaea0425f"],

Cell[CellGroupData[{

Cell["\<\
(* Convert an expression to a flattened String and try to build the tree \
correctly *)\
\>", "Subsection",
 CellChangeTimes->{{3.771151799746903*^9, 3.771151822131543*^9}, 
   3.771168973244226*^9},ExpressionUUID->"c2779de8-0627-4fc9-995f-\
cef9cffc169b"],

Cell[CellGroupData[{

Cell["Initialise:", "Subsubsection",
 CellChangeTimes->{{3.771168989985139*^9, 
  3.771168992305181*^9}},ExpressionUUID->"d118b056-7b7f-4fbf-ba28-\
3f4cdae9e97b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mystring", "=", 
  RowBox[{
  "makeExpressionString", "[", 
   "\"\<SortBy[Range[\[Pi] Cos[10.3]], Mod[#1, 3 & ]]\>\"", "]"}]}]], "Input",\

 CellChangeTimes->{{3.771148704592462*^9, 3.771148796257435*^9}, {
   3.7711490976434517`*^9, 3.7711491178322363`*^9}, {3.7711492014342337`*^9, 
   3.771149206073814*^9}, 3.7711547912502003`*^9, {3.771166753527864*^9, 
   3.7711667546861877`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"87f29f19-325d-42c8-a575-4214547c6cbc"],

Cell[BoxData["\<\"\\\"SortBy[Range[\[Pi] Cos[10.3]], Mod[#1, 3 & \
]]\\\"\"\>"], "Output",
 CellChangeTimes->{{3.7711487635340023`*^9, 3.771148792897266*^9}, {
   3.7711489440804234`*^9, 3.77114895835853*^9}, {3.771149099612533*^9, 
   3.771149118466486*^9}, 3.771149208198206*^9, 3.771149285768384*^9, 
   3.7711547926469088`*^9, 3.771154895686252*^9, 3.7711550380914173`*^9, 
   3.7711576468331347`*^9, 3.77115851002102*^9, 3.771158559492669*^9, 
   3.771165806875161*^9, 3.771166755597762*^9, 3.7711684140428677`*^9, 
   3.7711688069314623`*^9, 3.771168883083654*^9, 3.771198481917657*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"84aae777-4ade-49d5-917c-8ea06b8a1452"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"Cos", "[", "10.3", "]"}]}], "]"}], ",", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{"#1", ",", " ", 
       RowBox[{"3", " ", "&"}]}], " ", "]"}]}], "]"}], "//", "Hold"}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7711693422640667`*^9, 3.771169346496661*^9}},
 CellLabel->"",ExpressionUUID->"1a435330-12fa-4443-9c48-c7be24ed0ae4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loop Over:", "Subsubsection",
 CellChangeTimes->{{3.7711690078748093`*^9, 
  3.771169016989286*^9}},ExpressionUUID->"b5603ec9-7a4f-4477-b3f2-\
ff0903ae96d6"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Trouble", " ", "when", " ", "a", " ", "functions", " ", "name", " ", "is",
     " ", "composed", " ", "out", " ", "of", " ", "two", " ", "other", " ", 
    "function", " ", 
    RowBox[{"names", ":", " ", 
     RowBox[{"eg", " ", "IntegerPart"}]}]}], " ", "\[Rule]", " ", 
   RowBox[{
   "Integet", " ", "and", " ", "Part", " ", "are", " ", "also", " ", 
    "funtions"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7711553944116297`*^9, 
  3.7711554498789263`*^9}},ExpressionUUID->"e568f8ba-6930-41b6-8856-\
cd37aae291b5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Take", " ", "the", " ", "indexes", " ", "of", " ", "the", " ", "functions",
    " ", "that", " ", "have", " ", "a", " ", "head", " ", "which", " ", "is", 
   " ", "a", " ", "known", " ", "function", " ", "and", " ", "are", " ", 
   "between", " ", 
   RowBox[{"brackets", ".", " ", "Also"}], " ", "they", " ", 
   RowBox[{"shouldn", "'"}], "t", " ", "include", " ", "any", " ", 
   "subfunctions"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771151867056295*^9, 
  3.771151944984441*^9}},ExpressionUUID->"7c785745-ca60-4742-aff6-\
b35f8472c878"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"body", ",", "\"\<Argument\>\""}], "]"}], "]"}], "&&"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7711688015877743`*^9, 
  3.7711688037772913`*^9}},ExpressionUUID->"cfff4df8-53d7-4d4d-b9ca-\
702067f7d217"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ranges", "=", 
   RowBox[{"StringPosition", "[", 
    RowBox[{"mystring", ",", 
     RowBox[{
      RowBox[{
      "head__", "~~", "\"\<[\>\"", "~~", "body___", "~~", "\"\<]\>\""}], 
      "\[IndentingNewLine]", "/;", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "head", "}"}], "\[Equal]", 
        RowBox[{"Names", "[", "head", "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"body", ",", 
            RowBox[{"xx__", "/;", 
             RowBox[{
              RowBox[{"Names", "[", "xx", "]"}], "\[Equal]", 
              RowBox[{"{", "xx", "}"}]}]}]}], "]"}], "==", 
          RowBox[{"{", "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"&&", " ", 
         RowBox[{
          RowBox[{"Names", "[", "body", "]"}], "\[Equal]", " ", 
          RowBox[{"{", "}"}]}]}], "*)"}], "&&", 
       RowBox[{
        RowBox[{"StringCount", "[", 
         RowBox[{"body", ",", "\"\<[\>\""}], "]"}], "\[Equal]", 
        RowBox[{"StringCount", "[", 
         RowBox[{"body", ",", "\"\<]\>\""}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Overlaps", "\[Rule]", "All"}]}], "]"}]}], ";", " ", 
  RowBox[{"ranges", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.77114951366714*^9, 3.77114951982067*^9}, {
   3.771149570288886*^9, 3.771149659156468*^9}, {3.771149764165124*^9, 
   3.7711497838764*^9}, {3.7711498779811087`*^9, 3.7711498858085012`*^9}, {
   3.771150009279001*^9, 3.7711500271595917`*^9}, {3.77115013112241*^9, 
   3.771150135273314*^9}, 3.771150188089007*^9, {3.771150219666781*^9, 
   3.771150271631009*^9}, 3.771150923071639*^9, {3.77115096737051*^9, 
   3.771150995445312*^9}, {3.7711510302176523`*^9, 3.771151030375718*^9}, {
   3.771151086950554*^9, 3.77115111824788*^9}, {3.7711516109307127`*^9, 
   3.771151616126514*^9}, 3.7711682404155903`*^9, {3.7711687998143597`*^9, 
   3.771168813654099*^9}, {3.771169119579743*^9, 3.7711691384421597`*^9}, {
   3.771169431100143*^9, 3.771169442583837*^9}, {3.771169511503811*^9, 
   3.771169513806608*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"b3ee4191-2258-4f3b-88e0-7c2a47c2f1bf"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"2", ",", "41"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"9", ",", "40"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"9", ",", "25"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"28", ",", "40"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.771149637932125*^9, 3.771149659693076*^9}, {
   3.7711497752829227`*^9, 3.771149784859321*^9}, 3.771149881092749*^9, 
   3.771150029042816*^9, 3.771150139430941*^9, {3.771150223831119*^9, 
   3.7711502422456827`*^9}, 3.771150273051094*^9, 3.771150924395047*^9, 
   3.7711509969795103`*^9, 3.771151119082267*^9, 3.7711516173813887`*^9, 
   3.771154843072432*^9, 3.771154902996011*^9, 3.7711550454110403`*^9, 
   3.771157307849545*^9, {3.771157354229171*^9, 3.7711573743498707`*^9}, 
   3.771157439328042*^9, 3.771157583470149*^9, 3.7711576194619217`*^9, {
   3.771157694874745*^9, 3.771157719883871*^9}, 3.7711577934212112`*^9, {
   3.771168228980932*^9, 3.771168241370553*^9}, {3.771168418318117*^9, 
   3.771168434765192*^9}, 3.771168485525573*^9, 3.771168814496657*^9, {
   3.771168890560083*^9, 3.771168914720385*^9}, 3.771169449854322*^9, 
   3.771169514980465*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"85ad3507-2dc1-4cb1-8e6c-f52dcb602945"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio:", "Subsubsection",
 CellChangeTimes->{{3.771169872823264*^9, 3.771169882226671*^9}, {
  3.771185800648929*^9, 
  3.771185801098241*^9}},ExpressionUUID->"28a794ab-5780-4e2d-ba77-\
8a5a4cec6922"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", "[", 
  RowBox[{"a", "[", 
   RowBox[{"a", "[", 
    RowBox[{"a", "[", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7711696320192327`*^9, 3.771169635928521*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"97705cae-037f-46b0-a781-ef48ed26afaa"],

Cell[BoxData[
 RowBox[{"a", "[", 
  RowBox[{"a", "[", 
   RowBox[{"a", "[", 
    RowBox[{"a", "[", "]"}], "]"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.771169636634479*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"4db8f41d-50ae-48c4-bd1a-22bd9782471a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<a[b[], foo[g[Plot[]]]]\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.771169692260757*^9, 3.771169696763339*^9}, {
  3.7711714221172*^9, 3.771171427741297*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"175f330a-ef54-4063-89af-9fe30762b035"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"level", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"head", "=", "None"}], ";"}], "\n", 
 RowBox[{"Reap", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"StringCases", "[", 
     RowBox[{"str", ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<[\>\"", "\[RuleDelayed]", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<current head is: \>\"", ",", " ", "head"}], "]"}], 
            ";", 
            RowBox[{"level", "++"}]}], ",", "\"\<level\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<]\>\"", "\[RuleDelayed]", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<current head is: \>\"", ",", " ", "head"}], "]"}], 
            ";", 
            RowBox[{"level", "--"}]}], ",", "\"\<level\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"h", ":", 
          RowBox[{"LetterCharacter", ".."}]}], "\[RuleDelayed]", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"head", "=", "h"}], ",", "\"\<head\>\""}], "]"}]}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", "_", ",", "Rule"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.771171257374958*^9, 3.771171260691312*^9}, 
   3.771171431226577*^9, {3.7711715036620607`*^9, 3.771171553438817*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"360b4722-20b6-4f2e-a706-e9d8ae8bf841"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"a\"\>"}],
  SequenceForm["current head is: ", "a"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.7711715554338837`*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"ee3930ba-c51e-4612-8617-d94ffe1a518f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"b\"\>"}],
  SequenceForm["current head is: ", "b"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555436105*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"a1f76dad-3c82-4a12-993a-9ec8dac56cb0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"b\"\>"}],
  SequenceForm["current head is: ", "b"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555443142*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"9aa8af6f-9391-484e-8a2a-641e809648b6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"foo\"\>"}],
  SequenceForm["current head is: ", "foo"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.7711715554462023`*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"9f575dcb-08b6-4b57-a79c-48698a77a177"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"g\"\>"}],
  SequenceForm["current head is: ", "g"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555450255*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"587f590b-e5a5-4f35-adda-fdd45df27649"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"Plot\"\>"}],
  SequenceForm["current head is: ", "Plot"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.7711715554542828`*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"1260dfe9-06c7-4780-880e-2cd443f67231"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"Plot\"\>"}],
  SequenceForm["current head is: ", "Plot"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555457595*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"87f1e9e7-02f0-420d-bc04-64d296634e5a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"Plot\"\>"}],
  SequenceForm["current head is: ", "Plot"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555460087*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"27e52ad8-7c7d-405c-b5d0-1de115cbd427"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"Plot\"\>"}],
  SequenceForm["current head is: ", "Plot"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555462448*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"48b16a93-9c14-43a2-a01a-7db8050a4592"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current head is: \"\>", "\[InvisibleSpace]", "\<\"Plot\"\>"}],
  SequenceForm["current head is: ", "Plot"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.771171470914731*^9, 3.7711715050967703`*^9, {3.771171535697546*^9, 
   3.771171555464538*^9}},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"c31b5bef-bda1-4236-8bda-16c01d625276"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"head\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\<\"a\"\>", ",", "\<\"b\"\>", ",", "\<\"foo\"\>", 
        ",", "\<\"g\"\>", ",", "\<\"Plot\"\>"}], "}"}]}], ",", 
     RowBox[{"\<\"level\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "2", ",", "1", ",", "2", ",", "3", ",", "4", ",", 
        "3", ",", "2", ",", "1"}], "}"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.771171297398591*^9, 3.7711713177005*^9}, {
   3.771171386321665*^9, 3.771171432586998*^9}, 3.771171470929863*^9, 
   3.771171505117031*^9, {3.7711715357170258`*^9, 3.771171555466467*^9}},
 CellLabel->
  "Out[159]=",ExpressionUUID->"9eae6860-2563-43c8-93f8-fdd642b12888"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"str", ",", "\"\<[\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Rule]", "1"}], "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"str", ",", "\"\<]\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Rule]", 
      RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "KeySort"}]], "Input",
 CellChangeTimes->{{3.771169597009177*^9, 3.771169642128646*^9}, {
  3.7711696824632807`*^9, 3.771169701201804*^9}, {3.771169745271475*^9, 
  3.7711698021395683`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"90e5d13f-5888-453c-adda-71ac8d7905f5"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"2", "\[Rule]", "1"}], ",", 
   RowBox[{"4", "\[Rule]", "1"}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"9", "\[Rule]", "1"}], ",", 
   RowBox[{"11", "\[Rule]", "1"}], ",", 
   RowBox[{"13", "\[Rule]", "1"}], ",", 
   RowBox[{"14", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"15", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"16", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"17", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7711696426227016`*^9, {3.771169687016981*^9, 3.771169706795788*^9}, {
   3.771169747934969*^9, 3.7711698251236258`*^9}},
 CellLabel->
  "Out[132]=",ExpressionUUID->"16b2b297-22d0-425f-a437-1ddec626557a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Accumulate", "[", 
  RowBox[{"Values", "@", "%"}], "]"}]], "Input",
 CellChangeTimes->{{3.771169819568954*^9, 3.771169828282811*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"3b430ac3-ab1d-480e-8737-01862d76e2f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "1", ",", "2", ",", "3", ",", "4", ",", "3", ",", "2", 
   ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7711698219446*^9, 3.771169829054339*^9}},
 CellLabel->
  "Out[133]=",ExpressionUUID->"a29328a9-1def-4187-b7e2-1e9a2110295d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Plus", "[", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7711719202496023`*^9, 3.7711719499678183`*^9}, {
  3.771171980700736*^9, 
  3.771172018223154*^9}},ExpressionUUID->"f0f95dc6-6919-4c77-bb53-\
dcc383db4a43"],

Cell[BoxData[
 RowBox[{"Plus", "[", 
  RowBox[{
   RowBox[{"Cos", "[", "1", "]"}], ",", "2", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.771171953221281*^9, 
  3.7711719680844917`*^9}},ExpressionUUID->"b2c6e0c3-8315-411a-ad52-\
b3fc4c9397ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"str", ",", "\"\<]\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Rule]", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771169597009177*^9, 3.771169645883148*^9}, 
   3.771169705321422*^9, {3.771169750200016*^9, 3.771169785025243*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"b163e36f-9a9b-45f5-b016-bab6139e0569"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"5", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"14", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"15", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"16", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"17", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7711696466891212`*^9, {3.771169688077005*^9, 3.771169707656687*^9}, 
   3.771169752573292*^9, 3.771169785382326*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"c21fa757-29a5-4483-8233-6d92fa59d9b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"functions", "=", 
   RowBox[{"StringTake", "[", 
    RowBox[{"mystring", ",", "ranges"}], "]"}]}], ";", 
  RowBox[{"functions", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.771150328993743*^9, 3.771150345757676*^9}, {
  3.771150869957679*^9, 3.771150905548587*^9}, {3.771150937774065*^9, 
  3.7711509394242353`*^9}, {3.771151535337881*^9, 3.771151544237355*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"e24f767f-5584-4050-b944-338223b9bbe9"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"SortBy[Range[\[Pi] argument], Mod[#1, 3 & ]]\"\>"},
    {"\<\"Range[\[Pi] argument], Mod[#1, 3 & ]\"\>"},
    {"\<\"Range[\[Pi] argument]\"\>"},
    {"\<\"Mod[#1, 3 & ]\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.771150346238007*^9, {3.771150870980463*^9, 3.771150905928507*^9}, 
   3.771150939759015*^9, 3.771150999825014*^9, 3.771151121444735*^9, 
   3.771151545227556*^9, 3.7711516207785673`*^9, 3.77115484853022*^9, 
   3.771154908152885*^9, 3.771155049501687*^9, 3.771157311302197*^9, {
   3.7711573491232986`*^9, 3.771157377678226*^9}, 3.771157441932954*^9, {
   3.771157594611433*^9, 3.771157621098133*^9}, {3.771157695978869*^9, 
   3.771157721018518*^9}, 3.771157794518033*^9, 3.771168248907065*^9, {
   3.7711684222681017`*^9, 3.771168436426112*^9}, 3.7711684873987627`*^9, 
   3.771168818589396*^9, {3.771168893673284*^9, 3.771168916960907*^9}, 
   3.771169484510103*^9, 3.771169517894311*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"8355e462-2217-4a50-b079-85c0613acd40"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Count", " ", "the", " ", "arguments", " ", "each", " ", "function", " ", 
   "has"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771151980845292*^9, 
  3.771151994270718*^9}},ExpressionUUID->"a7f3ea05-4c58-460a-a087-\
5a1a4debb836"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.771169930371517*^9, 
  3.771169936489358*^9}},ExpressionUUID->"d9a41f1f-147a-45e6-aa7d-\
6ae80ca9b8a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"argnumbers", "=", 
   RowBox[{
    RowBox[{"StringCount", "[", 
     RowBox[{"functions", ",", "\"\<,\>\""}], "]"}], "+", "1"}]}], ";", 
  "argnumbers"}]], "Input",
 CellChangeTimes->{{3.7711515197619047`*^9, 3.771151554751515*^9}, {
  3.771151655118705*^9, 3.771151679258297*^9}, {3.7711561134403143`*^9, 
  3.771156117326272*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"30c7c9cd-0de6-4ec9-a7ea-15fbfe07fd3e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.771151555384492*^9, {3.771151650157589*^9, 3.771151679734228*^9}, 
   3.771155263162334*^9, 3.7711561249997263`*^9, 3.771157444195776*^9, {
   3.771157597026917*^9, 3.771157623261998*^9}, {3.7711576978638*^9, 
   3.771157722021338*^9}, 3.771157795517796*^9, 3.771168253412232*^9, 
   3.771168439940311*^9, 3.771168491385741*^9, 3.7711688211845493`*^9, {
   3.771168895347559*^9, 3.771168919745542*^9}},
 CellLabel->
  "Out[101]=",ExpressionUUID->"03be197d-d3b3-4071-9110-f78aac324e78"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Count", " ", "the", " ", "arguments", " ", "each", " ", "function", " ", 
   "should", " ", "have"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7711519986382093`*^9, 
  3.7711520096130457`*^9}},ExpressionUUID->"6e5f6ad1-b51d-416b-b30a-\
6824553b508a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"idealargnumbers", "=", 
  RowBox[{"functionargs", "/@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"functions", ",", 
      RowBox[{
       RowBox[{"head__", " ", "/;", " ", 
        RowBox[{
         RowBox[{"{", "head", "}"}], "\[Equal]", 
         RowBox[{"Names", "[", "head", "]"}]}]}], "\[RuleDelayed]", " ", 
       "head"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.771152056990675*^9, 3.7711520702386427`*^9}, {
  3.771152135660637*^9, 3.771152360672679*^9}, {3.7711525541473627`*^9, 
  3.7711525573972197`*^9}, {3.77116916470619*^9, 
  3.77116917060148*^9}},ExpressionUUID->"c4597767-ff94-4cb4-923a-\
f9c52c704bf4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7711521770211353`*^9, 3.771152361065056*^9}, 
   3.771152561588252*^9, 3.771155267781002*^9, 3.771155342306385*^9, 
   3.771157448727614*^9, {3.771157598867133*^9, 3.771157625213382*^9}, {
   3.7711576989827757`*^9, 3.771157723259245*^9}, 3.771157799224728*^9, {
   3.771168259822467*^9, 3.7711682871773367`*^9}, 3.771168442605934*^9, 
   3.77116849290193*^9, 3.771168823503984*^9, {3.771168897880662*^9, 
   3.7711689220824347`*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"3db4a1a5-0a53-4129-a080-c1d41cf367a7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Check", " ", "if", " ", "any", " ", "of", " ", "the", " ", "functions", 
   " ", "has", " ", "exactly", " ", "the", " ", "number", " ", "of", " ", 
   "arguments", " ", "that", " ", "should", " ", "be", " ", "used", " ", "as",
    " ", "input"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771156501824773*^9, 
  3.7711565468781424`*^9}},ExpressionUUID->"7a7d77b3-4809-4792-98e3-\
cc903f49ce55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exactarguments", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"argnumbers", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}], "==", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Range", "@@@", "idealargnumbers"}], ")"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "argnumbers", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.771156423920712*^9, 3.771156499333247*^9}, {
  3.771156670724204*^9, 3.771156680931698*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"9f0fe650-40e7-4141-a205-1369567be164"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{{3.771156464617218*^9, 3.77115649972994*^9}, 
   3.7711566831322927`*^9, 3.7711574664823713`*^9, {3.771157603550559*^9, 
   3.771157633377592*^9}, {3.771157701084606*^9, 3.771157724264835*^9}, 
   3.77115780057819*^9, 3.7711682904038153`*^9, 3.7711684449731493`*^9, 
   3.771168494471426*^9, 3.771168826253598*^9, {3.7711689003960733`*^9, 
   3.771168924181046*^9}},
 CellLabel->
  "Out[103]=",ExpressionUUID->"2459fb8f-88fb-4ecc-9964-3a9fcf1092f8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "When", " ", "the", " ", "arguments", " ", "are", " ", "exactly", " ", 
     "correct"}], ",", " ", 
    RowBox[{
    "replace", " ", "with", " ", "the", " ", "the", " ", "string", " ", 
     "\"\<argument\>\"", " ", "so", " ", "it", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "get", " ", "picked", " ", "up", " ", 
     "again"}]}], " ", "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.771156820294827*^9, 3.771156845395174*^9}, {
  3.771169052095077*^9, 
  3.7711690679603643`*^9}},ExpressionUUID->"9820f749-f25c-4f0c-8ecf-\
8258562825ac"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TO", " ", 
   RowBox[{"DO", ":", " ", 
    RowBox[{
    "Find", " ", "the", " ", "Wolfram", " ", "whay", " ", "to", " ", "do", 
     " ", "it"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.77115684636451*^9, 3.771156880706574*^9}, {
  3.7711570800739*^9, 
  3.771157117206091*^9}},ExpressionUUID->"bb1448aa-2038-44cd-b24a-\
71d0a8538139"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tempstring", "=", "mystring"}], ";"}]], "Input",
 CellChangeTimes->{{3.771156967862101*^9, 3.771156982249741*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"474260f1-13d3-4aeb-aa89-ef640e5c67fc"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"tempstring", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"tempstring", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"functions", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "/;", " ", 
        RowBox[{"exactarguments", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "\[Rule]", "\"\<argument\>\""}]}],
      "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", 
     RowBox[{"Length", "[", "argnumbers", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771156890983859*^9, 3.771156989408839*^9}, {
  3.7711570285284443`*^9, 3.771157030462578*^9}, {3.771157516798786*^9, 
  3.771157520828146*^9}, {3.771157754566537*^9, 3.7711577808733397`*^9}, {
  3.771168389548664*^9, 3.771168404128724*^9}, {3.771168869073226*^9, 
  3.771168870322967*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"6306e152-5482-4174-9e2e-2a4c5745c3fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mystring", "=", "tempstring"}]], "Input",
 CellChangeTimes->{{3.771157000127784*^9, 3.771157001059389*^9}, {
  3.771157424829818*^9, 3.771157427952684*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"7f21b480-dd62-42d2-a0b4-5e87591d03b4"],

Cell[BoxData["\<\"\\\"SortBy[Range[\[Pi] argument], Mod[#1, 3 & ]]\\\"\"\>"], \
"Output",
 CellChangeTimes->{
  3.771157001563386*^9, 3.771157033146412*^9, 3.771157429526079*^9, 
   3.771157473880327*^9, 3.7711576094466047`*^9, 3.771157640447016*^9, {
   3.771157704628804*^9, 3.771157727456643*^9}, {3.7711577622796383`*^9, 
   3.771157804276519*^9}, 3.771168303107884*^9, {3.771168474014516*^9, 
   3.771168500000493*^9}, 3.771168834389927*^9, {3.771168878704543*^9, 
   3.7711689335512447`*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"7978084a-dc08-45cf-a4d2-05dd11fb1c44"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Giulio 3/07", "Section",
 CellChangeTimes->{{3.7711585200491867`*^9, 3.771158521556636*^9}, {
  3.7711727165136642`*^9, 
  3.7711727282919817`*^9}},ExpressionUUID->"3c59a7bb-b2f7-42e2-87a0-\
9771dbcf350b"],

Cell[BoxData[
 RowBox[{"(*", " "}]], "Input",
 CellChangeTimes->{{3.771171111944339*^9, 
  3.771171114787211*^9}},ExpressionUUID->"fee77e30-5f43-4642-bae6-\
3724dd262fd9"],

Cell[BoxData["level"], "Input",
 CellChangeTimes->{{3.77117033208884*^9, 
  3.771170332629736*^9}},ExpressionUUID->"990d20ef-0775-407a-bde3-\
784e59f19201"],

Cell[BoxData["inPartlevel"], "Input",
 CellChangeTimes->{{3.771170480394354*^9, 3.771170482653191*^9}, {
  3.77117055346091*^9, 
  3.771170554183363*^9}},ExpressionUUID->"cca0b45c-f721-40df-ae0b-\
de548bd9c0c3"],

Cell[BoxData["inString"], "Input",
 CellChangeTimes->{{3.771170604573844*^9, 
  3.7711706054581547`*^9}},ExpressionUUID->"4411fd53-3fde-4bf1-b870-\
ab6ba5c3857b"],

Cell[BoxData["inComment"], "Input",
 CellChangeTimes->{{3.7711706020497417`*^9, 
  3.771170603123311*^9}},ExpressionUUID->"76fb4f43-bfe2-4284-87be-\
2488e07cc4a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"head", ",", "argcount", ",", "id"}], "}"}]], "Input",
 CellChangeTimes->{{3.7711700350263977`*^9, 3.771170050212635*^9}, {
   3.771170154294566*^9, 3.771170154814446*^9}, 
   3.771170307887*^9},ExpressionUUID->"dbc633e2-994e-45a6-aee6-30422e65be09"],

Cell[BoxData[
 RowBox[{"j", "[", "["}]], "Input",
 CellChangeTimes->{{3.7711704149052057`*^9, 3.7711704150270653`*^9}, {
  3.771170471096676*^9, 
  3.7711704760898314`*^9}},ExpressionUUID->"468480c3-209a-4b27-8896-\
ce7b7d08fd8c"],

Cell[BoxData["["], "Input",
 CellChangeTimes->{
  3.7711704983405*^9},ExpressionUUID->"8e0a8c04-a2d5-4146-b8ba-591c948f3d9f"],

Cell[BoxData[
 RowBox[{"]", "]"}]], "Input",
 CellChangeTimes->{{3.771170500183921*^9, 
  3.771170524765485*^9}},ExpressionUUID->"5e3d0c2c-305b-4a1e-87fc-\
563f16c71cc9"],

Cell[BoxData[","], "Input",
 CellChangeTimes->{
  3.771170561901062*^9},ExpressionUUID->"d4a95e60-b826-4494-95e1-\
d8f5f4910fca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\"\<w\>\"", ",", 
   RowBox[{"22", "->", "\"\<]\>\""}]}], "}"}]], "Input",
 CellChangeTimes->{{3.771170731625705*^9, 
  3.771170750362998*^9}},ExpressionUUID->"495b526e-95cf-4fb4-987d-\
e37d4ea29c27"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\"\<w\>\"", ",", 
   RowBox[{
    RowBox[{"-", "1"}], "->", "\"\<]\>\""}]}], "}"}]], "Input",
 CellChangeTimes->{{3.771170804712381*^9, 
  3.771170807429072*^9}},ExpressionUUID->"68772852-22d9-42f1-81e3-\
cb568dd8590d"],

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"[", "]"}]}]], "Input",
 CellChangeTimes->{{3.771170903923889*^9, 3.771170904825589*^9}, {
  3.771171084488302*^9, 
  3.771171085677945*^9}},ExpressionUUID->"ebefafd5-f55b-4c5f-ac1f-\
7dfd04cd9277"],

Cell[CellGroupData[{

Cell[BoxData["mystring"], "Input",
 CellChangeTimes->{{3.771166528574678*^9, 3.771166529548595*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"e2009d35-55cd-41f6-b57a-46a678cc3ca4"],

Cell[BoxData["\<\"\\\"SortBy[Range[\[Pi] Argument], Mod[#1, 3 & ]]\\\"\"\>"], \
"Output",
 CellChangeTimes->{3.771166783266004*^9, 3.7711687344975147`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"f6a69672-66d0-47c9-ab71-0fabde211c2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ranges", "=", 
   RowBox[{"StringPosition", "[", 
    RowBox[{"mystring", ",", 
     RowBox[{
      RowBox[{
      "head__", "~~", "\"\<[\>\"", "~~", "body___", "~~", "\"\<]\>\""}], "/;", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"body", ",", "\"\<Argument\>\""}], "]"}], "]"}], "&&", " ", 
       RowBox[{
        RowBox[{"{", "head", "}"}], "\[Equal]", 
        RowBox[{"Names", "[", "head", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{"body", ",", 
          RowBox[{"xx__", "/;", 
           RowBox[{
            RowBox[{"Names", "[", "xx", "]"}], "\[Equal]", 
            RowBox[{"{", "xx", "}"}]}]}]}], "]"}], "==", 
        RowBox[{"{", "}"}]}], "&&", " ", 
       RowBox[{
        RowBox[{"Names", "[", "body", "]"}], "\[Equal]", " ", 
        RowBox[{"{", "}"}]}], "&&", 
       RowBox[{
        RowBox[{"StringCount", "[", 
         RowBox[{"body", ",", "\"\<[\>\""}], "]"}], "\[Equal]", 
        RowBox[{"StringCount", "[", 
         RowBox[{"body", ",", "\"\<]\>\""}], "]"}]}]}]}], ",", 
     RowBox[{"Overlaps", "\[Rule]", "All"}]}], "]"}]}], ";", " ", 
  RowBox[{"ranges", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.7711586177107058`*^9, 3.771158622135591*^9}, {
   3.7711657306479053`*^9, 3.771165775568029*^9}, {3.771165817053212*^9, 
   3.771165874678228*^9}, {3.7711659921106462`*^9, 3.77116603111683*^9}, 
   3.7711661136330147`*^9, {3.771168159244112*^9, 3.771168169886199*^9}, 
   3.771168762407246*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"247b99d8-61e1-460b-82ec-4ad7cf463038"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"17", ",", "25"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"29", ",", "41"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.77116817021338*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"f4d43186-7de9-48a2-aac2-d87b1e2efbbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"functions", "=", 
   RowBox[{"StringTake", "[", 
    RowBox[{"mystring", ",", "ranges"}], "]"}]}], ";", 
  RowBox[{"functions", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.7711585702907248`*^9, 3.7711585727576227`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"29ab3dce-1757-4cad-bc2b-2da7b139b9d1"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Cos[10.3]\"\>"},
    {"\<\"Mod[#1, 3 & ]\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.771158535124558*^9, 3.771158573448965*^9}, 
   3.771158625114406*^9, 3.771165840473115*^9, 3.7711661585384617`*^9, 
   3.77116679397962*^9, 3.771168174947768*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"daad1c49-7810-4f44-a902-502ac4af10fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Range[IntegerPart[10.3]], Mod[#1, 3 & ]\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.771158582952612*^9, 3.7711585993997707`*^9}, 
   3.771158647977468*^9},
 CellLabel->
  "In[181]:=",ExpressionUUID->"95a6c3ff-f953-40d6-9ecb-df23fec00915"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.7711585949486837`*^9, 3.771158599851956*^9}, 
   3.771158649050564*^9},
 CellLabel->
  "Out[181]=",ExpressionUUID->"3dc53af5-2ada-4ed2-838e-24d4d53975b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{"\"\<Range[IntegerPart[10.3]], Mod[#1, 3 & ]\>\"", ",", 
   RowBox[{"xx__", "/;", " ", 
    RowBox[{
     RowBox[{"Names", "[", "xx", "]"}], "\[Equal]", 
     RowBox[{"{", "xx", "}"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771158659001272*^9, 3.771158735422841*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"0224d550-389e-45d3-b5ce-67a7af36ee98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Range\"\>", ",", "\<\"IntegerPart\"\>", ",", "\<\"Mod\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.771158690530305*^9, 3.771158742278614*^9}},
 CellLabel->
  "Out[186]=",ExpressionUUID->"089f70be-9efd-4f3a-bb11-13d2e2ff8f8c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"||", 
  RowBox[{"Echo", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{"body", ",", 
       RowBox[{"xx__", "/;", 
        RowBox[{
         RowBox[{"Names", "[", "xx", "]"}], "\[Equal]", 
         RowBox[{"{", "xx", "}"}]}]}]}], "]"}], ",", 
     RowBox[{"StringCount", "[", 
      RowBox[{"body", ",", "\"\<[\>\""}], "]"}], ",", 
     RowBox[{"StringCount", "[", 
      RowBox[{"body", ",", "\"\<]\>\""}], "]"}]}], "}"}], "]"}]}]], "Input",Ex\
pressionUUID->"ee521011-b23d-4542-9c91-5df942dfc383"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7711681140494747`*^9, 
  3.7711681187986183`*^9}},ExpressionUUID->"e8612c1f-e850-43c8-97e7-\
67953ade0c4e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Delete", " ", "the", " ", "rest"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771168048876357*^9, 3.7711680923537483`*^9}, {
  3.771168143833048*^9, 
  3.771168149193371*^9}},ExpressionUUID->"655cf7da-309c-4bab-b332-\
ff2e9f2d808d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ranges", "//", "Column"}]], "Input",
 CellChangeTimes->{{3.771166885544847*^9, 3.771166993520875*^9}, 
   3.7711670659412403`*^9, {3.771167632978208*^9, 3.771167676689311*^9}, {
   3.7711679946697493`*^9, 3.77116802776705*^9}, {3.7711680963689547`*^9, 
   3.771168142043975*^9}},ExpressionUUID->"4ddc55c0-f0ef-4599-98c5-\
1e18af3b8d35"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"17", ",", "25"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"29", ",", "41"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.771166858566433*^9, 3.7711669579604607`*^9, 3.7711670197784977`*^9, 
   3.771167073198163*^9, 3.771167577508416*^9, 3.7711676513174353`*^9, 
   3.771167996245809*^9, 3.771168028659186*^9, {3.7711681062225246`*^9, 
   3.77116813489703*^9}},
 CellLabel->"Out[40]=",ExpressionUUID->"e82161be-9c9d-49bf-a784-0eeafed610d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"functions", "=", 
   RowBox[{"StringTake", "[", 
    RowBox[{"mystring", ",", "ranges"}], "]"}]}], ";", 
  RowBox[{"functions", "//", "Column"}]}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"b91d90fa-0a40-4a17-bd28-97b1b8b63ff6"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"SortBy[Range[\[Pi] Cos[10.3]], Mod[#1, 3 & ]]\"\>"},
    {"\<\"SortBy[Range[\[Pi] Cos[10.3]], Mod[#1, 3 & ]\"\>"},
    {"\<\"SortBy[Range[\[Pi] Cos[10.3]]\"\>"},
    {"\<\"SortBy[Range[\[Pi] Cos[10.3]\"\>"},
    {"\<\"Range[\[Pi] Cos[10.3]], Mod[#1, 3 & ]]\"\>"},
    {"\<\"Range[\[Pi] Cos[10.3]], Mod[#1, 3 & ]\"\>"},
    {"\<\"Range[\[Pi] Cos[10.3]]\"\>"},
    {"\<\"Range[\[Pi] Cos[10.3]\"\>"},
    {"\<\"Cos[10.3]], Mod[#1, 3 & ]]\"\>"},
    {"\<\"Cos[10.3]], Mod[#1, 3 & ]\"\>"},
    {"\<\"Cos[10.3]]\"\>"},
    {"\<\"Cos[10.3]\"\>"},
    {"\<\"Mod[#1, 3 & ]]\"\>"},
    {"\<\"Mod[#1, 3 & ]\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.771167081859276*^9, 3.771167579380053*^9, 
  3.771167654674621*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"c257a305-911d-44fb-9af6-53bf7b5bd117"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{"\"\<Range[\[Pi] Cos[10.3]], Mod[#1, 3 & ]]\>\"", ",", 
   RowBox[{"\"\<[\>\"", "~~", "\"\<]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771167679853565*^9, 3.771167713915305*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"57888c1f-467d-4b3e-87c7-6fd862ac7cb3"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.771167715535231*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"542b5273-8609-4a8e-9923-fc1433d32efa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<|", 
  RowBox[{
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{"3", ",", "4"}], "}"}]}]}], "|>"}]], "Input",
 CellChangeTimes->{{3.7711990531662188`*^9, 3.7711991116415453`*^9}, {
  3.771199388180505*^9, 3.771199390131276*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"f0d85a29-a0da-4a89-a4a1-75e2e652775e"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.771199079478592*^9, 3.7711991119737453`*^9, 
  3.771199390542224*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"177e475b-6d90-47f9-9209-e06eff84882b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%35", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.7711990829768476`*^9, 3.7711991336177597`*^9}, {
  3.7711993798988447`*^9, 3.7711993929280367`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"4780c846-3c63-453e-8153-88ce1b7a948e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.77119909134791*^9, 3.771199133935104*^9}, {
  3.771199382502088*^9, 3.771199393423225*^9}},
 CellLabel->"Out[36]=",ExpressionUUID->"4f03fd3f-44f1-427e-86a5-9aba68a5aa49"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Before meeting with Tim:", "Section",
 CellChangeTimes->{{3.7711730265681334`*^9, 
  3.771173032995514*^9}},ExpressionUUID->"d4059080-7c17-4e1e-b007-\
5c97ba99a6f1"],

Cell[TextData[{
 "Implement: {",
 StyleBox["head",
  FontWeight->"Bold"],
 ", argcount, id}"
}], "Text",
 CellChangeTimes->{{3.7711828244038677`*^9, 
  3.7711828422235613`*^9}},ExpressionUUID->"5d8ee8cc-22ea-4e9b-adaa-\
71dd2a4c10f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<a[b[],foo[g[Plot[]]]]\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.771169692260757*^9, 3.771169696763339*^9}, {
   3.7711714221172*^9, 3.771171427741297*^9}, 3.771173044157226*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"9ccace7b-7691-4930-b7cc-168a088123ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"str", "=", "\"\<a[b[cc[d[e[foo[t, h[x]]]]]]]\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771181408380303*^9, 3.771181469454734*^9}, {
  3.771182737748152*^9, 3.771182763491644*^9}, {3.771183047658819*^9, 
  3.7711830551029778`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d284fa09-8381-4367-bd08-f19527a570cf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "@", 
  RowBox[{"Hold", "@", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"Cos", "[", "x", "]"}], "]"}], ",", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{"#1", ",", " ", 
       RowBox[{"3", " ", "&"}]}], " ", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771251612335596*^9, 3.771251621939836*^9}, {
  3.771251925572487*^9, 3.771251928734625*^9}, {3.7712528234431057`*^9, 
  3.7712528253055*^9}, {3.771252905104195*^9, 3.771252905641533*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"cce16365-180d-4c10-bc73-6fb065796b7e"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.6902684899626333, 3.6814319464673777`}, {
    0.6902684899626333, 2.7610739598505334`}, {0., 1.8407159732336889`}, {0., 
    0.9203579866168443}, {0., 0.}, {1.3805369799252667`, 
    1.8407159732336889`}, {0.9203579866168444, 0.9203579866168443}, {
    0.9203579866168444, 0.}, {1.8407159732336889`, 0.9203579866168443}, {
    1.8407159732336889`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {2, 3}, {2, 6}, {3, 4}, {4, 5}, {6, 7}, {6, 9}, {7, 
       8}, {9, 10}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Hold", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"Hold", "[", 
           RowBox[{"SortBy", "[", 
             RowBox[{
               RowBox[{"Range", "[", 
                 RowBox[{"Cos", "[", "x", "]"}], "]"}], ",", 
               RowBox[{"Mod", "[", 
                 RowBox[{"#1", ",", 
                   RowBox[{"3", "&"}]}], "]"}]}], "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         Hold[
          SortBy[
           Range[
            Cos[$CellContext`x]], 
           Mod[#, 3& ]]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["SortBy", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"SortBy", "[", 
           RowBox[{
             RowBox[{"Range", "[", 
               RowBox[{"Cos", "[", "x", "]"}], "]"}], ",", 
             RowBox[{"Mod", "[", 
               RowBox[{"#1", ",", 
                 RowBox[{"3", "&"}]}], "]"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         SortBy[
          Range[
           Cos[$CellContext`x]], 
          Mod[#, 3& ]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Range", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"Range", "[", 
           RowBox[{"Cos", "[", "x", "]"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         Range[
          Cos[$CellContext`x]]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Cos", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"Cos", "[", "x", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         Cos[$CellContext`x]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["x",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["x", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`x], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Mod", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"Mod", "[", 
           RowBox[{"#1", ",", 
             RowBox[{"3", "&"}]}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         Mod[#, 3& ]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Slot", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["#1", HoldForm]],
       Annotation[#, 
        HoldForm[#], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["Function", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"3", "&"}], HoldForm]],
       Annotation[#, 
        HoldForm[3& ], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.6902684899626333, 3.6814319464673777`}, {
     0.6902684899626333, 2.7610739598505334`}, {0., 1.8407159732336889`}, {0.,
      0.9203579866168443}, {0., 0.}, {1.3805369799252667`, 
     1.8407159732336889`}, {0.9203579866168444, 0.9203579866168443}, {
     0.9203579866168444, 0.}, {1.8407159732336889`, 0.9203579866168443}, {
     1.8407159732336889`, 0.}}]& ],
  AspectRatio->NCache[Rational[2, 3]^Rational[1, 2], 0.816496580927726],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.771251622444064*^9, 3.771251929287149*^9, 
  3.771252825713822*^9, 3.7712529068516407`*^9},
 CellLabel->
  "Out[34]//TreeForm=",ExpressionUUID->"e8b4d604-cbc1-4ba7-bf04-9295df493089"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"treestructure", "//", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], "]"}]}], "//", "Reverse"}], "//",
   "Dataset"}]], "Input",
 CellChangeTimes->{{3.77125493849575*^9, 3.771254969585369*^9}, {
  3.7712560355183573`*^9, 3.771256036364019*^9}, {3.7712562681408052`*^9, 
  3.771256301229711*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"4774809a-c651-480a-8538-d600c01195ff"],

Cell[BoxData[
 TemplateBox[{TagBox[
    DynamicModuleBox[{
     TypeSystem`NestedGrid`PackagePrivate`$state$$ = 
      Data`UnorderedAssociation[
       "RowCount" -> 4, "Length" -> 4, "InitialType" -> TypeSystem`Assoc[
          TypeSystem`Vector[
           TypeSystem`Atom[Integer], 2], 
          TypeSystem`Tuple[{
            TypeSystem`Atom[String], 
            TypeSystem`Atom[Integer], TypeSystem`AnyType}], 4], "Shape" -> 
        TypeSystem`PackageScope`Limited[
          TypeSystem`PackageScope`ColumnShape[
           TypeSystem`PackageScope`KeyValueShape[
           TypeSystem`PackageScope`UnknownShape, 
            TypeSystem`PackageScope`RowShape[{
              TypeSystem`PackageScope`AtomShape[57.60000000000001], 
              TypeSystem`PackageScope`AtomShape[34], 
              TypeSystem`PackageScope`UnknownShape}]]], 4, {}], "InitialData" -> 
        TypeSystem`PackageScope`CacheHandle[780233066], "Type" -> 
        TypeSystem`Assoc[
          TypeSystem`Vector[
           TypeSystem`Atom[Integer], 2], 
          TypeSystem`Tuple[{
            TypeSystem`Atom[String], 
            TypeSystem`Atom[Integer], TypeSystem`AnyType}], 4], "HandleQ" -> 
        True, "RowTarget" -> 20, "Data" -> 
        TypeSystem`PackageScope`CacheHandle[780233066]], 
      TypeSystem`NestedGrid`PackagePrivate`$path$$ = {}, 
      TypeSystem`NestedGrid`PackagePrivate`$pos$$ = 1, 
      TypeSystem`NestedGrid`PackagePrivate`$grid$$ = 
      DynamicModule[{
        TypeSystem`NestedGrid`PackagePrivate`renderedGrid = Deploy[
           Style[
            Grid[{{
               Item[
                Pane[
                 Item[
                  Annotation[
                   EventHandler[
                    MouseAppearance[
                    Mouseover[
                    Style[{1, 1}, ShowStringCharacters -> False], 
                    Style[
                    Style[{1, 1}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                    TypeSystem`NestedGrid`PackagePrivate`updateState[
                    TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{1, 1}]}]], 
                   TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[
                   1248913669][
                    GeneralUtilities`Slice[
                    Key[{1, 1}]]], "Mouse"]], 
                 ImageSize -> {{60, Full}, Automatic}], Background -> 
                GrayLevel[0.95], Alignment -> {Left, Baseline}], 
               Pane[
                Annotation["SortBy", 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{1, 1}], 1]], "Mouse"], 
                ImageSize -> {{57.60000000000001, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Pane[
                Annotation[
                 RawBoxes["2"], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{1, 1}], 2]], "Mouse"], 
                ImageSize -> {{34, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Pane[
                Annotation[
                 RawBoxes[
                  StyleBox[
                  "Null", FontFamily -> "Source Code Pro", FontSize -> 13, 
                   ShowStringCharacters -> True]], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{1, 1}], 3]], "Mouse"], 
                ImageSize -> {{60, Full}, Automatic}, 
                Alignment -> {Left, Baseline}]}, {
               Item[
                Pane[
                 Item[
                  Annotation[
                   EventHandler[
                    MouseAppearance[
                    Mouseover[
                    Style[{2, 1}, ShowStringCharacters -> False], 
                    Style[
                    Style[{2, 1}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                    TypeSystem`NestedGrid`PackagePrivate`updateState[
                    TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{2, 1}]}]], 
                   TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[
                   1248913669][
                    GeneralUtilities`Slice[
                    Key[{2, 1}]]], "Mouse"]], 
                 ImageSize -> {{60, Full}, Automatic}], Background -> 
                GrayLevel[0.95], Alignment -> {Left, Baseline}], 
               Pane[
                Annotation["Range", 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{2, 1}], 1]], "Mouse"], 
                ImageSize -> {{57.60000000000001, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Pane[
                Annotation[
                 RawBoxes["1"], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{2, 1}], 2]], "Mouse"], 
                ImageSize -> {{34, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Item[
                Annotation[
                 EventHandler[
                  MouseAppearance[
                   Mouseover[
                    Style[{1, 1}, ShowStringCharacters -> False], 
                    Style[
                    Style[{1, 1}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                  TypeSystem`NestedGrid`PackagePrivate`updateState[
                   TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{2, 1}], 3}]], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{2, 1}], 3]], "Mouse"]]}, {
               Item[
                Pane[
                 Item[
                  Annotation[
                   EventHandler[
                    MouseAppearance[
                    Mouseover[
                    Style[{2, 2}, ShowStringCharacters -> False], 
                    Style[
                    Style[{2, 2}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                    TypeSystem`NestedGrid`PackagePrivate`updateState[
                    TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{2, 2}]}]], 
                   TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[
                   1248913669][
                    GeneralUtilities`Slice[
                    Key[{2, 2}]]], "Mouse"]], 
                 ImageSize -> {{60, Full}, Automatic}], Background -> 
                GrayLevel[0.95], Alignment -> {Left, Baseline}], 
               Pane[
                Annotation["Mod", 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{2, 2}], 1]], "Mouse"], 
                ImageSize -> {{57.60000000000001, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Pane[
                Annotation[
                 RawBoxes["2"], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{2, 2}], 2]], "Mouse"], 
                ImageSize -> {{34, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Item[
                Annotation[
                 EventHandler[
                  MouseAppearance[
                   Mouseover[
                    Style[{1, 1}, ShowStringCharacters -> False], 
                    Style[
                    Style[{1, 1}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                  TypeSystem`NestedGrid`PackagePrivate`updateState[
                   TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{2, 2}], 3}]], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{2, 2}], 3]], "Mouse"]]}, {
               Item[
                Pane[
                 Item[
                  Annotation[
                   EventHandler[
                    MouseAppearance[
                    Mouseover[
                    Style[{3, 1}, ShowStringCharacters -> False], 
                    Style[
                    Style[{3, 1}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                    TypeSystem`NestedGrid`PackagePrivate`updateState[
                    TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{3, 1}]}]], 
                   TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[
                   1248913669][
                    GeneralUtilities`Slice[
                    Key[{3, 1}]]], "Mouse"]], 
                 ImageSize -> {{60, Full}, Automatic}], Background -> 
                GrayLevel[0.95], Alignment -> {Left, Baseline}], 
               Pane[
                Annotation["Cos", 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{3, 1}], 1]], "Mouse"], 
                ImageSize -> {{57.60000000000001, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Pane[
                Annotation[
                 RawBoxes["1"], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{3, 1}], 2]], "Mouse"], 
                ImageSize -> {{34, Full}, Automatic}, 
                Alignment -> {Left, Baseline}], 
               Item[
                Annotation[
                 EventHandler[
                  MouseAppearance[
                   Mouseover[
                    Style[{2, 1}, ShowStringCharacters -> False], 
                    Style[
                    Style[{2, 1}, ShowStringCharacters -> False], FontColor -> 
                    RGBColor[
                    0.27450980392156865`, 0.5372549019607843, 
                    0.792156862745098]]], "LinkHand"], {"MouseClicked", 1} :> 
                  TypeSystem`NestedGrid`PackagePrivate`updateState[
                   TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                    TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][{
                    Key[{3, 1}], 3}]], 
                 TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
                  GeneralUtilities`Slice[
                   Key[{3, 1}], 3]], "Mouse"]]}}, BaseStyle -> {ContextMenu -> {
                 MenuItem["Copy position to clipboard", 
                  KernelExecute[
                   TypeSystem`NestedGrid`PackagePrivate`toCurrentPosition[
                   TypeSystem`NestedGrid`PackagePrivate`copyClip]], 
                  MenuEvaluator -> Automatic], 
                 MenuItem["Copy data to clipboard", 
                  KernelExecute[
                   TypeSystem`NestedGrid`PackagePrivate`toCurrentData[
                   TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`copyClip]], 
                  MenuEvaluator -> Automatic], Delimiter, 
                 MenuItem["Paste position in new cell", 
                  KernelExecute[
                   TypeSystem`NestedGrid`PackagePrivate`toCurrentPosition[
                   TypeSystem`NestedGrid`PackagePrivate`cellPaste]], 
                  MenuEvaluator -> Automatic], 
                 MenuItem["Paste data in new cell", 
                  KernelExecute[
                   TypeSystem`NestedGrid`PackagePrivate`toCurrentData[
                   TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                    TypeSystem`NestedGrid`PackagePrivate`cellPaste]], 
                  MenuEvaluator -> Automatic]}, FontFamily -> "Verdana", 
               FontSize -> 12}, Alignment -> Left, RowMinHeight -> 1.5, 
             Dividers -> All, FrameStyle -> GrayLevel[0.85], 
             BaseStyle -> {FontFamily -> "Verdana", FontSize -> 12}], 
            LineBreakWithin -> False, ContextMenu -> {}, NumberMarks -> False,
             ShowAutoStyles -> False]], 
         TypeSystem`NestedGrid`PackagePrivate`initialQ = True, 
         TypeSystem`NestedGrid`PackagePrivate`self = $Failed}, 
        Dynamic[
         TypeSystem`NestedGrid`PackagePrivate`setupViewPath[
         TypeSystem`NestedGrid`PackagePrivate`$path$$, If[
            Not[TypeSystem`NestedGrid`PackagePrivate`initialQ], 
            
            Module[{TypeSystem`NestedGrid`PackagePrivate`tmpGrid$ = $Failed, 
              TypeSystem`NestedGrid`PackagePrivate`tmpData$ = 
              TypeSystem`NestedGrid`PackagePrivate`LookupCacheValue[
                TypeSystem`NestedGrid`PackagePrivate`$state$$["Data"]]}, 
             TypeSystem`NestedGrid`PackagePrivate`tmpGrid$ = 
              If[TypeSystem`NestedGrid`PackagePrivate`tmpData$ === 
                TypeSystem`NestedGrid`PackagePrivate`$NotCached, 
                TypeSystem`NestedGrid`PackagePrivate`renderedGrid, 
                TypeSystem`NestedGrid`PackagePrivate`renderGrid[
                TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                 TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                 TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
                 TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669][
                TypeSystem`NestedGrid`PackagePrivate`tmpData$]]; If[
               Not[
                FailureQ[TypeSystem`NestedGrid`PackagePrivate`tmpGrid$]], 
               TypeSystem`NestedGrid`PackagePrivate`renderedGrid = 
               TypeSystem`NestedGrid`PackagePrivate`tmpGrid$]; Null]]; 
          TypeSystem`NestedGrid`PackagePrivate`initialQ = False; 
          TypeSystem`NestedGrid`PackagePrivate`$pos$$; If[
            FailureQ[TypeSystem`NestedGrid`PackagePrivate`renderedGrid], 
            TypeSystem`SparseGrid[
             TypeSystem`H["(data no longer present)"]], 
            If[GeneralUtilities`$DebugMode, 
             Row[{TypeSystem`NestedGrid`PackagePrivate`renderedGrid, "  ", 
               TypeSystem`NestedGrid`PackagePrivate`formatState[
               TypeSystem`NestedGrid`PackagePrivate`$state$$, 
                TypeSystem`NestedGrid`PackagePrivate`$path$$, 
                TypeSystem`NestedGrid`PackagePrivate`$pos$$]}], 
             TypeSystem`NestedGrid`PackagePrivate`renderedGrid]]], 
         TrackedSymbols :> {TypeSystem`NestedGrid`PackagePrivate`$pos$$}], 
        DynamicModuleValues :> {}], 
      TypeSystem`NestedGrid`PackagePrivate`$posCell$$, 
      TypeSystem`NestedGrid`PackagePrivate`$topBar$$ = Dynamic[
        TypeSystem`NestedGrid`PackagePrivate`alignBar[
        TypeSystem`NestedGrid`PackagePrivate`$state$$][
         TypeSystem`NestedGrid`PackagePrivate`makeFramedBar[
          TypeSystem`PackageScope`Pathbar[
          TypeSystem`NestedGrid`PackagePrivate`$path$$, 
           TypeSystem`NestedGrid`PackagePrivate`updateState[
           TypeSystem`NestedGrid`PackagePrivate`$state$$, 
            TypeSystem`NestedGrid`PackagePrivate`$path$$, 
            TypeSystem`NestedGrid`PackagePrivate`$pos$$, 
            TypeSystem`NestedGrid`PackagePrivate`$grid$$, 1248913669]]]], 
        TrackedSymbols :> {TypeSystem`NestedGrid`PackagePrivate`$path$$}], 
      TypeSystem`NestedGrid`PackagePrivate`$bottomBar$$ = Framed[
        Dynamic[
         Replace[
          MouseAnnotation[Null], {
          TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][Null] -> 
           "", TypeSystem`NestedGrid`PackagePrivate`$SliceMarker[1248913669][
             Pattern[TypeSystem`NestedGrid`PackagePrivate`path, 
              Blank[]]] :> (
            TypeSystem`NestedGrid`PackagePrivate`$lastPath = 
             TypeSystem`NestedGrid`PackagePrivate`path; 
            TypeSystem`NestedGrid`PackagePrivate`makePathTrail[
             TypeSystem`NestedGrid`PackagePrivate`path, 
              TypeSystem`NestedGrid`PackagePrivate`makePathElements]), Null :> 
           Spacer[10], Blank[] :> Spacer[10]}], TrackedSymbols :> {}], 
        FrameStyle -> None, ImageMargins -> 0, FrameMargins -> 0, Alignment -> 
        Top, ImageSize -> {Automatic, 14}]}, 
     DynamicBox[
      ToBoxes[
       Column[
        If[TypeSystem`NestedGrid`PackagePrivate`$path$$ == {}, {
          TypeSystem`NestedGrid`PackagePrivate`displayScrollBar[
          TypeSystem`NestedGrid`PackagePrivate`$grid$$, 
           TypeSystem`NestedGrid`PackagePrivate`$state$$, 
           TypeSystem`NestedGrid`PackagePrivate`$pos$$], 
          TypeSystem`NestedGrid`PackagePrivate`onDesktopShow[
           TypeSystem`NestedGrid`PackagePrivate`alignBar[
           TypeSystem`NestedGrid`PackagePrivate`$state$$][
           TypeSystem`NestedGrid`PackagePrivate`$bottomBar$$]]}, {
         TypeSystem`NestedGrid`PackagePrivate`$topBar$$, 
          TypeSystem`NestedGrid`PackagePrivate`displayScrollBar[
          TypeSystem`NestedGrid`PackagePrivate`$grid$$, 
           TypeSystem`NestedGrid`PackagePrivate`$state$$, 
           TypeSystem`NestedGrid`PackagePrivate`$pos$$], 
          TypeSystem`NestedGrid`PackagePrivate`onDesktopShow[
           TypeSystem`NestedGrid`PackagePrivate`alignBar[
           TypeSystem`NestedGrid`PackagePrivate`$state$$][
           TypeSystem`NestedGrid`PackagePrivate`$bottomBar$$]]}], Spacings -> 
        If[TypeSystem`NestedGrid`PackagePrivate`$path$$ == {}, 
          0, {{}, {0, 0.05, 0}}]], StandardForm], 
      ImageSizeCache -> {250., {55.134033203125, 60.865966796875}}, 
      TrackedSymbols :> {
       TypeSystem`NestedGrid`PackagePrivate`$state$$, 
        TypeSystem`NestedGrid`PackagePrivate`$grid$$}], 
     BaseStyle -> {LineBreakWithin -> False}, Deinitialization :> 
     TypeSystem`NestedGrid`PackagePrivate`deleteState[
      TypeSystem`NestedGrid`PackagePrivate`$state$$], 
     DynamicModuleValues :> {}, Initialization :> 
     Block[{$ContextPath = $ContextPath}, 
       Needs["TypeSystem`"]]], Deploy, DefaultBaseStyle -> "Deploy"]},
  "CopyTag",
  DisplayFunction->(#& ),
  InterpretationFunction->("Dataset[<>]"& )]], "Output",
 CellChangeTimes->{{3.7712549414217653`*^9, 3.771254970478312*^9}, 
   3.7712554411637783`*^9, {3.771255628650353*^9, 3.7712556348167*^9}, 
   3.771255788242968*^9, 3.771255842511776*^9, 3.771256036758375*^9, 
   3.771256204498073*^9, 3.771256261285048*^9, {3.771256296873858*^9, 
   3.7712563016844683`*^9}},
 CellLabel->"Out[41]=",ExpressionUUID->"a2a82676-f2b8-4987-b319-2bd8721f43f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"str", "=", 
  "\"\<SortBy[Range[Cos[x]], Mod[#1, 3 & ]]\>\""}]], "Input",
 CellChangeTimes->{{3.771198507444615*^9, 3.7711985101448708`*^9}, {
  3.771251558106019*^9, 3.7712515710439787`*^9}, {3.7712519060795107`*^9, 
  3.771251910833639*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e29f71e0-f370-4e56-a6db-2a6faf57b47f"],

Cell[BoxData["\<\"SortBy[Range[Cos[x]], Mod[#1, 3 & ]]\"\>"], "Output",
 CellChangeTimes->{
  3.771251575930029*^9, {3.771251913988188*^9, 3.771251934377123*^9}, 
   3.771255286387624*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"00bdae33-f318-4a2d-80b2-70e26c5ddf96"]
}, Open  ]],

Cell["\<\
Idea: The id should contain the current level + a unique id
previous head should be: Function Head: {level, unique id} ->  head, Current \
Number of Arguments, Key of parent Function\
\>", "Text",
 CellChangeTimes->{{3.771252064373698*^9, 3.7712520818063374`*^9}, {
  3.7712527437990227`*^9, 3.771252744963792*^9}, {3.771253584092708*^9, 
  3.7712535864124002`*^9}},ExpressionUUID->"e99e297b-42eb-46d8-82c0-\
654297c77c25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"whatismyid", "[", "currentlevel_", "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"KeySelect", "[", 
     RowBox[{"treestructure", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "currentlevel"}], 
       "&"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.771256074968734*^9, 3.7712561304578342`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"c059a98e-453b-46d6-9627-45ec5769d90e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"level", "=", "0"}], ";", 
  RowBox[{"head", "=", "None"}], ";", 
  RowBox[{"treestructure", "=", 
   RowBox[{"<|", " ", "|>"}]}], ";", 
  RowBox[{"id", "=", "1"}], ";"}], "\n", 
 RowBox[{"Reap", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"StringCases", "[", 
     RowBox[{"str", ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<[\>\"", "\[RuleDelayed]", "\[IndentingNewLine]", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"Print", "[", "treestructure", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"level", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"id", "=", 
             RowBox[{"whatismyid", "[", "level", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"treestructure", "=", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"level", ",", 
                  RowBox[{"id", "+", "1"}]}], "}"}], "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{"head", ",", "1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"level", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Keys", "@", 
                    RowBox[{"KeySelect", "[", 
                    RowBox[{"treestructure", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{"level", "-", "1"}], ")"}]}], "&"}]}], "]"}]}], 
                    ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
               "]"}], "@", "treestructure"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<current level, head is: \>\"", ",", "level", ",", 
              "\"\< \>\"", ",", " ", "head"}], "]"}], ";"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<]\>\"", "\[RuleDelayed]", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"Print", "[", "treestructure", "]"}], ",", 
           RowBox[{
            RowBox[{"level", "--"}], ";", "\[IndentingNewLine]", 
            RowBox[{"id", "=", 
             RowBox[{"whatismyid", "[", "level", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"level", ">", "0"}], ",", 
              RowBox[{"head", "=", 
               RowBox[{
                RowBox[{"treestructure", "[", 
                 RowBox[{"{", 
                  RowBox[{"level", ",", "id"}], "}"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<current level, head is: \>\"", ",", "level", ",", 
              "\"\< \>\"", ",", " ", "head"}], "]"}], ";"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"h", ":", 
          RowBox[{"LetterCharacter", ".."}]}], "\[RuleDelayed]", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"head", "=", "h"}], ",", "\"\<head\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<,\>\"", "\[RuleDelayed]", " ", 
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<A comma was found\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"id", "=", 
            RowBox[{"whatismyid", "[", "level", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"treestructure", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"treestructure", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"level", ",", "id"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"treestructure", "[", 
                   RowBox[{"{", 
                    RowBox[{"level", ",", "id"}], "}"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"treestructure", "[", 
                    RowBox[{"{", 
                    RowBox[{"level", ",", "id"}], "}"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], ",", 
                 RowBox[{
                  RowBox[{"treestructure", "[", 
                   RowBox[{"{", 
                    RowBox[{"level", ",", "id"}], "}"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}]}], 
          "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", "_", 
   ",", "Rule"}], "]"}]}], "Input",
 CellChangeTimes->{{3.771171257374958*^9, 3.771171260691312*^9}, 
   3.771171431226577*^9, {3.7711715036620607`*^9, 3.771171553438817*^9}, {
   3.771173072245167*^9, 3.771173172063362*^9}, 3.771173218252759*^9, {
   3.771173480414163*^9, 3.7711735038562727`*^9}, {3.77117353895129*^9, 
   3.771173564488493*^9}, {3.77117361034271*^9, 3.7711736121304197`*^9}, {
   3.7711736847265244`*^9, 3.771173728005762*^9}, {3.771173758438406*^9, 
   3.771173761867234*^9}, {3.771173798945313*^9, 3.771173832323148*^9}, 
   3.771173875855645*^9, {3.77117398030759*^9, 3.771173989414414*^9}, {
   3.771174148125484*^9, 3.7711741879115667`*^9}, {3.771181952058429*^9, 
   3.771181958893725*^9}, {3.771182020108955*^9, 3.7711820441599703`*^9}, {
   3.771182164025374*^9, 3.7711822144546013`*^9}, {3.771182281982603*^9, 
   3.771182322674808*^9}, 3.771182888962124*^9, {3.771183405809669*^9, 
   3.7711834218509693`*^9}, {3.771183535132687*^9, 3.771183567414194*^9}, {
   3.7711836572585363`*^9, 3.771183658149377*^9}, {3.7711836949319277`*^9, 
   3.7711837659499073`*^9}, {3.771184287019908*^9, 3.771184288252363*^9}, {
   3.7711978997222977`*^9, 3.771197953418858*^9}, {3.771198377766139*^9, 
   3.771198390785144*^9}, {3.771198540312202*^9, 3.771198540490884*^9}, {
   3.7711990029240723`*^9, 3.771199035961555*^9}, {3.7711991548827467`*^9, 
   3.771199170234478*^9}, {3.77119921785782*^9, 3.7711992496036787`*^9}, {
   3.771199470641467*^9, 3.771199476075059*^9}, 3.771203927730213*^9, {
   3.7712047881322603`*^9, 3.771204836835372*^9}, 3.771204953042839*^9, {
   3.771204996633876*^9, 3.771204996979026*^9}, {3.771251678322072*^9, 
   3.77125172376045*^9}, {3.771252136460207*^9, 3.7712522119890747`*^9}, {
   3.7712524651759987`*^9, 3.771252465366617*^9}, {3.771252983472447*^9, 
   3.771252996133984*^9}, {3.771253149713593*^9, 3.771253202745941*^9}, {
   3.7712533837016153`*^9, 3.771253392590658*^9}, {3.771253485105041*^9, 
   3.771253503251729*^9}, 3.771253537987192*^9, {3.771253615975603*^9, 
   3.771253616260743*^9}, {3.771253699956683*^9, 3.7712537394580183`*^9}, {
   3.771253874921876*^9, 3.771253889722479*^9}, {3.7712539342926407`*^9, 
   3.771253948270342*^9}, {3.771254054927466*^9, 3.771254062449109*^9}, {
   3.7712541116958838`*^9, 3.7712541120401773`*^9}, {3.771254262827641*^9, 
   3.771254273262475*^9}, {3.77125459404767*^9, 3.7712546397724237`*^9}, {
   3.771254789176714*^9, 3.7712547901652727`*^9}, {3.771254852142715*^9, 
   3.771254890028451*^9}, {3.771255323718424*^9, 3.771255324672645*^9}, 
   3.771255358290414*^9, {3.771255397392667*^9, 3.771255397598398*^9}, {
   3.771255489669449*^9, 3.77125549704173*^9}, {3.7712555471464243`*^9, 
   3.771255568870143*^9}, {3.771255649051838*^9, 3.7712556492952423`*^9}, {
   3.7712557020721292`*^9, 3.771255740745558*^9}, {3.7712557754113703`*^9, 
   3.7712557777064123`*^9}, {3.771255811188397*^9, 3.771255830395761*^9}, {
   3.771255964469327*^9, 3.771256020347135*^9}, {3.771256170999134*^9, 
   3.771256189310355*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8e57a518-23c2-486d-8e53-99059507083d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197493556*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"abd2ed60-35fb-4f0a-ae52-c676d8d60b3d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "\<\"SortBy\"\>"}],
  SequenceForm["current level, head is: ", 1, " ", "SortBy"],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197495429*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"6eafa22e-26a0-48b4-981d-6c22efccc858"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"\<\"SortBy\"\>", ",", "1", ",", "Null"}], "}"}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.7712561974972477`*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"aac4e1a2-a549-451d-b378-f108905d9de8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "\<\"Range\"\>"}],
  SequenceForm["current level, head is: ", 2, " ", "Range"],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197498287*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"e9b9f99b-ecfa-4ea8-ba84-61a34a7a18d5"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"SortBy\"\>", ",", "1", ",", "Null"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.7712561974993677`*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"8f2c5ca8-1b4e-4ae3-9404-39cff22981d2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "\<\"Cos\"\>"}],
  SequenceForm["current level, head is: ", 3, " ", "Cos"],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.77125619750039*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"2f48738f-fd8c-4955-8f3d-b025e6b50eeb"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"SortBy\"\>", ",", "1", ",", "Null"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197502226*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"0d44787f-812b-428f-ad0b-d132f6995c12"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm["current level, head is: ", 2, " ", {1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197505301*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"ab0e2a08-68ff-46eb-a76c-f61a2341d54b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"SortBy\"\>", ",", "1", ",", "Null"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197508322*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"1fbd05f3-5899-490e-9c6b-a362cfb88d19"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "Null"}],
  SequenceForm["current level, head is: ", 1, " ", Null],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197511464*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"47ec0f29-2350-45f2-a92c-4bf10b85fdc5"],

Cell[BoxData["\<\"A comma was found\"\>"], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197512649*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"ee77817c-ccca-4079-8baa-c8cb9ccd001a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"SortBy\"\>", ",", "2", ",", "Null"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197513762*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"c9e88bd9-92f6-4b66-b78c-fec73fde3e49"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "\<\"Mod\"\>"}],
  SequenceForm["current level, head is: ", 2, " ", "Mod"],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.7712561975148563`*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"5be80bce-c283-4a9a-b644-c09e4a74e881"],

Cell[BoxData["\<\"A comma was found\"\>"], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.77125619751584*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"d84b751e-d2fe-4ea6-bded-d351d450ee4b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"SortBy\"\>", ",", "2", ",", "Null"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Mod\"\>", ",", "2", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197516903*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"3823dd0e-cd30-4767-99bb-13b2dd9f71d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "Null"}],
  SequenceForm["current level, head is: ", 1, " ", Null],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197518029*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"81fb03dd-f51d-4ba5-8a95-11b1eb408287"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"SortBy\"\>", ",", "2", ",", "Null"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Mod\"\>", ",", "2", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197519149*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"2f70ecf5-4de0-4388-a0e7-9d974495f7ba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"current level, head is: \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "Null"}],
  SequenceForm["current level, head is: ", 0, " ", Null],
  Editable->False]], "Print",
 CellChangeTimes->{3.771256027369369*^9, 3.771256197520534*^9},
 CellLabel->
  "During evaluation of \
In[36]:=",ExpressionUUID->"da022b6d-3f22-46e1-9f43-2c0be8d1f5c7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"head\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\<\"SortBy\"\>", ",", "\<\"Range\"\>", ",", "\<\"Cos\"\>", 
        ",", "\<\"x\"\>", ",", "\<\"Mod\"\>"}], "}"}]}], ",", 
     RowBox[{"Null", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", ",", 
        "Null", ",", "Null", ",", "Null"}], "}"}]}], ",", 
     RowBox[{"None", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"Range\"\>", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"SortBy\"\>", ",", "2", ",", "Null"}], "}"}]}]}], 
         "\[RightAssociation]"}], ",", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"Range\"\>", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"Cos\"\>", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"SortBy\"\>", ",", "2", ",", "Null"}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\<\"Mod\"\>", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], 
         "\[RightAssociation]"}]}], "}"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.771256027398366*^9, 3.7712561975219603`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"60ad1249-a1cb-46b8-b9da-9df60c403b73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function pattern matching from Tim", "Section",
 CellChangeTimes->{{3.7712559099826107`*^9, 
  3.771255921258456*^9}},ExpressionUUID->"3467a871-ba50-4bc4-9dda-\
e78fbe287c87"],

Cell[BoxData[
 RowBox[{"SyntaxInformation", "[", "AASTriangle", "]"}]], "Input",
 CellChangeTimes->{{3.771185991759286*^9, 3.771186006436512*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0751970b-f85b-4fa2-9925-7f0380ef60a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.771186147521851*^9, 
  3.771186147527111*^9}},ExpressionUUID->"fe211650-0101-46b7-a12c-\
e75372c5795a"],

Cell[BoxData[
 RowBox[{"symbolsWithInfo", " ", "=", " ", 
  RowBox[{"GroupBy", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Names", "[", "\"\<System`*\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"117", ";;"}], "]"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"Association", "[", 
         RowBox[{"SyntaxInformation", "[", 
          RowBox[{"Symbol", "[", "#", "]"}], "]"}], "]"}], ",", 
        "\"\<ArgumentsPattern\>\""}], "]"}], "=!=", 
      RowBox[{"{", "___", "}"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771185898302149*^9, 3.7711859215090322`*^9}, {
   3.77118596893495*^9, 3.771186150937778*^9}, 3.771186288387813*^9, {
   3.7711863333986177`*^9, 
   3.771186335760889*^9}},ExpressionUUID->"ab2780f4-38ef-48e0-b5c8-\
0e1d1d8c5d0c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{
   RowBox[{"Names", "[", "\"\<System`*\>\"", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"117", ";;"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771186316740006*^9, 3.771186319920629*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"65623a5b-5288-4f1a-92e0-275e33bfa303"],

Cell[BoxData["6490"], "Output",
 CellChangeTimes->{3.771186320630259*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"ad45f1af-f54e-411a-b756-e8e0b69aef28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "symbolsWithInfo"}]], "Input",
 CellChangeTimes->{{3.771186296143437*^9, 3.771186310432232*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"871cd16d-663b-4d73-8cfe-bf14266afd74"],

Cell[BoxData["6350"], "Output",
 CellChangeTimes->{{3.771186297545362*^9, 3.771186311188134*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"1d81e3ce-ebb5-48b8-8839-7ffb438fb98f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"g", "[", 
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7711930373733673`*^9, 
  3.771193052971407*^9}},ExpressionUUID->"d1375d4c-d2cc-4a6d-a050-\
d8d7ea208863"],

Cell[BoxData[
 RowBox[{"symbolsSignatures", " ", "=", " ", 
  RowBox[{"GroupBy", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Names", "[", "\"\<System`*\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"117", ";;"}], "]"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"Lookup", "[", 
      RowBox[{
       RowBox[{"Association", "[", 
        RowBox[{"SyntaxInformation", "[", 
         RowBox[{"Symbol", "[", "#", "]"}], "]"}], "]"}], ",", 
       "\"\<ArgumentsPattern\>\""}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7711863445146627`*^9, 3.771186367357094*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"01574bdf-9009-48bc-b173-8901819c63ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"_", ",", "_.", ",", "_.", ",", "_.", ",", "_."}], "}"}], 
  "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"\"\<CMYKColor\>\"", ",", "\"\<StableDistribution\>\""}], 
   "}"}]}]], "Input",ExpressionUUID->"f1eacd25-3ba4-457f-846b-6d615390cfb5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "CMYKColor"}]], "Input",
 CellChangeTimes->{{3.771186790026709*^9, 3.771186792118042*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c9e64504-a63a-46b2-98f7-bf16f0584a3c"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/CMYKColor",
              ButtonNote->"paclet:ref/CMYKColor"],
             "\"paclet:ref/CMYKColor\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"CMYKColor\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"cyan\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"magenta\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"yellow\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"black\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) is a graphics directive \
specifying that objects that follow are to be displayed, in the color given. \
\\n\\!\\(\\*RowBox[{\\\"CMYKColor\\\", \\\"[\\\", RowBox[{StyleBox[\\\"c\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"m\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\
\\\"y\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"a\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) specifies \
opacity \\!\\(\\*StyleBox[\\\"a\\\", \\\"TI\\\"]\\). \"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   
                   TemplateBox[{
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/CMYKColor", 
                    "paclet:ref/CMYKColor", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"],"\"  \"",StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False],
                    "\"  \"",TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/CMYKColor.\
html"], None}, "http://reference.wolfram.com/language/ref/CMYKColor.html", 
                    "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", 
                    RowBox[{"Protected", ",", "ReadProtected"}], "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`CMYKColor\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{13., {4., 9.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{13., {4., 9.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/CMYKColor",
              ButtonNote->"paclet:ref/CMYKColor"],
             "\"paclet:ref/CMYKColor\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"CMYKColor\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"cyan\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"magenta\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"yellow\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"black\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) is a graphics directive \
specifying that objects that follow are to be displayed, in the color given. \
\\n\\!\\(\\*RowBox[{\\\"CMYKColor\\\", \\\"[\\\", RowBox[{StyleBox[\\\"c\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"m\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\
\\\"y\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"a\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) specifies \
opacity \\!\\(\\*StyleBox[\\\"a\\\", \\\"TI\\\"]\\). \"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {2., 8.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {2., 8.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"CMYKColor\", \"[\", RowBox[{StyleBox[\"cyan\", \"TI\"], \
\",\", StyleBox[\"magenta\", \"TI\"], \",\", StyleBox[\"yellow\", \"TI\"], \
\",\", StyleBox[\"black\", \"TI\"]}], \"]\"}]\) is a graphics directive \
specifying that objects that follow are to be displayed, in the color given. \
\n\!\(\*RowBox[{\"CMYKColor\", \"[\", RowBox[{StyleBox[\"c\", \"TI\"], \",\", \
StyleBox[\"m\", \"TI\"], \",\", StyleBox[\"y\", \"TI\"], \",\", \
StyleBox[\"k\", \"TI\"], \",\", StyleBox[\"a\", \"TI\"]}], \"]\"}]\) \
specifies opacity \!\(\*StyleBox[\"a\", \"TI\"]\). ", "Documentation" -> 
    Association[
     "Local" -> "paclet:ref/CMYKColor", "Web" -> 
      "http://reference.wolfram.com/language/ref/CMYKColor.html"], 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> None, 
    "Attributes" -> {Protected, ReadProtected}, "FullName" -> 
    "System`CMYKColor"], False]]], "Output",
 CellChangeTimes->{3.771186793608472*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"51e11448-d918-4eaf-9b9f-cab3b7c4f00d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"_", ",", 
   RowBox[{"{", "__", "}"}], ",", 
   RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.77118688570092*^9, 
  3.7711868870367317`*^9}},ExpressionUUID->"0ff6110f-6859-4ba7-af55-\
f0d85d96d794"],

Cell[BoxData["\"\<BooleanRegion\>\""], "Input",ExpressionUUID->"79461c7f-66b1-49c0-a45e-81a9bf06ad7c"],

Cell[BoxData[
 RowBox[{"BooleanRegion", "[", 
  RowBox[{"Xor", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "3"}], ",", "0"}], "}"}], ",", "1"}], 
      "]"}], ",", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
    "}"}]}], "]"}]], "Input",ExpressionUUID->"968f8770-8d58-4cab-91e3-\
8b7aee529874"],

Cell[BoxData[
 RowBox[{"...", 
  RowBox[{"Multicolumn", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"BooleanRegion", "[", 
       RowBox[{"op", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", " ", "op"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"Opacity", "[", "0.7", "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"op", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Or", ",", " ", "And", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Not]", "#2"}], "\[And]", "#1"}], "&"}], ",", 
          RowBox[{
           RowBox[{"#1", "\[Xor]", "#2"}], "&"}]}], "}"}]}], "}"}]}], "]"}], 
    ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.771186943425552*^9, 
  3.771186943711566*^9}},ExpressionUUID->"0b850275-a9b9-4bf9-b264-\
4680c4350c96"],

Cell[BoxData[
 RowBox[{"...", 
  RowBox[{"BooleanRegion", "[", 
   RowBox[{"op", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", "op"}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"Opacity", "[", "0.7", "]"}]}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op", ",", " ", 
       RowBox[{"{", 
        RowBox[{"Or", ",", " ", "And", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Not]", "#2"}], "\[And]", "#1"}], "&"}], ",", 
         RowBox[{
          RowBox[{"#1", "\[Xor]", "#2"}], "&"}]}], "}"}]}], "}"}], 
     "..."}]}]}]}]], "Input",
 CellChangeTimes->{{3.7711869410074863`*^9, 
  3.771186955459491*^9}},ExpressionUUID->"6757c251-5940-4744-a771-\
e42999fbfb2f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", " ", "op"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"Opacity", "[", "0.7", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"op", ",", " ", 
       RowBox[{"{", 
        RowBox[{"Or", ",", " ", "And", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Not]", "#2"}], "\[And]", "#1"}], "&"}], ",", 
         RowBox[{
          RowBox[{"#1", "\[Xor]", "#2"}], "&"}]}], "}"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"_", ",", 
     RowBox[{"{", "__", "}"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771186972665545*^9, 3.7711871585853853`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"423334e7-b18a-4ea8-af8b-6853d3e55974"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.771187070415522*^9, 3.7711871606665277`*^9}},
 CellLabel->"Out[29]=",ExpressionUUID->"e4afd556-2a81-4d1e-87c1-dd60cccbcbbf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BooleanRegion", "[", 
   RowBox[{"op", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", 
  RowBox[{"PlotLabel", "\[Rule]", " ", "\[Ellipsis]"}]}]], "Input",
 CellChangeTimes->{
  3.771187117303876*^9, {3.7711871928487186`*^9, 
   3.771187224642448*^9}},ExpressionUUID->"03959c78-3062-4aa4-a7b0-\
b6f15175a0aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BooleanRegion", "[", 
   RowBox[{"op", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", "op"}]}], "]"}], ",", 
  RowBox[{"BaseStyle", "\[Rule]", "\[Ellipsis]"}]}]], "Input",
 CellChangeTimes->{{3.771187133973241*^9, 3.771187142897077*^9}, {
   3.771187193860276*^9, 3.771187225798834*^9}, 
   3.771187260866261*^9},ExpressionUUID->"42702dff-21bb-40ca-ac6f-\
a840fb723063"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BooleanRegion", "[", 
   RowBox[{"op", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", "op"}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"Opacity", "[", "0.7", "]"}]}]}], "]"}], ",", 
  RowBox[{"{", 
   RowBox[{"op", ",", " ", "\[Ellipsis]"}]}]}]], "Input",
 CellChangeTimes->{{3.771187150214829*^9, 3.771187150330628*^9}, {
   3.7711871948817*^9, 3.771187227174161*^9}, 
   3.771187269774136*^9},ExpressionUUID->"1fbd1b4b-097f-4191-8ec3-\
71a1a7a330cf"],

Cell[BoxData[
 RowBox[{"ToString", "[", 
  RowBox[{
   RowBox[{"f", "[", "\"\<the string\>\"", "]"}], ",", "InputForm"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.77118857524473*^9, 3.771188593331785*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"c35b5e0b-4ff6-40b1-9af7-e9845d891c0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "\"\<f\>\"", ",", "\"\<[\>\"", ",", "\"\<\\\"the string\\\"\>\"", ",", 
    "\"\<]\>\""}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.771188599634663*^9, 
  3.771188642941759*^9}},ExpressionUUID->"bfb7efb5-fd43-4229-8aed-\
daee2674588e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7711886315310383`*^9, 
  3.771188636185278*^9}},ExpressionUUID->"ca3ac42e-1ae1-4ee5-a9e6-\
e1a747ff63af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "exp1", ",", "Nothing", ",", "exp13", ",", " ", "exp2", ",", " ", 
   "Nothing"}], "}"}]], "Input",
 CellChangeTimes->{{3.771188814376055*^9, 3.7711888510510683`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"4f9fc3bf-0a09-4288-868b-1d0272034aa9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"exp1", ",", "exp13", ",", "exp2"}], "}"}]], "Output",
 CellChangeTimes->{3.771188853261891*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"6d4559e5-817d-403e-a72c-51d715d1a89f"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{-206, Automatic}, {Automatic, -1042}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 67, "Section",ExpressionUUID->"3191dbce-93fd-4477-884c-0bff78e6c4b9"],
Cell[742, 27, 230, 5, 30, "Input",ExpressionUUID->"470bf7bb-3068-49b4-b635-b9d8a8e24da4"],
Cell[975, 34, 388, 8, 52, "Input",ExpressionUUID->"f4c25372-018e-4a88-9017-7a9edcee4526"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1400, 47, 169, 3, 67, "Section",ExpressionUUID->"7331da9b-b925-4dd3-8495-7eb515484d10"],
Cell[CellGroupData[{
Cell[1594, 54, 158, 3, 54, "Subsection",ExpressionUUID->"408358db-aa51-4816-abf9-7a8cd577489b"],
Cell[1755, 59, 293, 7, 30, "Input",ExpressionUUID->"060d984e-2d88-42ac-a8b3-544f57902d7d"],
Cell[2051, 68, 274, 5, 30, "Input",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2362, 78, 168, 3, 54, "Subsection",ExpressionUUID->"21c511ce-cd28-4abe-8aef-bb58362f5c9d"],
Cell[2533, 83, 230, 5, 30, "Input",ExpressionUUID->"b88e4ffb-ac8e-4f35-854c-b3ef5db68881"],
Cell[2766, 90, 305, 7, 30, "Input",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],
Cell[3074, 99, 465, 11, 30, "Input",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],
Cell[3542, 112, 778, 21, 52, "Input",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"],
Cell[4323, 135, 929, 28, 30, "Input",ExpressionUUID->"09dc6fc4-37ec-484f-9e9c-57a45393165e"],
Cell[5255, 165, 1289, 32, 52, "Input",ExpressionUUID->"1b1a3bda-aee8-4d64-8c54-6620ec47b4c9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6593, 203, 177, 3, 67, "Section",ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-4a5d84b2a192"],
Cell[6773, 208, 225, 4, 30, "Input",ExpressionUUID->"2ebfdf41-6723-4414-a1b3-5460e5dde60b"],
Cell[CellGroupData[{
Cell[7023, 216, 244, 6, 45, "Subsubsection",ExpressionUUID->"acfd93ad-a969-4bde-aea4-49cbbde656e6"],
Cell[7270, 224, 732, 19, 30, "Input",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],
Cell[8005, 245, 731, 20, 30, "Input",ExpressionUUID->"11cb3a39-056b-4148-a563-87f74e3992e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8773, 270, 182, 3, 45, "Subsubsection",ExpressionUUID->"df132a6e-dbce-43bf-b230-48b0ef57369d"],
Cell[8958, 275, 1109, 27, 30, "Input",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10104, 307, 198, 3, 45, "Subsubsection",ExpressionUUID->"d96fc860-14ff-492b-ac46-6f71c934b734"],
Cell[10305, 312, 456, 13, 30, "Input",ExpressionUUID->"5f0b3a75-d452-420e-8a01-3ea25be17c4d"]
}, Open  ]],
Cell[10776, 328, 296, 7, 45, "Subsubsection",ExpressionUUID->"2cd03372-1dd5-4bb8-9c06-690450722bbf"],
Cell[CellGroupData[{
Cell[11097, 339, 238, 4, 37, "Subsubsection",ExpressionUUID->"2e6eee46-e43a-41ce-adb4-5c5b1aa9698e"],
Cell[11338, 345, 386, 8, 30, "Input",ExpressionUUID->"c232d318-9cc0-4505-96ed-93c5e419fcc6"],
Cell[CellGroupData[{
Cell[11749, 357, 250, 5, 30, "Input",ExpressionUUID->"9ce541ae-5b2e-440f-b948-56a44a9a0563"],
Cell[12002, 364, 16144, 443, 322, "Output",ExpressionUUID->"5e2ce31c-c1d9-4df3-93a1-6aef7f2f9ba7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28183, 812, 252, 5, 30, "Input",ExpressionUUID->"d0b6fa73-7bab-4132-8ff3-b53bcf023f7f"],
Cell[28438, 819, 16805, 471, 361, "Output",ExpressionUUID->"615dadbb-0fe2-454e-b9b1-acb8915c8a13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45280, 1295, 367, 8, 30, "Input",ExpressionUUID->"e8b1f735-3ab1-4b3c-a98b-47837effb613"],
Cell[45650, 1305, 1072, 29, 105, "Output",ExpressionUUID->"8e642136-22e1-4b52-b4a9-0ca586509726"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46759, 1339, 792, 17, 30, "Input",ExpressionUUID->"e6ef3c6e-88bd-4cbf-ab67-649ec8f27349"],
Cell[47554, 1358, 493, 9, 34, "Output",ExpressionUUID->"5cbca1b3-3c6a-4dc3-af07-e662dc62bc52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48084, 1372, 454, 12, 30, "Input",ExpressionUUID->"1b4aa7e7-0347-44eb-b30e-429f6326a2d3"],
Cell[48541, 1386, 442, 8, 34, "Output",ExpressionUUID->"d2fc199d-00a6-41ed-93ce-e3f75eb52455"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49020, 1399, 243, 5, 30, "Input",ExpressionUUID->"3cf6ce29-13e4-4c14-a553-f46511eddf71"],
Cell[49266, 1406, 417, 8, 34, "Output",ExpressionUUID->"a6246607-a2bc-489e-a52c-3ae45e974268"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49720, 1419, 241, 5, 30, "Input",ExpressionUUID->"0478d555-4d55-48a5-9e15-a239ca0f803e"],
Cell[49964, 1426, 322, 7, 34, "Output",ExpressionUUID->"f41290b3-9a92-40e9-8473-bb0e8b29bd5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50323, 1438, 231, 6, 30, "Input",ExpressionUUID->"441c3372-c065-40a3-8eeb-c40e8fce9924"],
Cell[50557, 1446, 275, 6, 34, "Output",ExpressionUUID->"387a7a37-e5a4-4314-b6a9-1026126201ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50881, 1458, 235, 4, 45, "Subsubsection",ExpressionUUID->"968142cc-3908-4fc2-a763-1e03ef146791"],
Cell[CellGroupData[{
Cell[51141, 1466, 899, 26, 52, "Input",ExpressionUUID->"8597eac9-656e-4954-91f9-4cb34d53bcfd"],
Cell[52043, 1494, 25320, 700, 377, "Output",ExpressionUUID->"1e84e46c-9437-4379-a9f8-034e12570c5e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77412, 2200, 163, 3, 45, "Subsubsection",ExpressionUUID->"7b792bbc-5629-4e56-a71e-87272bf0be00"],
Cell[77578, 2205, 128, 3, 30, "Input",ExpressionUUID->"535c5026-367d-4057-ae39-23eff2d57ec5"],
Cell[CellGroupData[{
Cell[77731, 2212, 1049, 27, 52, "Input",ExpressionUUID->"65c540b3-3257-4e45-af3e-4105e8f22fc3"],
Cell[78783, 2241, 15563, 426, 386, "Output",ExpressionUUID->"5225a11d-6d32-48f9-b545-0473275fa30b"]
}, Open  ]],
Cell[94361, 2670, 381, 11, 30, "Input",ExpressionUUID->"aa5a3f0a-f5ea-48dc-a21e-a9269c0d4f15"],
Cell[CellGroupData[{
Cell[94767, 2685, 616, 13, 30, "Input",ExpressionUUID->"38674d8e-ed32-4dc9-aa3f-f84be66368d4"],
Cell[95386, 2700, 1614, 43, 105, "Output",ExpressionUUID->"5003cce1-3f80-416c-8bb4-e3ff8a2cd008"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97037, 2748, 152, 3, 30, "Input",ExpressionUUID->"4bb4cad2-75ec-42aa-9747-5691d846299c"],
Cell[97192, 2753, 154, 3, 34, "Output",ExpressionUUID->"8dcc0549-d026-49e5-88c1-50def4436f07"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97407, 2763, 231, 4, 53, "Section",ExpressionUUID->"4dd3a727-e898-4808-8f8c-297eaea0425f"],
Cell[CellGroupData[{
Cell[97663, 2771, 266, 6, 54, "Subsection",ExpressionUUID->"c2779de8-0627-4fc9-995f-cef9cffc169b"],
Cell[CellGroupData[{
Cell[97954, 2781, 162, 3, 45, "Subsubsection",ExpressionUUID->"d118b056-7b7f-4fbf-ba28-3f4cdae9e97b"],
Cell[CellGroupData[{
Cell[98141, 2788, 490, 10, 30, "Input",ExpressionUUID->"87f29f19-325d-42c8-a575-4214547c6cbc"],
Cell[98634, 2800, 670, 9, 34, "Output",ExpressionUUID->"84aae777-4ade-49d5-917c-8ea06b8a1452"]
}, Open  ]],
Cell[99319, 2812, 493, 13, 30, "Input",ExpressionUUID->"1a435330-12fa-4443-9c48-c7be24ed0ae4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99849, 2830, 163, 3, 45, "Subsubsection",ExpressionUUID->"b5603ec9-7a4f-4477-b3f2-ff0903ae96d6"],
Cell[100015, 2835, 589, 14, 30, "Input",ExpressionUUID->"e568f8ba-6930-41b6-8856-cd37aae291b5"],
Cell[100607, 2851, 597, 12, 52, "Input",ExpressionUUID->"7c785745-ca60-4742-aff6-b35f8472c878"],
Cell[101207, 2865, 332, 9, 30, "Input",ExpressionUUID->"cfff4df8-53d7-4d4d-b9ca-702067f7d217"],
Cell[CellGroupData[{
Cell[101564, 2878, 2248, 49, 136, "Input",ExpressionUUID->"b3ee4191-2258-4f3b-88e0-7c2a47c2f1bf"],
Cell[103815, 2929, 1449, 33, 87, "Output",ExpressionUUID->"85ad3507-2dc1-4cb1-8e6c-f52dcb602945"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105313, 2968, 212, 4, 45, "Subsubsection",ExpressionUUID->"28a794ab-5780-4e2d-ba77-8a5a4cec6922"],
Cell[CellGroupData[{
Cell[105550, 2976, 287, 7, 30, "Input",ExpressionUUID->"97705cae-037f-46b0-a781-ef48ed26afaa"],
Cell[105840, 2985, 262, 7, 34, "Output",ExpressionUUID->"4db8f41d-50ae-48c4-bd1a-22bd9782471a"]
}, Open  ]],
Cell[106117, 2995, 294, 6, 30, "Input",ExpressionUUID->"175f330a-ef54-4063-89af-9fe30762b035"],
Cell[CellGroupData[{
Cell[106436, 3005, 1562, 41, 157, "Input",ExpressionUUID->"360b4722-20b6-4f2e-a706-e9d8ae8bf841"],
Cell[CellGroupData[{
Cell[108023, 3050, 407, 10, 24, "Print",ExpressionUUID->"ee3930ba-c51e-4612-8617-d94ffe1a518f"],
Cell[108433, 3062, 405, 10, 24, "Print",ExpressionUUID->"a1f76dad-3c82-4a12-993a-9ec8dac56cb0"],
Cell[108841, 3074, 405, 10, 24, "Print",ExpressionUUID->"9aa8af6f-9391-484e-8a2a-641e809648b6"],
Cell[109249, 3086, 411, 10, 24, "Print",ExpressionUUID->"9f575dcb-08b6-4b57-a79c-48698a77a177"],
Cell[109663, 3098, 405, 10, 24, "Print",ExpressionUUID->"587f590b-e5a5-4f35-adda-fdd45df27649"],
Cell[110071, 3110, 413, 10, 24, "Print",ExpressionUUID->"1260dfe9-06c7-4780-880e-2cd443f67231"],
Cell[110487, 3122, 411, 10, 24, "Print",ExpressionUUID->"87f1e9e7-02f0-420d-bc04-64d296634e5a"],
Cell[110901, 3134, 411, 10, 24, "Print",ExpressionUUID->"27e52ad8-7c7d-405c-b5d0-1de115cbd427"],
Cell[111315, 3146, 411, 10, 24, "Print",ExpressionUUID->"48b16a93-9c14-43a2-a01a-7db8050a4592"],
Cell[111729, 3158, 411, 10, 24, "Print",ExpressionUUID->"c31b5bef-bda1-4236-8bda-16c01d625276"]
}, Open  ]],
Cell[112155, 3171, 796, 18, 34, "Output",ExpressionUUID->"9eae6860-2563-43c8-93f8-fdd642b12888"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112988, 3194, 947, 25, 94, "Input",ExpressionUUID->"90e5d13f-5888-453c-adda-71ac8d7905f5"],
Cell[113938, 3221, 822, 22, 34, "Output",ExpressionUUID->"16b2b297-22d0-425f-a437-1ddec626557a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114797, 3248, 240, 5, 30, "Input",ExpressionUUID->"3b430ac3-ab1d-480e-8737-01862d76e2f3"],
Cell[115040, 3255, 307, 7, 34, "Output",ExpressionUUID->"a29328a9-1def-4187-b7e2-1e9a2110295d"]
}, Open  ]],
Cell[115362, 3265, 315, 8, 30, "Input",ExpressionUUID->"f0f95dc6-6919-4c77-bb53-dcc383db4a43"],
Cell[115680, 3275, 249, 6, 30, "Input",ExpressionUUID->"b2c6e0c3-8315-411a-ad52-b3fc4c9397ae"],
Cell[CellGroupData[{
Cell[115954, 3285, 489, 12, 30, "Input",ExpressionUUID->"b163e36f-9a9b-45f5-b016-bab6139e0569"],
Cell[116446, 3299, 581, 17, 34, "Output",ExpressionUUID->"c21fa757-29a5-4483-8233-6d92fa59d9b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117064, 3321, 487, 10, 30, "Input",ExpressionUUID->"e24f767f-5584-4050-b944-338223b9bbe9"],
Cell[117554, 3333, 1198, 23, 87, "Output",ExpressionUUID->"8355e462-2217-4a50-b079-85c0613acd40"]
}, Open  ]],
Cell[118767, 3359, 283, 7, 30, "Input",ExpressionUUID->"a7f3ea05-4c58-460a-a087-5a1a4debb836"],
Cell[119053, 3368, 152, 3, 30, "Input",ExpressionUUID->"d9a41f1f-147a-45e6-aa7d-6ae80ca9b8a9"],
Cell[CellGroupData[{
Cell[119230, 3375, 450, 11, 30, "Input",ExpressionUUID->"30c7c9cd-0de6-4ec9-a7ea-15fbfe07fd3e"],
Cell[119683, 3388, 583, 11, 34, "Output",ExpressionUUID->"03be197d-d3b3-4071-9110-f78aac324e78"]
}, Open  ]],
Cell[120281, 3402, 303, 7, 30, "Input",ExpressionUUID->"6e5f6ad1-b51d-416b-b30a-6824553b508a"],
Cell[CellGroupData[{
Cell[120609, 3413, 687, 16, 30, "Input",ExpressionUUID->"c4597767-ff94-4cb4-923a-f9c52c704bf4"],
Cell[121299, 3431, 711, 15, 34, "Output",ExpressionUUID->"3db4a1a5-0a53-4129-a080-c1d41cf367a7"]
}, Open  ]],
Cell[122025, 3449, 446, 9, 30, "Input",ExpressionUUID->"7a7d77b3-4809-4792-98e3-cc903f49ce55"],
Cell[CellGroupData[{
Cell[122496, 3462, 748, 21, 30, "Input",ExpressionUUID->"9f0fe650-40e7-4141-a205-1369567be164"],
Cell[123247, 3485, 550, 10, 34, "Output",ExpressionUUID->"2459fb8f-88fb-4ecc-9964-3a9fcf1092f8"]
}, Open  ]],
Cell[123812, 3498, 617, 15, 30, "Input",ExpressionUUID->"9820f749-f25c-4f0c-8ecf-8258562825ac"],
Cell[124432, 3515, 390, 10, 30, "Input",ExpressionUUID->"bb1448aa-2038-44cd-b24a-71d0a8538139"],
Cell[124825, 3527, 232, 5, 30, "Input",ExpressionUUID->"474260f1-13d3-4aeb-aa89-ef640e5c67fc"],
Cell[125060, 3534, 917, 22, 30, "Input",ExpressionUUID->"6306e152-5482-4174-9e2e-2a4c5745c3fa"],
Cell[CellGroupData[{
Cell[126002, 3560, 263, 5, 30, "Input",ExpressionUUID->"7f21b480-dd62-42d2-a0b4-5e87591d03b4"],
Cell[126268, 3567, 581, 10, 34, "Output",ExpressionUUID->"7978084a-dc08-45cf-a4d2-05dd11fb1c44"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[126922, 3585, 211, 4, 67, "Section",ExpressionUUID->"3c59a7bb-b2f7-42e2-87a0-9771dbcf350b"],
Cell[127136, 3591, 171, 4, 30, "Input",ExpressionUUID->"fee77e30-5f43-4642-bae6-3724dd262fd9"],
Cell[127310, 3597, 156, 3, 30, "Input",ExpressionUUID->"990d20ef-0775-407a-bde3-784e59f19201"],
Cell[127469, 3602, 211, 4, 30, "Input",ExpressionUUID->"cca0b45c-f721-40df-ae0b-de548bd9c0c3"],
Cell[127683, 3608, 162, 3, 30, "Input",ExpressionUUID->"4411fd53-3fde-4bf1-b870-ab6ba5c3857b"],
Cell[127848, 3613, 163, 3, 30, "Input",ExpressionUUID->"76fb4f43-bfe2-4284-87be-2488e07cc4a6"],
Cell[128014, 3618, 289, 5, 30, "Input",ExpressionUUID->"dbc633e2-994e-45a6-aee6-30422e65be09"],
Cell[128306, 3625, 230, 5, 30, "Input",ExpressionUUID->"468480c3-209a-4b27-8896-ce7b7d08fd8c"],
Cell[128539, 3632, 125, 2, 30, "Input",ExpressionUUID->"8e0a8c04-a2d5-4146-b8ba-591c948f3d9f"],
Cell[128667, 3636, 170, 4, 30, "Input",ExpressionUUID->"5e3d0c2c-305b-4a1e-87fc-563f16c71cc9"],
Cell[128840, 3642, 129, 3, 30, "Input",ExpressionUUID->"d4a95e60-b826-4494-95e1-d8f5f4910fca"],
Cell[128972, 3647, 240, 6, 30, "Input",ExpressionUUID->"495b526e-95cf-4fb4-987d-e37d4ea29c27"],
Cell[129215, 3655, 259, 7, 30, "Input",ExpressionUUID->"68772852-22d9-42f1-81e3-cb568dd8590d"],
Cell[129477, 3664, 242, 6, 30, "Input",ExpressionUUID->"ebefafd5-f55b-4c5f-ac1f-7dfd04cd9277"],
Cell[CellGroupData[{
Cell[129744, 3674, 179, 2, 30, "Input",ExpressionUUID->"e2009d35-55cd-41f6-b57a-46a678cc3ca4"],
Cell[129926, 3678, 234, 3, 34, "Output",ExpressionUUID->"f6a69672-66d0-47c9-ab71-0fabde211c2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130197, 3686, 1649, 38, 115, "Input",ExpressionUUID->"247b99d8-61e1-460b-82ec-4ad7cf463038"],
Cell[131849, 3726, 465, 14, 51, "Output",ExpressionUUID->"f4d43186-7de9-48a2-aac2-d87b1e2efbbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132351, 3745, 341, 7, 30, "Input",ExpressionUUID->"29ab3dce-1757-4cad-bc2b-2da7b139b9d1"],
Cell[132695, 3754, 535, 12, 51, "Output",ExpressionUUID->"daad1c49-7810-4f44-a902-502ac4af10fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133267, 3771, 284, 6, 30, "Input",ExpressionUUID->"95a6c3ff-f953-40d6-9ecb-df23fec00915"],
Cell[133554, 3779, 222, 5, 34, "Output",ExpressionUUID->"3dc53af5-2ada-4ed2-838e-24d4d53975b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133813, 3789, 410, 9, 30, "Input",ExpressionUUID->"0224d550-389e-45d3-b5ce-67a7af36ee98"],
Cell[134226, 3800, 275, 6, 34, "Output",ExpressionUUID->"089f70be-9efd-4f3a-bb11-13d2e2ff8f8c"]
}, Open  ]],
Cell[134516, 3809, 560, 15, 30, "Input",ExpressionUUID->"ee521011-b23d-4542-9c91-5df942dfc383"],
Cell[135079, 3826, 156, 3, 30, "Input",ExpressionUUID->"e8612c1f-e850-43c8-97e7-67953ade0c4e"],
Cell[135238, 3831, 281, 6, 30, "Input",ExpressionUUID->"655cf7da-309c-4bab-b332-ff2e9f2d808d"],
Cell[CellGroupData[{
Cell[135544, 3841, 360, 6, 30, "Input",ExpressionUUID->"4ddc55c0-f0ef-4599-98c5-1e18af3b8d35"],
Cell[135907, 3849, 688, 18, 51, "Output",ExpressionUUID->"e82161be-9c9d-49bf-a784-0eeafed610d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136632, 3872, 271, 6, 30, "Input",ExpressionUUID->"b91d90fa-0a40-4a17-bd28-97b1b8b63ff6"],
Cell[136906, 3880, 994, 23, 267, "Output",ExpressionUUID->"c257a305-911d-44fb-9af6-53bf7b5bd117"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137937, 3908, 318, 5, 30, "Input",ExpressionUUID->"57888c1f-467d-4b3e-87c7-6fd862ac7cb3"],
Cell[138258, 3915, 166, 3, 34, "Output",ExpressionUUID->"542b5273-8609-4a8e-9923-fc1433d32efa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138461, 3923, 439, 11, 30, "Input",ExpressionUUID->"f0d85a29-a0da-4a89-a4a1-75e2e652775e"],
Cell[138903, 3936, 440, 11, 34, "Output",ExpressionUUID->"177e475b-6d90-47f9-9209-e06eff84882b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139380, 3952, 258, 4, 30, "Input",ExpressionUUID->"4780c846-3c63-453e-8153-88ce1b7a948e"],
Cell[139641, 3958, 266, 5, 34, "Output",ExpressionUUID->"4f03fd3f-44f1-427e-86a5-9aba68a5aa49"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139956, 3969, 171, 3, 67, "Section",ExpressionUUID->"d4059080-7c17-4e1e-b007-5c97ba99a6f1"],
Cell[140130, 3974, 234, 8, 35, "Text",ExpressionUUID->"5d8ee8cc-22ea-4e9b-adaa-71dd2a4c10f0"],
Cell[140367, 3984, 311, 5, 30, "Input",ExpressionUUID->"9ccace7b-7691-4930-b7cc-168a088123ef"],
Cell[140681, 3991, 351, 7, 30, "Input",ExpressionUUID->"d284fa09-8381-4367-bd08-f19527a570cf"],
Cell[CellGroupData[{
Cell[141057, 4002, 603, 13, 30, "Input",ExpressionUUID->"cce16365-180d-4c10-bc73-6fb065796b7e"],
Cell[141663, 4017, 8493, 237, 313, "Output",ExpressionUUID->"e8b4d604-cbc1-4ba7-bf04-9295df493089"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150193, 4259, 488, 12, 30, "Input",ExpressionUUID->"4774809a-c651-480a-8538-d600c01195ff"],
Cell[150684, 4273, 21105, 402, 135, "Output",ExpressionUUID->"a2a82676-f2b8-4987-b319-2bd8721f43f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171826, 4680, 345, 6, 30, "Input",ExpressionUUID->"e29f71e0-f370-4e56-a6db-2a6faf57b47f"],
Cell[172174, 4688, 266, 4, 34, "Output",ExpressionUUID->"00bdae33-f318-4a2d-80b2-70e26c5ddf96"]
}, Open  ]],
Cell[172455, 4695, 433, 8, 58, "Text",ExpressionUUID->"e99e297b-42eb-46d8-82c0-654297c77c25"],
Cell[172891, 4705, 510, 13, 30, "Input",ExpressionUUID->"c059a98e-453b-46d6-9627-45ec5769d90e"],
Cell[CellGroupData[{
Cell[173426, 4722, 8048, 161, 346, "Input",ExpressionUUID->"8e57a518-23c2-486d-8e53-99059507083d"],
Cell[CellGroupData[{
Cell[181499, 4887, 248, 5, 24, "Print",ExpressionUUID->"abd2ed60-35fb-4f0a-ae52-c676d8d60b3d"],
Cell[181750, 4894, 445, 9, 24, "Print",ExpressionUUID->"6eafa22e-26a0-48b4-981d-6c22efccc858"],
Cell[182198, 4905, 411, 11, 26, "Print",ExpressionUUID->"aac4e1a2-a549-451d-b378-f108905d9de8"],
Cell[182612, 4918, 443, 9, 24, "Print",ExpressionUUID->"e9b9f99b-ecfa-4ea8-ba84-61a34a7a18d5"],
Cell[183058, 4929, 648, 19, 26, "Print",ExpressionUUID->"8f2c5ca8-1b4e-4ae3-9404-39cff22981d2"],
Cell[183709, 4950, 438, 9, 24, "Print",ExpressionUUID->"2f48738f-fd8c-4955-8f3d-b025e6b50eeb"],
Cell[184150, 4961, 863, 26, 26, "Print",ExpressionUUID->"0d44787f-812b-428f-ad0b-d132f6995c12"],
Cell[185016, 4989, 479, 11, 24, "Print",ExpressionUUID->"ab0e2a08-68ff-46eb-a76c-f61a2341d54b"],
Cell[185498, 5002, 863, 26, 26, "Print",ExpressionUUID->"1fbd05f3-5899-490e-9c6b-a362cfb88d19"],
Cell[186364, 5030, 431, 9, 24, "Print",ExpressionUUID->"47ec0f29-2350-45f2-a92c-4bf10b85fdc5"],
Cell[186798, 5041, 220, 4, 24, "Print",ExpressionUUID->"ee77817c-ccca-4079-8baa-c8cb9ccd001a"],
Cell[187021, 5047, 863, 26, 26, "Print",ExpressionUUID->"c9e88bd9-92f6-4b66-b78c-fec73fde3e49"],
Cell[187887, 5075, 441, 9, 24, "Print",ExpressionUUID->"5be80bce-c283-4a9a-b644-c09e4a74e881"],
Cell[188331, 5086, 219, 4, 24, "Print",ExpressionUUID->"d84b751e-d2fe-4ea6-bded-d351d450ee4b"],
Cell[188553, 5092, 1080, 33, 26, "Print",ExpressionUUID->"3823dd0e-cd30-4767-99bb-13b2dd9f71d6"],
Cell[189636, 5127, 431, 9, 24, "Print",ExpressionUUID->"81fb03dd-f51d-4ba5-8a95-11b1eb408287"],
Cell[190070, 5138, 1080, 33, 26, "Print",ExpressionUUID->"2f70ecf5-4de0-4388-a0e7-9d974495f7ba"],
Cell[191153, 5173, 431, 9, 24, "Print",ExpressionUUID->"da022b6d-3f22-46e1-9f43-2c0be8d1f5c7"]
}, Open  ]],
Cell[191599, 5185, 2659, 69, 83, "Output",ExpressionUUID->"60ad1249-a1cb-46b8-b9da-9df60c403b73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194307, 5260, 181, 3, 67, "Section",ExpressionUUID->"3467a871-ba50-4bc4-9dda-e78fbe287c87"],
Cell[194491, 5265, 224, 3, 30, "Input",ExpressionUUID->"0751970b-f85b-4fa2-9925-7f0380ef60a6"],
Cell[194718, 5270, 307, 8, 30, "Input",ExpressionUUID->"fe211650-0101-46b7-a12c-e75372c5795a"],
Cell[195028, 5280, 829, 21, 30, "Input",ExpressionUUID->"ab2780f4-38ef-48e0-b5c8-0e1d1d8c5d0c"],
Cell[CellGroupData[{
Cell[195882, 5305, 322, 7, 30, "Input",ExpressionUUID->"65623a5b-5288-4f1a-92e0-275e33bfa303"],
Cell[196207, 5314, 152, 2, 34, "Output",ExpressionUUID->"ad45f1af-f54e-411a-b756-e8e0b69aef28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196396, 5321, 213, 3, 30, "Input",ExpressionUUID->"871cd16d-663b-4d73-8cfe-bf14266afd74"],
Cell[196612, 5326, 176, 2, 34, "Output",ExpressionUUID->"1d81e3ce-ebb5-48b8-8839-7ffb438fb98f"]
}, Open  ]],
Cell[196803, 5331, 295, 8, 30, "Input",ExpressionUUID->"d1375d4c-d2cc-4a6d-a050-d8d7ea208863"],
Cell[197101, 5341, 663, 16, 30, "Input",ExpressionUUID->"01574bdf-9009-48bc-b173-8901819c63ca"],
Cell[197767, 5359, 286, 7, 30, "Input",ExpressionUUID->"f1eacd25-3ba4-457f-846b-6d615390cfb5"],
Cell[CellGroupData[{
Cell[198078, 5370, 197, 3, 30, "Input",ExpressionUUID->"c9e64504-a63a-46b2-98f7-bf16f0584a3c"],
Cell[198278, 5375, 13664, 314, 119, "Output",ExpressionUUID->"51e11448-d918-4eaf-9b9f-cab3b7c4f00d"]
}, Open  ]],
Cell[211957, 5692, 271, 7, 30, "Input",ExpressionUUID->"0ff6110f-6859-4ba7-af55-f0d85d96d794"],
Cell[212231, 5701, 102, 0, 30, "Input",ExpressionUUID->"79461c7f-66b1-49c0-a45e-81a9bf06ad7c"],
Cell[212336, 5703, 531, 18, 30, "Input",ExpressionUUID->"968f8770-8d58-4cab-91e3-8b7aee529874"],
Cell[212870, 5723, 897, 25, 30, "Input",ExpressionUUID->"0b850275-a9b9-4bf9-b264-4680c4350c96"],
Cell[213770, 5750, 768, 22, 30, "Input",ExpressionUUID->"6757c251-5940-4744-a771-e42999fbfb2f"],
Cell[CellGroupData[{
Cell[214563, 5776, 943, 25, 52, "Input",ExpressionUUID->"423334e7-b18a-4ea8-af8b-6853d3e55974"],
Cell[215509, 5803, 179, 2, 34, "Output",ExpressionUUID->"e4afd556-2a81-4d1e-87c1-dd60cccbcbbf"]
}, Open  ]],
Cell[215703, 5808, 371, 10, 30, "Input",ExpressionUUID->"03959c78-3062-4aa4-a7b0-b6f15175a0aa"],
Cell[216077, 5820, 466, 11, 30, "Input",ExpressionUUID->"42702dff-21bb-40ca-ac6f-a840fb723063"],
Cell[216546, 5833, 563, 14, 30, "Input",ExpressionUUID->"1fbd1b4b-097f-4191-8ec3-71a1a7a330cf"],
Cell[217112, 5849, 285, 6, 30, "Input",ExpressionUUID->"c35b5e0b-4ff6-40b1-9af7-e9845d891c0d"],
Cell[217400, 5857, 295, 8, 30, "Input",ExpressionUUID->"bfb7efb5-fd43-4229-8aed-daee2674588e"],
Cell[217698, 5867, 154, 3, 30, "Input",ExpressionUUID->"ca3ac42e-1ae1-4ee5-a9e6-e1a747ff63af"],
Cell[CellGroupData[{
Cell[217877, 5874, 288, 6, 30, "Input",ExpressionUUID->"4f9fc3bf-0a09-4288-868b-1d0272034aa9"],
Cell[218168, 5882, 214, 4, 34, "Output",ExpressionUUID->"6d4559e5-817d-403e-a72c-51d715d1a89f"]
}, Open  ]]
}, Open  ]]
}
]
*)

