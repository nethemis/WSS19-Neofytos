(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    277226,       7703]
NotebookOptionsPosition[    267896,       7537]
NotebookOutlinePosition[    268233,       7552]
CellTagsIndexPosition[    268190,       7549]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["From Riccardo:", "Section",
 CellChangeTimes->{{3.771104820444283*^9, 
  3.771104824806036*^9}},ExpressionUUID->"3191dbce-93fd-4477-884c-\
0bff78e6c4b9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Probs", " ", "not", " ", "needed"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771104829219104*^9, 
  3.77110483886907*^9}},ExpressionUUID->"470bf7bb-3068-49b4-b635-\
b9d8a8e24da4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"argumentLength", "[", "func_Symbol", "]"}], " ", ":=", " ", 
  RowBox[{"Lookup", "[", 
   RowBox[{
    RowBox[{"SyntaxInformation", "[", "func", "]"}], ",", " ", 
    "\"\<ArgumentsPattern\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"argumentLength", "[", "\"\<Plot\>\"", "]"}]}], "Input",ExpressionUUI\
D->"f4c25372-018e-4a88-9017-7a9edcee4526"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio and Tim:", "Section",
 CellChangeTimes->{{3.7708127104307947`*^9, 
  3.7708127225333347`*^9}},ExpressionUUID->"7331da9b-b925-4dd3-8495-\
7eb515484d10"],

Cell[CellGroupData[{

Cell["General:", "Subsection",
 CellChangeTimes->{{3.7709144432629547`*^9, 
  3.770914445573207*^9}},ExpressionUUID->"408358db-aa51-4816-abf9-\
7a8cd577489b"],

Cell[BoxData[
 RowBox[{"WolframLanguageData", "[", 
  RowBox[{"\"\<Exp\>\"", ",", "\"\<DocumentationExampleInputs\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.770813433517725*^9, {3.770984328640039*^9, 
   3.770984332011497*^9}},ExpressionUUID->"060d984e-2d88-42ac-a8b3-\
544f57902d7d"],

Cell[BoxData[
 RowBox[{"SyntaxInformation", "[", "Exp", "]"}]], "Input",
 CellChangeTimes->{{3.7708134385892553`*^9, 3.7708134589607162`*^9}, {
  3.770984336204373*^9, 3.770984336709324*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defined functions:", "Subsection",
 CellChangeTimes->{{3.7709144516420717`*^9, 
  3.770914456220595*^9}},ExpressionUUID->"21c511ce-cd28-4abe-8aef-\
bb58362f5c9d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"No", " ", "longer", " ", "useful"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.77109373184024*^9, 
  3.771093737195661*^9}},ExpressionUUID->"b88e4ffb-ac8e-4f35-854c-\
b3ef5db68881"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseString", "[", "str_String", "]"}], ":=", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flattenParse", "[", "exp_", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{"exp", ",", " ", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "anything___", "}"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"{", "anything", "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.770983991852192*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"makeExpressionString", ",", " ", 
   RowBox[{"{", "HoldFirst", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeExpressionString", "[", "exp_", "]"}], ":=", 
  RowBox[{"StringTake", "[", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"HoldComplete", "[", "exp", "]"}], ",", " ", "InputForm"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"StringLength", "[", "\"\<HoldComplete[\>\"", "]"}], "+", 
       "1"}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"StringLength", "[", "\"\<]\>\"", "]"}]}], "-", "1"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Giulio regarding parsing:", "Section",
 CellChangeTimes->{{3.7710091399881973`*^9, 
  3.771009166068852*^9}},ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-\
4a5d84b2a192"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.771087583422986*^9, 3.771087608428813*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"2ebfdf41-6723-4414-a1b3-5460e5dde60b"],

Cell[CellGroupData[{

Cell["\<\
Convert the expression to a tree structure, regardless of whether it parses \
or not:\
\>", "Subsubsection",
 CellChangeTimes->{{3.771086292682269*^9, 
  3.771086315040605*^9}},ExpressionUUID->"acfd93ad-a969-4bde-aea4-\
49cbbde656e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseInput", "[", "str_String", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"FrontEnd`ReparseBoxStructurePacket", "[", "str", "]"}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"RowBox", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ",", 
     RowBox[{"\"\< \>\"", "\[RuleDelayed]", " ", "Nothing"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.771071449483674*^9, 3.771071477236809*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"takepart", "[", 
    RowBox[{"expr_String", ",", "level_Integer"}], "]"}], ":=", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"level", "[", 
      RowBox[{
       RowBox[{"parseInput", "[", "expr", "]"}], ",", 
       RowBox[{"{", "level", "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"x_", "/;", 
       RowBox[{"!", 
        RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
      RowBox[{"Head", "[", "x", "]"}]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.771016789391432*^9, 3.771016790676392*^9}, {
  3.77108653742286*^9, 
  3.771086543335803*^9}},ExpressionUUID->"11cb3a39-056b-4148-a563-\
87f74e3992e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get slices of the expression:", "Subsubsection",
 CellChangeTimes->{{3.771086347523155*^9, 
  3.7710863943006983`*^9}},ExpressionUUID->"df132a6e-dbce-43bf-b230-\
48b0ef57369d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getlevel", "[", 
   RowBox[{"expr_String", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"el", "=", "n"}], "}"}], ",", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"Level", "[", 
       RowBox[{
        RowBox[{"parseInput", "[", "expr", "]"}], ",", 
        RowBox[{"{", "el", "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x_", "/;", 
        RowBox[{"!", 
         RowBox[{"AtomQ", "[", "x", "]"}]}]}], "\[RuleDelayed]", 
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", "x", "]"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7710191701613207`*^9, 3.7710191876987677`*^9}, {
   3.771019223056572*^9, 3.771019223738312*^9}, {3.771071641072381*^9, 
   3.7710716558175173`*^9}, {3.7710718970095787`*^9, 3.771071950565898*^9}, {
   3.771078660019331*^9, 3.771078672625184*^9}, 3.7710843833422956`*^9, {
   3.77108447740523*^9, 3.771084502982625*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get all the tree structure of the expression:", "Subsubsection",
 CellChangeTimes->{{3.7710863987455397`*^9, 
  3.771086409331916*^9}},ExpressionUUID->"d96fc860-14ff-492b-ac46-\
6f71c934b734"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getalllevels", "[", "expr_String", "]"}], ":=", 
   RowBox[{"Thread", "[", 
    RowBox[{"getlevel", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Depth", "[", 
         RowBox[{"parseInput", "[", "expr", "]"}], "]"}], "-", "1"}], "]"}]}],
      "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[194]:=",ExpressionUUID->"5f0b3a75-d452-420e-8a01-3ea25be17c4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
functionargs returns the minimum and maximum number of arguments a function \
can have\
\>", "Subsubsection",
 CellChangeTimes->{{3.771090274532531*^9, 3.771090344599094*^9}, {
  3.7710936031165037`*^9, 
  3.771093619532844*^9}},ExpressionUUID->"2cd03372-1dd5-4bb8-9c06-\
690450722bbf"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"functionargs", "[", "function_", "]"}], ":=", 
    RowBox[{"Length", "/@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SyntaxInformation", "[", "function", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Equal]", "_"}], "&"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "_."}], "&"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", 
           RowBox[{"OptionsPattern", "[", "]"}]}], "&"}]}], "}"}]}], 
      "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.77109352501967*^9, 
  3.771093527762093*^9}},ExpressionUUID->"09dc6fc4-37ec-484f-9e9c-\
57a45393165e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"functionargs", "[", "function_String", "]"}], " ", ":=", " ", 
  RowBox[{"functionargs", "[", 
   RowBox[{"Symbol", "[", "function", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functionargs", "[", "function_Symbol", "]"}], ":=", 
   RowBox[{"Length", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{
           RowBox[{"SyntaxInformation", "[", "function", "]"}], ",", " ", 
           "\"\<ArgumentsPattern\>\""}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Equal]", "_"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Equal]", "_"}], "||", 
          RowBox[{"#", "\[Equal]", "_."}], "||", 
          RowBox[{"#", "\[Equal]", 
           RowBox[{"OptionsPattern", "[", "]"}]}]}], "&"}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7710935414221153`*^9, 3.7710935836359673`*^9}, {
   3.771104786503063*^9, 3.771104802202396*^9}, 3.7711048842107563`*^9, {
   3.7711049425064573`*^9, 3.771104947878119*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"1b1a3bda-aee8-4d64-8c54-6620ec47b4c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Playing with uneven number of brackets:", "Subsubsection",
 CellChangeTimes->{{3.771087712227626*^9, 3.77108771634932*^9}, {
  3.771093679078897*^9, 
  3.771093686992795*^9}},ExpressionUUID->"2e6eee46-e43a-41ce-adb4-\
5c5b1aa9698e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mystring", "=", "\"\<SortBy[Range[10], Mod[#,3&]\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.771087740382039*^9, {3.7710880906425123`*^9, 3.7710880908509483`*^9}, {
   3.771088156455411*^9, 3.771088199688445*^9}, {3.771108696209776*^9, 
   3.7711087071307993`*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"c232d318-9cc0-4505-96ed-93c5e419fcc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"parseInput", "[", "mystring", "]"}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.771108710379532*^9, 3.771108711336488*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"9ce541ae-5b2e-440f-b948-56a44a9a0563"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eRMsOn2fb/sITSXw/uq1DZ2ng/2rxbfiY1PZXWA
ycP4OfyKRZt3MDnA+DD1H8A0gwMDFEDkv0L1PbWH8V+iiH+1fw/VB+PD7IOZ
l5DIr5iczevwAUUdK5p6LgdU8wQw5N9A3QGTh/Eh/hGC8/VcnWtikwTh/lh9
8186J78InA9TDzMfAHfzkC0=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {4, 5}, {4, 10}, {4, 11}, {5, 6}, {5, 
       7}, {5, 8}, {5, 9}, {11, 12}, {11, 13}, {11, 14}, {11, 20}, {14, 15}, {
       14, 16}, {14, 17}, {17, 18}, {17, 19}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], ",", 
                    "\"]\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, ",", {
           "Mod", "[", {"#", ",", {"3", "&"}}, "]"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], ",", 
                 "\"]\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, ",", {
          "Mod", "[", {"#", ",", {"3", "&"}}, "]"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", {"3", "&"}}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"3\"", ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", {"3", "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"3\"", ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"3", "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.044444444444444446`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eRMsOn2fb/sITSXw/uq1DZ2ng/2rxbfiY1PZXWA
ycP4OfyKRZt3MDnA+DD1H8A0gwMDFEDkv0L1PbWH8V+iiH+1fw/VB+PD7IOZ
l5DIr5iczevwAUUdK5p6LgdU8wQw5N9A3QGTh/Eh/hGC8/VcnWtikwTh/lh9
8186J78InA9TDzMfAHfzkC0=
     "]]& ],
  AspectRatio->NCache[Rational[2, 3]^Rational[1, 2], 0.816496580927726],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.771108711683021*^9},
 CellLabel->
  "Out[257]//TreeForm=",ExpressionUUID->"5e2ce31c-c1d9-4df3-93a1-\
6aef7f2f9ba7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"parseInput", "[", "mystring", "]"}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.771087632785275*^9, 3.7710876393432903`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"d0b6fa73-7bab-4132-8ff3-b53bcf023f7f"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {5, 7}, {5, 8}, {5, 9}, {11, 12}, {11, 20}, {12, 13}, {12, 14}, {
       12, 15}, {12, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
     "]]& ],
  AspectRatio->NCache[Rational[6, 7]^Rational[1, 2], 0.9258200997725514],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7710876396718693`*^9, 3.771087720098084*^9, 3.771087759100359*^9, 
   3.771088093877491*^9, {3.771088158336491*^9, 3.771088201716598*^9}, 
   3.771088245090414*^9, 3.771093906811249*^9, 3.771105068959261*^9, {
   3.77110869768817*^9, 3.771108704293124*^9}},
 CellLabel->
  "Out[255]//TreeForm=",ExpressionUUID->"615dadbb-0fe2-454e-b9b1-\
acb8915c8a13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"alllevels", "=", " ", 
   RowBox[{"getalllevels", "[", "mystring", "]"}]}], ";", 
  RowBox[{"alllevels", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.771086555540482*^9, 3.771086575131207*^9}, {
  3.771087571382249*^9, 3.771087576090201*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"e8b1f735-3ab1-4b3c-a98b-47837effb613"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"SortBy\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"List\"\>", ",", "\<\",\"\>", ",", "\<\"List\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
       ",", "\<\"]\"\>", ",", "\<\"List\"\>", ",", "\<\"&\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", "\<\"List\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.7710876214972973`*^9, 3.7710878106160707`*^9, 
  3.7710881030688677`*^9, 3.771088248316053*^9, 3.77110507129478*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"8e642136-22e1-4b52-b4a9-0ca586509726"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listA", "=", 
  RowBox[{"Total", "/@", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{"#", ",", "\"\<[\>\""}], "]"}], "&"}], ",", "alllevels", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.771084253540374*^9, {3.771084359499206*^9, 3.771084388182954*^9}, {
   3.771084513249896*^9, 3.771084524736081*^9}, {3.771084583453003*^9, 
   3.771084584460314*^9}, {3.771084618916945*^9, 3.771084733640876*^9}, 
   3.771084764135775*^9, {3.771084797168809*^9, 3.7710847985364*^9}, 
   3.771085011387048*^9, {3.771085055301738*^9, 3.77108507242555*^9}, {
   3.77108550051519*^9, 3.7710855214225817`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"e6ef3c6e-88bd-4cbf-ab67-649ec8f27349"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.771085073344433*^9, {3.771085504252873*^9, 3.771085521982852*^9}, 
   3.771086022073792*^9, {3.771086547979677*^9, 3.7710865774039583`*^9}, 
   3.771086873433241*^9, 3.771087685137474*^9, 3.771087818844447*^9, 
   3.7710881055926857`*^9, 3.771088249742777*^9, 3.771105073319778*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"5cbca1b3-3c6a-4dc3-af07-e662dc62bc52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listB", "=", 
  RowBox[{"Total", "/@", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringCount", "[", 
       RowBox[{"#", ",", "\"\<]\>\""}], "]"}], "&"}], ",", "alllevels", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.771085064700062*^9, 3.77108507484408*^9}, 
   3.771085527933729*^9},
 CellLabel->
  "In[208]:=",ExpressionUUID->"1b4aa7e7-0347-44eb-b30e-429f6326a2d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7710850753620167`*^9, 3.7710855285555468`*^9, 
  3.7710860242590113`*^9, 3.7710865826723433`*^9, 3.771086874823698*^9, 
  3.771087687450665*^9, 3.771087820526587*^9, 3.77108810932312*^9, 
  3.771088250809189*^9, 3.771105075306201*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"d2fc199d-00a6-41ed-93ce-e3f75eb52455"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Positive", "[", 
  RowBox[{"listA", "-", "listB"}], "]"}]], "Input",
 CellChangeTimes->{{3.771086997493496*^9, 3.7710870268555737`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"3cf6ce29-13e4-4c14-a553-f46511eddf71"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.771087008828951*^9, 3.771087027524345*^9}, 
   3.771087070434478*^9, 3.7710876893130627`*^9, 3.771087825250001*^9, 
   3.771088113609326*^9, 3.771088252152701*^9, 3.771105076884367*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"a6246607-a2bc-489e-a52c-3ae45e974268"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Negative", "[", 
  RowBox[{"listA", "-", "listB"}], "]"}]], "Input",
 CellChangeTimes->{{3.771088074321496*^9, 3.771088081884233*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"0478d555-4d55-48a5-9e15-a239ca0f803e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.771088083144175*^9, 3.771088115849516*^9, 
  3.771088255043581*^9, 3.7711050784834547`*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"f41290b3-9a92-40e9-8473-bb0e8b29bd5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{"Greater", ",", 
   RowBox[{"{", 
    RowBox[{"listA", ",", "listB"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[211]:=",ExpressionUUID->"441c3372-c065-40a3-8eeb-c40e8fce9924"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.771088231295618*^9, 3.7711050801507053`*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"387a7a37-e5a4-4314-b6a9-1026126201ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Count the # arguments in functions:", "Subsubsection",
 CellChangeTimes->{{3.771093692257164*^9, 3.771093704039006*^9}, {
  3.771100527069023*^9, 
  3.771100530287149*^9}},ExpressionUUID->"968142cc-3908-4fc2-a763-\
1e03ef146791"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "upper___", ",", "function_", ",", "open_", ",", "body___", ",", 
       "close_", ",", "lower___"}], "}"}], "/;", " ", 
     RowBox[{
      RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
      RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], "  ", "\[RuleDelayed]", 
    " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"Length", "@", 
           RowBox[{
            RowBox[{"Cases", "[", "\"\<,\>\"", "]"}], "@", "body"}]}]}], ",", 
         
         RowBox[{"functionargs", "[", "function", "]"}]}], "}"}], "]"}], ",", 
      " ", "body", ",", " ", "lower"}], "}"}]}]}], "//", 
  "TreeForm"}]], "Input",ExpressionUUID->"8597eac9-656e-4954-91f9-\
4cb34d53bcfd"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQA2IQPdF8V3uX2n97btWaqJgjIg6HWa87Xd993T7YRbHo
4RlBON/keI/w2VW8DgxQABFnh8o/t0flw/QzOkDoj3D+jbD4+fz6PA4w82Hi
MPMh9F+4eTA+TB1E/Lv9ESgNE4fxYeoPQN0F8ReLAzof1b3scPvXb/F7Ns9D
GM5HDQd2NHGEu2H21zwz1A7azAW379vlz3+VAwXgfPRwhJkP48PiATX8BOHm
w+RhfIi7xDHkYe4FAFsa05A=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 8}, {2, 3}, {3, 4}, {3, 5}, {5, 6}, {5, 7}, {8, 
       9}, {8, 17}, {8, 18}, {9, 10}, {9, 16}, {10, 11}, {11, 12}, {11, 13}, {
       13, 14}, {13, 15}, {18, 19}, {18, 30}, {19, 20}, {19, 26}, {20, 21}, {
       21, 22}, {21, 23}, {23, 24}, {23, 25}, {26, 27}, {26, 28}, {26, 
       29}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", 
               RowBox[{"{", 
                 RowBox[{"2", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Range\"", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                    "\"10\""}], "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                    "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"[{2, {1, 3}}], {{
            "Range"[{1, {1, 3}}], "10"}, ",", {{
             "Mod"[{2, {2, 3}}], {"#", ",", "3"}}, "&"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", 
           RowBox[{"{", 
             RowBox[{"2", ",", 
               RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[{2, {1, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", 
             RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, {1, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Range\"", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                 "\"10\""}], "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                   "}"}], ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"[{1, {1, 3}}], "10"}, ",", {{
            "Mod"[{2, {2, 3}}], {"#", ",", "3"}}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Range\"", "[", 
               RowBox[{"{", 
                 RowBox[{"1", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             "\"10\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"[{1, {1, 3}}], "10"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"\"Range\"", "[", 
           RowBox[{"{", 
             RowBox[{"1", ",", 
               RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"[{1, {1, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", 
             RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, {1, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Mod\"", "[", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
               "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"[{2, {2, 3}}], {"#", ",", "3"}}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Mod\"", "[", 
               RowBox[{"{", 
                 RowBox[{"2", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"[{2, {2, 3}}], {"#", ",", "3"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox[
         RowBox[{"\"Mod\"", "[", 
           RowBox[{"{", 
             RowBox[{"2", ",", 
               RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"[{2, {2, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", 
             RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, {2, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 22],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 23],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 24],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 25],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 26],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 27],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 28],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 29],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.047058823529411764`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 30],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQA2IQPdF8V3uX2n97btWaqJgjIg6HWa87Xd993T7YRbHo
4RlBON/keI/w2VW8DgxQABFnh8o/t0flw/QzOkDoj3D+jbD4+fz6PA4w82Hi
MPMh9F+4eTA+TB1E/Lv9ESgNE4fxYeoPQN0F8ReLAzof1b3scPvXb/F7Ns9D
GM5HDQd2NHGEu2H21zwz1A7azAW379vlz3+VAwXgfPRwhJkP48PiATX8BOHm
w+RhfIi7xDHkYe4FAFsa05A=
     "]]& ],
  AspectRatio->NCache[4 17^Rational[-1, 2], 0.9701425001453319],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.771100545831553*^9, {3.771100602089704*^9, 3.7711006219335203`*^9}, 
   3.7711006693644533`*^9, {3.771100756712397*^9, 3.771100761777763*^9}, 
   3.771105044095984*^9, {3.771106152563485*^9, 3.7711061761582317`*^9}},
 CellLabel->
  "Out[217]//TreeForm=",ExpressionUUID->"1e84e46c-9437-4379-a9f8-\
034e12570c5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SequenceCases", "[", 
   RowBox[{"myexpr", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"function_", ",", "open_", ",", "body___", ",", "close_"}], 
       "}"}], "/;", " ", 
      RowBox[{
       RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
       RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], "\[RuleDelayed]", " ", 
     
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"function", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"Length", "@", 
            RowBox[{
             RowBox[{"Cases", "[", "\"\<,\>\"", "]"}], "@", "body"}]}]}], ",", 
          RowBox[{"functionargs", "[", "function", "]"}]}], "}"}], "]"}], ",",
        " ", "body", ",", " ", "lower"}], "}"}]}]}], "]"}], " ", "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.7711078704793663`*^9, 3.771107882572031*^9}, {
  3.7711079182268353`*^9, 3.771107993207614*^9}, {3.771108024234396*^9, 
  3.771108077434013*^9}, {3.771108119700891*^9, 3.771108180355529*^9}, {
  3.771108258082206*^9, 3.771108326599306*^9}, {3.7711083578601437`*^9, 
  3.771108386810557*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"c9e904a0-2dc4-4007-b627-44f35e25fdd7"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQzfvlWsy9qQwOn14ev9Q2j88Bxp//9jeLdAung89H
ffP1mVfsITQLnA9R/8+eAQog4l+g6p7Yo/KvwMUh+t7B+aj2sDgoffYMqLzD
6AAzH9WcL/bYxWHu+oJm3hf70veick+/scHNg/hPAM6H+RtdPcx9J14/fB0g
yAPnw/Sjy8PCASYP45t/2uMsoiyMwYfph/hX0AHVf3zw8AAAa7DDCQ==
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {2, 3}, {2, 9}, {2, 26}, {3, 4}, {4, 5}, {4, 6}, {6, 
       7}, {6, 8}, {9, 10}, {9, 15}, {9, 16}, {10, 11}, {10, 12}, {10, 13}, {
       10, 14}, {16, 17}, {16, 25}, {17, 18}, {17, 19}, {17, 20}, {17, 24}, {
       20, 21}, {20, 22}, {20, 23}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"{", 
             RowBox[{
               RowBox[{"\"SortBy\"", "[", 
                 RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                 RowBox[{
                   RowBox[{"{", 
                    
                    RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                    "}"}], ",", "\",\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
               "lower"}], "}"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           
           "SortBy"[{2, {1, 3}}], {{"Range", "[", "10", "]"}, 
            ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, 
             "&"}}, $CellContext`lower}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", 
               RowBox[{"{", 
                 RowBox[{"2", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "lower"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          
          "SortBy"[{2, {1, 3}}], {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, 
            "&"}}, $CellContext`lower}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"\"SortBy\"", "[", 
           RowBox[{"{", 
             RowBox[{"2", ",", 
               RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[{2, {1, 3}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{"2", ",", 
             RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{2, {1, 3}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 22],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 23],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 24],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 25],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["lower",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 26],
        TagBox["lower", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`lower], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQAmIQzfvlWsy9qQwOn14ev9Q2j88Bxp//9jeLdAung89H
ffP1mVfsITQLnA9R/8+eAQog4l+g6p7Yo/KvwMUh+t7B+aj2sDgoffYMqLzD
6AAzH9WcL/bYxWHu+oJm3hf70veick+/scHNg/hPAM6H+RtdPcx9J14/fB0g
yAPnw/Sjy8PCASYP45t/2uMsoiyMwYfph/hX0AHVf3zw8AAAa7DDCQ==
     "]]& ],
  AspectRatio->NCache[Rational[14, 19]^Rational[1, 2], 0.8583950752789521],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.771108396798399*^9},
 CellLabel->
  "Out[251]//TreeForm=",ExpressionUUID->"8fbce235-7dbc-4dc7-8e81-\
1b47dd50ea1b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other stuff:", "Subsubsection",
 CellChangeTimes->{{3.771100537668374*^9, 
  3.771100542814341*^9}},ExpressionUUID->"7b792bbc-5629-4e56-a71e-\
87272bf0be00"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "=", 
   RowBox[{"parseInput", "[", "mystring", "]"}]}], ";", 
  RowBox[{"myexpr", "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.771093750803109*^9, 3.771093757628207*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"3d758b2c-3dab-4938-8711-f40cd1872ed3"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {5, 7}, {5, 8}, {5, 9}, {11, 12}, {11, 20}, {12, 13}, {12, 14}, {
       12, 15}, {12, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
     "]]& ],
  AspectRatio->NCache[Rational[6, 7]^Rational[1, 2], 0.9258200997725514],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.771093718803947*^9, 3.7710937584586887`*^9}, 
   3.771093915699664*^9, 3.771105123310763*^9},
 CellLabel->
  "Out[214]//TreeForm=",ExpressionUUID->"c8592312-538b-4e39-8ee0-\
edf0e3a24f67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.771100287856101*^9, 3.771100288713223*^9}, {
   3.7711004119690313`*^9, 3.77110041797644*^9}, 
   3.771100520943942*^9},ExpressionUUID->"67c0d4ab-0786-4519-b1af-\
3e7a19cf8a0e"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.8086075400626399, 4.043037700313199}, {0., 
    3.2344301602505596`}, {0., 2.42582262018792}, {1.6172150801252798`, 
    3.2344301602505596`}, {0.8086075400626399, 2.42582262018792}, {
    0.40430377003131995`, 1.6172150801252796`}, {0.40430377003131995`, 
    0.8086075400626398}, {1.21291131009396, 1.6172150801252796`}, {
    1.6172150801252798`, 2.42582262018792}, {2.42582262018792, 
    2.42582262018792}, {2.0215188501565997`, 1.6172150801252796`}, {
    1.21291131009396, 0.8086075400626398}, {1.21291131009396, 0.}, {
    2.8301263902192395`, 0.8086075400626398}, {2.0215188501565997`, 0.}, {
    2.8301263902192395`, 0.}, {3.6387339302818797`, 0.}, {2.8301263902192395`,
     1.6172150801252796`}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 4}, {2, 3}, {4, 5}, {4, 9}, {4, 10}, {5, 6}, {5, 
       8}, {6, 7}, {10, 11}, {10, 18}, {11, 12}, {11, 14}, {12, 13}, {14, 
       15}, {14, 16}, {14, 17}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", "2", "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                    "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"[2], {{
            "Range"[1], "10"}, ",", {{
             "Mod"[2], {"#", ",", "3"}}, "&"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", "2", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], "}"}],
              ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                   "}"}], ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"[1], "10"}, ",", {{
            "Mod"[2], {"#", ",", "3"}}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"[1], "10"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"\"Range\"", "[", "1", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"[1]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
               "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"[2], {"#", ",", "3"}}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"[2], {"#", ",", "3"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"\"Mod\"", "[", "2", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"[2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.8086075400626399, 4.043037700313199}, {0., 
     3.2344301602505596`}, {0., 2.42582262018792}, {1.6172150801252798`, 
     3.2344301602505596`}, {0.8086075400626399, 2.42582262018792}, {
     0.40430377003131995`, 1.6172150801252796`}, {0.40430377003131995`, 
     0.8086075400626398}, {1.21291131009396, 1.6172150801252796`}, {
     1.6172150801252798`, 2.42582262018792}, {2.42582262018792, 
     2.42582262018792}, {2.0215188501565997`, 1.6172150801252796`}, {
     1.21291131009396, 0.8086075400626398}, {1.21291131009396, 0.}, {
     2.8301263902192395`, 0.8086075400626398}, {2.0215188501565997`, 0.}, {
     2.8301263902192395`, 0.}, {3.6387339302818797`, 0.}, {
     2.8301263902192395`, 1.6172150801252796`}}]& ],
  AspectRatio->1,
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.771100441448845*^9},
 CellLabel->
  "Out[135]//TreeForm=",ExpressionUUID->"bfa79393-e617-44f2-83f8-\
4465e9145a85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "/.", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<[\>\"", "__"}], "}"}], "\[Rule]", "  ", "\"\<[[\>\""}]}], "//",
   "TreeForm"}]], "Input",
 CellChangeTimes->{{3.771093770370525*^9, 3.771093888936063*^9}, {
  3.771093932886023*^9, 3.771093950479067*^9}, {3.771094038098536*^9, 
  3.7710940825729237`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"eb36adab-d7c9-42a7-bbce-a9bfd709ba18"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {5, 7}, {5, 8}, {5, 9}, {11, 12}, {11, 20}, {12, 13}, {12, 14}, {
       12, 15}, {12, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
     "]]& ],
  AspectRatio->NCache[Rational[6, 7]^Rational[1, 2], 0.9258200997725514],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.771094069241096*^9, 3.77109408330268*^9}},
 CellLabel->
  "Out[35]//TreeForm=",ExpressionUUID->"af537325-0fe0-4dd0-9b52-2c15ad8ec69a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{
    "7", ",", "2", ",", "4", ",", "9", ",", "8", ",", "6", ",", "1", ",", "4",
      ",", "2"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.771094239799467*^9, 3.771094239811817*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"c33131f0-478f-486b-b186-2a5a1a2976f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "//.", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"upper___", ",", "a_", ",", "c_", ",", "b_", ",", "lower___"}], 
     "}"}], "/;", 
    RowBox[{"a", ">", "b"}]}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"upper", ",", "b", ",", "c", ",", "a", ",", "lower"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.77109415504397*^9, 3.771094155052991*^9}, {
  3.771094227230023*^9, 3.771094268535947*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"15c815e3-9e25-4db3-9ca4-2292c8c794b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "2", ",", "4", ",", "4", ",", "6", ",", "7", ",", "9", 
   ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.771094269057334*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"54c26e41-3a06-4778-b999-00e26c90afdf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mynewexpression", "//", "TreeForm"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"c24a5c11-4b7c-4bfd-8f33-a4fdfd7a875d"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQXR2z/97OmX/s1a5NYVprJ+YA4/+ZVD9FTVDYYen8
Kz4Ox9/bLwHT/HB5GD9QclWBcc5L+wAwzQnn/wbrZ3ZggAI/sPhPe5g8jB8A
pdH5MPPUwe5ic4Dx/0DNhZkP42PX/9IeJh+A4s6f9jB3/UFzJ8wedH4Amj9h
9k8y6Tr9cjmLAyw8AK/jf/4=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {2, 3}, {2, 4}, {2, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {6, 7}, {6, 8}, {6, 9}, {11, 12}, {11, 20}, {12, 13}, {13, 14}, {
       13, 15}, {13, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", "[", 
             RowBox[{"\"[\"", ",", 
               RowBox[{"{", 
                 RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"Range\"", "[", 
                    RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], 
                    "}"}], ",", "\",\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
               ",", "\"]\""}], "]"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"["[", {{
             "Range"["[", "10", "]"]}, ",", {{
              "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}}, "]"]}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", 
           RowBox[{"\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Range\"", "[", 
                    RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
             ",", "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"["[", {{
            "Range"["[", "10", "]"]}, ",", {{
             "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}}, "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Range\"", "[", 
                 RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], "}"}],
              ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", "[", 
                    RowBox[{"\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"["[", "10", "]"]}, ",", {{
            "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", "[", 
             RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"["[", "10", "]"]}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"\"Range\"", "[", 
           RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"["[", "10", "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", "[", 
                 RowBox[{"\"[\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                    "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", "[", 
             RowBox[{"\"[\"", ",", 
               RowBox[{"{", 
                 RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
               "\"]\""}], "]"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"["[", {"#", ",", "3"}, "]"]}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"\"Mod\"", "[", 
           RowBox[{"\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"["[", {"#", ",", "3"}, "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQXR2z/97OmX/s1a5NYVprJ+YA4/+ZVD9FTVDYYen8
Kz4Ox9/bLwHT/HB5GD9QclWBcc5L+wAwzQnn/wbrZ3ZggAI/sPhPe5g8jB8A
pdH5MPPUwe5ic4Dx/0DNhZkP42PX/9IeJh+A4s6f9jB3/UFzJ8wedH4Amj9h
9k8y6Tr9cjmLAyw8AK/jf/4=
     "]]& ],
  AspectRatio->NCache[2 Rational[2, 5]^Rational[1, 2], 1.2649110640673518`],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7710964669034443`*^9, {3.771097200488262*^9, 3.7710972292882767`*^9}},
 CellLabel->
  "Out[59]//TreeForm=",ExpressionUUID->"f9e4eea6-6178-482e-a846-0c99576ff7cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "upper___", ",", "function_", ",", "open_", ",", "body___", ",", 
        "close_", ",", "lower___"}], "}"}], "/;", " ", 
      RowBox[{
       RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
       RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], " ", "/;", " ", 
     RowBox[{"Echo", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"function", ",", " ", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AtomQ", "[", "body", "]"}]}], "/.", 
          RowBox[{
           RowBox[{"bodypart_", "/;", 
            RowBox[{"!", 
             RowBox[{"AtomQ", "[", "bodypart", "]"}]}]}], "\[RuleDelayed]", 
           RowBox[{"ToString", "[", 
            RowBox[{"Head", "[", "bodypart", "]"}], "]"}]}]}]}], " ", "}"}], 
       ",", "\"\<Body:\>\""}], "]"}]}], "\[RuleDelayed]", " ", 
    RowBox[{"{", 
     RowBox[{
     "upper", ",", " ", "function", ",", " ", "body", ",", " ", "lower"}], 
     "}"}]}]}], "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.771095653119768*^9, 3.771095817421691*^9}, {
  3.77109586563848*^9, 3.771095866737011*^9}, {3.771095990106599*^9, 
  3.7710959914055023`*^9}, {3.771096042256784*^9, 3.771096061322854*^9}, {
  3.771096484114469*^9, 3.771096487688505*^9}, {3.771099108709902*^9, 
  3.7710991124201937`*^9}, {3.771099171456294*^9, 3.771099279556621*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"4442aa7e-a576-4f59-b637-7f96e3bf458c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Body:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{"\<\"SortBy\"\>", ",", "True"}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.771099298727902*^9},ExpressionUUID->"e1965e71-bab9-4d99-bf19-\
85b9b4c1eb6a"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Body:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{"\<\"Range\"\>", ",", "False"}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.7710992987988873`*^9},ExpressionUUID->"3a9b11df-ac88-4955-9256-\
ed9589aad04a"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Body:\"\>",
   "EchoLabel"], " ", 
  RowBox[{"{", 
   RowBox[{"\<\"Mod\"\>", ",", "True"}], "}"}]}]], "Echo",
 CellChangeTimes->{
  3.7710992988353148`*^9},ExpressionUUID->"31f7f2a9-c6d6-4af1-a205-\
4c718f958e7d"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.771100210365686*^9},ExpressionUUID->"535c5026-367d-4057-ae39-\
23eff2d57ec5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myexpr", "//.", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "upper___", ",", "function_", ",", "open_", ",", "body___", ",", 
       "close_", ",", "lower___"}], "}"}], "/;", " ", 
     RowBox[{
      RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
      RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], "  ", "\[RuleDelayed]", 
    " ", 
    RowBox[{"{", 
     RowBox[{"upper", ",", " ", 
      RowBox[{"function", "[", 
       RowBox[{"1", "+", 
        RowBox[{"Length", "@", 
         RowBox[{
          RowBox[{"Cases", "[", "\"\<,\>\"", "]"}], "@", "body"}]}]}], "]"}], 
      ",", " ", "body", ",", " ", "lower"}], "}"}]}]}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{
  3.771099515517374*^9, {3.771099556334687*^9, 3.77109956269461*^9}, {
   3.7710996938908873`*^9, 3.771099743045671*^9}, {3.771100060976138*^9, 
   3.771100082718751*^9}, {3.771100160887362*^9, 3.771100184366568*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"65c540b3-3257-4e45-af3e-4105e8f22fc3"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{0.8086075400626399, 4.043037700313199}, {0., 
    3.2344301602505596`}, {0., 2.42582262018792}, {1.6172150801252798`, 
    3.2344301602505596`}, {0.8086075400626399, 2.42582262018792}, {
    0.40430377003131995`, 1.6172150801252796`}, {0.40430377003131995`, 
    0.8086075400626398}, {1.21291131009396, 1.6172150801252796`}, {
    1.6172150801252798`, 2.42582262018792}, {2.42582262018792, 
    2.42582262018792}, {2.0215188501565997`, 1.6172150801252796`}, {
    1.21291131009396, 0.8086075400626398}, {1.21291131009396, 0.}, {
    2.8301263902192395`, 0.8086075400626398}, {2.0215188501565997`, 0.}, {
    2.8301263902192395`, 0.}, {3.6387339302818797`, 0.}, {2.8301263902192395`,
     1.6172150801252796`}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 4}, {2, 3}, {4, 5}, {4, 9}, {4, 10}, {5, 6}, {5, 
       8}, {6, 7}, {10, 11}, {10, 18}, {11, 12}, {11, 14}, {12, 13}, {14, 
       15}, {14, 16}, {14, 17}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", "2", "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                    "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"[2], {{
            "Range"[1], "10"}, ",", {{
             "Mod"[2], {"#", ",", "3"}}, "&"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", "2", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], "}"}],
              ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
                   "}"}], ",", "\"&\""}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"[1], "10"}, ",", {{
            "Mod"[2], {"#", ",", "3"}}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Range\"", "[", "1", "]"}], ",", "\"10\""}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"[1], "10"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"\"Range\"", "[", "1", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"[1]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], 
               "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"[2], {"#", ",", "3"}}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"Mod\"", "[", "2", "]"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"[2], {"#", ",", "3"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"\"Mod\"", "[", "2", "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"[2]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.8086075400626399, 4.043037700313199}, {0., 
     3.2344301602505596`}, {0., 2.42582262018792}, {1.6172150801252798`, 
     3.2344301602505596`}, {0.8086075400626399, 2.42582262018792}, {
     0.40430377003131995`, 1.6172150801252796`}, {0.40430377003131995`, 
     0.8086075400626398}, {1.21291131009396, 1.6172150801252796`}, {
     1.6172150801252798`, 2.42582262018792}, {2.42582262018792, 
     2.42582262018792}, {2.0215188501565997`, 1.6172150801252796`}, {
     1.21291131009396, 0.8086075400626398}, {1.21291131009396, 0.}, {
     2.8301263902192395`, 0.8086075400626398}, {2.0215188501565997`, 0.}, {
     2.8301263902192395`, 0.}, {3.6387339302818797`, 0.}, {
     2.8301263902192395`, 1.6172150801252796`}}]& ],
  AspectRatio->1,
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.77110013513527*^9, 3.771100186061811*^9}},
 CellLabel->
  "Out[133]//TreeForm=",ExpressionUUID->"5225a11d-6d32-48f9-b545-\
0473275fa30b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myexpr", "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.77110685518368*^9, 3.771106860881681*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"3c6dde97-08c7-4313-b858-6ef65d2e5f23"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {5, 7}, {5, 8}, {5, 9}, {11, 12}, {11, 20}, {12, 13}, {12, 14}, {
       12, 15}, {12, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
     "]]& ],
  AspectRatio->NCache[Rational[6, 7]^Rational[1, 2], 0.9258200997725514],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.771106857726612*^9, 3.771106861456983*^9}},
 CellLabel->
  "Out[225]//TreeForm=",ExpressionUUID->"a4133707-55d7-40f0-87f5-\
6789c0db059b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"myexpr", ",", 
   RowBox[{"{", 
    RowBox[{
    "upper___", ",", "function_", ",", "open_", ",", "body___", ",", "close_",
      ",", "lower___"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771106801351709*^9, 3.771106838420454*^9}, {
  3.7711068830041037`*^9, 3.7711069297469482`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"4f8a7544-1919-4165-b10c-722d193f39b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
      ",", "\<\"]\"\>"}], "}"}], ",", "\<\",\"\>", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
        RowBox[{"{", 
         RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
        ",", "\<\"]\"\>"}], "}"}], ",", "\<\"&\"\>"}], "}"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.771106820822096*^9, 3.77110683315289*^9}, {
  3.7711068924545307`*^9, 3.77110693033786*^9}},
 CellLabel->
  "Out[234]=",ExpressionUUID->"0ecef024-b4cb-46eb-bbce-9921885def42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mynewexpression", "=", 
  RowBox[{
   RowBox[{"myexpr", "//.", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "upper___", ",", "function_", ",", "open_", ",", "body___", ",", 
        "close_", ",", "lower___"}], "}"}], "/;", " ", 
      RowBox[{
       RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
       RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}], " ", "\[RuleDelayed]", 
     " ", 
     RowBox[{"{", 
      RowBox[{"upper", ",", " ", 
       RowBox[{"function", "[", 
        RowBox[{"\"\<[\>\"", ",", " ", "body", ",", "\"\<]\>\""}], "]"}], ",",
        " ", "lower"}], "}"}]}]}], "//", "TreeForm"}]}]], "Input",
 CellChangeTimes->{{3.7710962896203737`*^9, 3.771096312595347*^9}, {
   3.771096416472982*^9, 3.7710964634536448`*^9}, {3.7710964952398252`*^9, 
   3.7710965250568447`*^9}, {3.771096963988206*^9, 3.771097048890954*^9}, {
   3.771097193305029*^9, 3.771097212093*^9}, 3.7710980333130093`*^9, {
   3.7710981919419727`*^9, 3.771098233667347*^9}, {3.7710986414251204`*^9, 
   3.771098644530498*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"94e04275-0011-472c-9db3-4136f6c8690b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQXR2z/97OmX/s1a5NYVprJ+YA4/+ZVD9FTVDYYen8
Kz4Ox9/bLwHT/HB5GD9QclWBcc5L+wAwzQnn/wbrZ3ZggAI/sPhPe5g8jB8A
pdH5MPPUwe5ic4Dx/0DNhZkP42PX/9IeJh+A4s6f9jB3/UFzJ8wedH4Amj9h
9k8y6Tr9cjmLAyw8AK/jf/4=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {2, 3}, {2, 4}, {2, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {6, 7}, {6, 8}, {6, 9}, {11, 12}, {11, 20}, {12, 13}, {13, 14}, {
       13, 15}, {13, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", "[", 
             RowBox[{"\"[\"", ",", 
               RowBox[{"{", 
                 RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"Range\"", "[", 
                    RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], 
                    "}"}], ",", "\",\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
               ",", "\"]\""}], "]"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "SortBy"["[", {{
             "Range"["[", "10", "]"]}, ",", {{
              "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}}, "]"]}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"\"SortBy\"", "[", 
           RowBox[{"\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Range\"", "[", 
                    RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", "[", 
                    RowBox[{"\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
             ",", "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"["[", {{
            "Range"["[", "10", "]"]}, ",", {{
             "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}}, "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Range\"", "[", 
                 RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], "}"}],
              ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", "[", 
                    RowBox[{"\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Range"["[", "10", "]"]}, ",", {{
            "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", "[", 
             RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Range"["[", "10", "]"]}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Range\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"\"Range\"", "[", 
           RowBox[{"\"[\"", ",", "\"10\"", ",", "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Range"["[", "10", "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", "[", 
                 RowBox[{"\"[\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                    "\"]\""}], "]"}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           "Mod"["[", {"#", ",", "3"}, "]"]}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", "[", 
             RowBox[{"\"[\"", ",", 
               RowBox[{"{", 
                 RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
               "\"]\""}], "]"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          "Mod"["[", {"#", ",", "3"}, "]"]}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"Mod\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"\"Mod\"", "[", 
           RowBox[{"\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "Mod"["[", {"#", ",", "3"}, "]"]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQXR2z/97OmX/s1a5NYVprJ+YA4/+ZVD9FTVDYYen8
Kz4Ox9/bLwHT/HB5GD9QclWBcc5L+wAwzQnn/wbrZ3ZggAI/sPhPe5g8jB8A
pdH5MPPUwe5ic4Dx/0DNhZkP42PX/9IeJh+A4s6f9jB3/UFzJ8wedH4Amj9h
9k8y6Tr9cjmLAyw8AK/jf/4=
     "]]& ],
  AspectRatio->NCache[2 Rational[2, 5]^Rational[1, 2], 1.2649110640673518`],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.7710986450407143`*^9},
 CellLabel->
  "Out[91]//TreeForm=",ExpressionUUID->"bb1de249-4fee-4829-bf19-71473d6f1c22"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"/;", 
   RowBox[{"Echo", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"body", ",", 
       RowBox[{"Length", "[", "body", "]"}]}], "}"}], ",", 
     "\"\<Body Length\>\""}], "]"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.771097215775105*^9, 
  3.7710972220179777`*^9}},ExpressionUUID->"aa5a3f0a-f5ea-48dc-a21e-\
a9269c0d4f15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myexpr", "//", "TreeForm"}]], "Input",
 CellChangeTimes->{{3.77109735725399*^9, 3.771097361899877*^9}, {
   3.77109804717027*^9, 3.771098051688448*^9}, 3.771098202350255*^9, {
   3.771098284487322*^9, 3.771098288431857*^9}, {3.77109867105797*^9, 
   3.7710986774623528`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"6a322388-9e24-4331-a65f-39728e700008"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 21}, {4, 5}, {4, 10}, {4, 11}, {5, 
       6}, {5, 7}, {5, 8}, {5, 9}, {11, 12}, {11, 20}, {12, 13}, {12, 14}, {
       12, 15}, {12, 19}, {15, 16}, {15, 17}, {15, 18}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"SortBy\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "SortBy", 
          "[", {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}, "]"}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"SortBy\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"SortBy\"", HoldForm]],
       Annotation[#, 
        HoldForm["SortBy"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQrXX8ZU9o6297CM3tsJt1d4ELyzN7CM0G5X+D831c
ekKMmxkcUPkf7GHiDFCwB0XfM3tU/jc4H6YPxoe5ByZenHbp35kjHBj2oqvf
A7WHZeniR7udmR1gfJh+dHmYO2HyMP4jdUbpe658GHyYflg47UELFxgNAGuM
fVc=
     "]]& ],
  AspectRatio->NCache[Rational[6, 7]^Rational[1, 2], 0.9258200997725514],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.771097358622713*^9, 3.771097362187951*^9}, {
   3.771098276976783*^9, 3.771098289028453*^9}, 3.7710986778144093`*^9},
 CellLabel->
  "Out[92]//TreeForm=",ExpressionUUID->"69448723-0d11-49e0-bac1-d63c4c83bc39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cases", "[", 
   RowBox[{"myexpr", ",", 
    RowBox[{"{", 
     RowBox[{"___", ",", "open_", ",", "body___", ",", "close_", ",", "___"}],
      "}"}], ",", 
    RowBox[{"Depth", "[", "myexpr", "]"}]}], "]"}], "//", "Column"}]], "Input",\

 CellChangeTimes->{{3.7710975975791903`*^9, 3.77109769676134*^9}, {
  3.771097827179023*^9, 3.771097836665967*^9}, {3.771097948489615*^9, 
  3.7710979607106657`*^9}, {3.7710980671149397`*^9, 3.771098131616016*^9}, {
  3.771098839006569*^9, 3.771098929585428*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"38674d8e-ed32-4dc9-aa3f-f84be66368d4"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
       RowBox[{"{", 
        RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
       ",", "\<\"]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
         RowBox[{"{", 
          RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
         ",", "\<\"]\"\>"}], "}"}], ",", "\<\"&\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"Range\"\>", ",", "\<\"[\"\>", ",", "\<\"10\"\>", 
         ",", "\<\"]\"\>"}], "}"}], ",", "\<\",\"\>", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"Mod\"\>", ",", "\<\"[\"\>", ",", 
           RowBox[{"{", 
            RowBox[{"\<\"#\"\>", ",", "\<\",\"\>", ",", "\<\"3\"\>"}], "}"}], 
           ",", "\<\"]\"\>"}], "}"}], ",", "\<\"&\"\>"}], "}"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.771097662420046*^9, 3.771097697096024*^9}, {
  3.771098833084075*^9, 3.7710989331842813`*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"5003cce1-3f80-416c-8bb4-e3ff8a2cd008"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.771097624735146*^9, 
  3.771097636142562*^9}},ExpressionUUID->"097fef6a-aa14-4b5d-affe-\
b36d0c2ecc13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"/;", " ", 
  RowBox[{
   RowBox[{"open", "\[Equal]", "\"\<[\>\""}], "&&", 
   RowBox[{"close", "\[Equal]", "\"\<]\>\""}]}]}]], "Input",ExpressionUUID->\
"21a6df63-4543-4a03-b19c-d1a047fdb96b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQbfnuydn3J/7apwb7FfDZCzjA+CtMdXcfEuZ2aD+y
d2rGyqv2bWCaFc6HqGdwYIACiPxXe4j8U3tU/lX7Fqg4RN8HOH8l1B6Y+d+4
2ZqtvzA5wMxvh5oDMw8mjmo+K5yPat5Xe4na0hVT4zjg5q3TX/VzyUxBOB/m
b3T1MPdBwoMXzofpR5eHhQNMHsa3e5HIc8lPBIMP0w/xrxDcfgAvn7a4
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {2, 3}, {2, 9}, {3, 4}, {4, 5}, {4, 6}, {6, 7}, {6, 
       8}, {9, 10}, {9, 15}, {9, 16}, {10, 11}, {10, 12}, {10, 13}, {10, 
       14}, {16, 17}, {16, 25}, {17, 18}, {17, 19}, {17, 20}, {17, 24}, {20, 
       21}, {20, 22}, {20, 23}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"{", 
             RowBox[{
               RowBox[{"\"SortBy\"", "[", 
                 RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                 RowBox[{
                   RowBox[{"{", 
                    
                    RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                    "}"}], ",", "\",\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], 
             "}"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{
           
           "SortBy"[{1, {0, 0}}], {{"Range", "[", "10", "]"}, 
            ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"\"SortBy\"", "[", 
               RowBox[{"{", 
                 RowBox[{"1", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   
                   RowBox[{
                    "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
                   "}"}], ",", "\",\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}]}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
          
          "SortBy"[{1, {0, 0}}], {{"Range", "[", "10", "]"}, 
           ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["\<\"SortBy\"\>", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"\"SortBy\"", "[", 
           RowBox[{"{", 
             RowBox[{"1", ",", 
               RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], HoldForm]],
       Annotation[#, 
        HoldForm[
         "SortBy"[{1, {0, 0}}]], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{"1", ",", 
             RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{1, {0, 0}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["1",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["1", HoldForm]],
       Annotation[#, 
        HoldForm[1], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{0, 0}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["0",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["0", HoldForm]],
       Annotation[#, 
        HoldForm[0], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["0",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["0", HoldForm]],
       Annotation[#, 
        HoldForm[0], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               
               RowBox[{
                "\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
               "}"}], ",", "\",\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",",
                     "\"]\""}], "}"}], ",", "\"&\""}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{"Range", "[", "10", "]"}, 
          ",", {{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Range\"", ",", "\"[\"", ",", "\"10\"", ",", "\"]\""}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Range", "[", "10", "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Range\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"Range\"", HoldForm]],
       Annotation[#, 
        HoldForm["Range"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"10\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["\"10\"", HoldForm]],
       Annotation[#, 
        HoldForm["10"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
                 RowBox[{"{", 
                   RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
                 "\"]\""}], "}"}], ",", "\"&\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"Mod", "[", {"#", ",", "3"}, "]"}, "&"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"Mod\"", ",", "\"[\"", ",", 
             RowBox[{"{", 
               RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], ",", 
             "\"]\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"Mod", "[", {"#", ",", "3"}, "]"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"Mod\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["\"Mod\"", HoldForm]],
       Annotation[#, 
        HoldForm["Mod"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"[\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox["\"[\"", HoldForm]],
       Annotation[#, 
        HoldForm["["], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"#\"", ",", "\",\"", ",", "\"3\""}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"#", ",", "3"}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"#\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["\"#\"", HoldForm]],
       Annotation[#, 
        HoldForm["#"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\",\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 22],
        TagBox["\",\"", HoldForm]],
       Annotation[#, 
        HoldForm[","], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"3\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 23],
        TagBox["\"3\"", HoldForm]],
       Annotation[#, 
        HoldForm["3"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"]\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 24],
        TagBox["\"]\"", HoldForm]],
       Annotation[#, 
        HoldForm["]"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"&\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.042105263157894736`],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 25],
        TagBox["\"&\"", HoldForm]],
       Annotation[#, 
        HoldForm["&"], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQBGIQbfnuydn3J/7apwb7FfDZCzjA+CtMdXcfEuZ2aD+y
d2rGyqv2bWCaFc6HqGdwYIACiPxXe4j8U3tU/lX7Fqg4RN8HOH8l1B6Y+d+4
2ZqtvzA5wMxvh5oDMw8mjmo+K5yPat5Xe4na0hVT4zjg5q3TX/VzyUxBOB/m
b3T1MPdBwoMXzofpR5eHhQNMHsa3e5HIc8lPBIMP0w/xrxDcfgAvn7a4
     "]]& ],
  AspectRatio->NCache[Rational[14, 19]^Rational[1, 2], 0.8583950752789521],
  FormatType:>StandardForm,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.771108053668494*^9, {3.771108133267572*^9, 3.7711081403745193`*^9}, {
   3.7711081755174*^9, 3.771108180815291*^9}},
 CellLabel->
  "Out[245]//TreeForm=",ExpressionUUID->"b1bee4d2-abef-422a-a1dd-\
256dace3b487"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.77110799498168*^9, 
  3.771108019690125*^9}},ExpressionUUID->"b5ab9e8f-e149-40e1-939b-\
9f2c26f5cf60"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7711081515923758`*^9, 
  3.771108159076624*^9}},ExpressionUUID->"9a3b361e-55b3-4bb5-9415-\
8bdf90e868b1"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 67, "Section",ExpressionUUID->"3191dbce-93fd-4477-884c-0bff78e6c4b9"],
Cell[742, 27, 230, 5, 30, "Input",ExpressionUUID->"470bf7bb-3068-49b4-b635-b9d8a8e24da4"],
Cell[975, 34, 388, 8, 52, "Input",ExpressionUUID->"f4c25372-018e-4a88-9017-7a9edcee4526"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1400, 47, 169, 3, 67, "Section",ExpressionUUID->"7331da9b-b925-4dd3-8495-7eb515484d10"],
Cell[CellGroupData[{
Cell[1594, 54, 158, 3, 54, "Subsection",ExpressionUUID->"408358db-aa51-4816-abf9-7a8cd577489b"],
Cell[1755, 59, 293, 7, 30, "Input",ExpressionUUID->"060d984e-2d88-42ac-a8b3-544f57902d7d"],
Cell[2051, 68, 274, 5, 30, "Input",ExpressionUUID->"c204456e-1188-448a-bd1f-355c13e53473"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2362, 78, 168, 3, 54, "Subsection",ExpressionUUID->"21c511ce-cd28-4abe-8aef-bb58362f5c9d"],
Cell[2533, 83, 230, 5, 30, "Input",ExpressionUUID->"b88e4ffb-ac8e-4f35-854c-b3ef5db68881"],
Cell[2766, 90, 305, 7, 30, "Input",ExpressionUUID->"00518618-672c-47ac-bf01-37770ed1eedd"],
Cell[3074, 99, 464, 11, 30, "Input",ExpressionUUID->"82c72c5c-a1c4-4572-bbb8-c226b9452f68"],
Cell[3541, 112, 779, 21, 52, "Input",ExpressionUUID->"27a515f1-16ae-4e23-8ec6-3600a682bb1f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4369, 139, 177, 3, 67, "Section",ExpressionUUID->"4f2eba4f-5ed5-41bd-863b-4a5d84b2a192"],
Cell[4549, 144, 225, 4, 30, "Input",ExpressionUUID->"2ebfdf41-6723-4414-a1b3-5460e5dde60b"],
Cell[CellGroupData[{
Cell[4799, 152, 244, 6, 45, "Subsubsection",ExpressionUUID->"acfd93ad-a969-4bde-aea4-49cbbde656e6"],
Cell[5046, 160, 732, 19, 30, "Input",ExpressionUUID->"9315a528-e6c6-4c5f-9650-8742d494f6f6"],
Cell[5781, 181, 731, 20, 30, "Input",ExpressionUUID->"11cb3a39-056b-4148-a563-87f74e3992e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6549, 206, 182, 3, 45, "Subsubsection",ExpressionUUID->"df132a6e-dbce-43bf-b230-48b0ef57369d"],
Cell[6734, 211, 1109, 27, 30, "Input",ExpressionUUID->"a499241e-93bb-4de0-9165-3acb03cb532d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7880, 243, 198, 3, 45, "Subsubsection",ExpressionUUID->"d96fc860-14ff-492b-ac46-6f71c934b734"],
Cell[8081, 248, 456, 13, 30, "Input",ExpressionUUID->"5f0b3a75-d452-420e-8a01-3ea25be17c4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8574, 266, 296, 7, 45, "Subsubsection",ExpressionUUID->"2cd03372-1dd5-4bb8-9c06-690450722bbf"],
Cell[8873, 275, 929, 28, 30, "Input",ExpressionUUID->"09dc6fc4-37ec-484f-9e9c-57a45393165e"],
Cell[9805, 305, 1293, 33, 52, "Input",ExpressionUUID->"1b1a3bda-aee8-4d64-8c54-6620ec47b4c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11135, 343, 238, 4, 45, "Subsubsection",ExpressionUUID->"2e6eee46-e43a-41ce-adb4-5c5b1aa9698e"],
Cell[11376, 349, 391, 9, 30, "Input",ExpressionUUID->"c232d318-9cc0-4505-96ed-93c5e419fcc6"],
Cell[CellGroupData[{
Cell[11792, 362, 250, 5, 30, "Input",ExpressionUUID->"9ce541ae-5b2e-440f-b948-56a44a9a0563"],
Cell[12045, 369, 16144, 443, 322, "Output",ExpressionUUID->"5e2ce31c-c1d9-4df3-93a1-6aef7f2f9ba7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28226, 817, 252, 5, 30, "Input",ExpressionUUID->"d0b6fa73-7bab-4132-8ff3-b53bcf023f7f"],
Cell[28481, 824, 16805, 471, 361, "Output",ExpressionUUID->"615dadbb-0fe2-454e-b9b1-acb8915c8a13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45323, 1300, 367, 8, 30, "Input",ExpressionUUID->"e8b1f735-3ab1-4b3c-a98b-47837effb613"],
Cell[45693, 1310, 1072, 29, 105, "Output",ExpressionUUID->"8e642136-22e1-4b52-b4a9-0ca586509726"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46802, 1344, 792, 17, 30, "Input",ExpressionUUID->"e6ef3c6e-88bd-4cbf-ab67-649ec8f27349"],
Cell[47597, 1363, 493, 9, 34, "Output",ExpressionUUID->"5cbca1b3-3c6a-4dc3-af07-e662dc62bc52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48127, 1377, 454, 12, 30, "Input",ExpressionUUID->"1b4aa7e7-0347-44eb-b30e-429f6326a2d3"],
Cell[48584, 1391, 442, 8, 34, "Output",ExpressionUUID->"d2fc199d-00a6-41ed-93ce-e3f75eb52455"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49063, 1404, 243, 5, 30, "Input",ExpressionUUID->"3cf6ce29-13e4-4c14-a553-f46511eddf71"],
Cell[49309, 1411, 417, 8, 34, "Output",ExpressionUUID->"a6246607-a2bc-489e-a52c-3ae45e974268"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49763, 1424, 241, 5, 30, "Input",ExpressionUUID->"0478d555-4d55-48a5-9e15-a239ca0f803e"],
Cell[50007, 1431, 322, 7, 34, "Output",ExpressionUUID->"f41290b3-9a92-40e9-8473-bb0e8b29bd5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50366, 1443, 231, 6, 30, "Input",ExpressionUUID->"441c3372-c065-40a3-8eeb-c40e8fce9924"],
Cell[50600, 1451, 275, 6, 34, "Output",ExpressionUUID->"387a7a37-e5a4-4314-b6a9-1026126201ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50924, 1463, 235, 4, 45, "Subsubsection",ExpressionUUID->"968142cc-3908-4fc2-a763-1e03ef146791"],
Cell[CellGroupData[{
Cell[51184, 1471, 899, 26, 52, "Input",ExpressionUUID->"8597eac9-656e-4954-91f9-4cb34d53bcfd"],
Cell[52086, 1499, 25320, 700, 377, "Output",ExpressionUUID->"1e84e46c-9437-4379-a9f8-034e12570c5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77443, 2204, 1240, 31, 52, "Input",ExpressionUUID->"c9e904a0-2dc4-4007-b627-44f35e25fdd7"],
Cell[78686, 2237, 21865, 599, 337, "Output",ExpressionUUID->"8fbce235-7dbc-4dc7-8e81-1b47dd50ea1b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100600, 2842, 163, 3, 45, "Subsubsection",ExpressionUUID->"7b792bbc-5629-4e56-a71e-87272bf0be00"],
Cell[CellGroupData[{
Cell[100788, 2849, 307, 7, 30, "Input",ExpressionUUID->"3d758b2c-3dab-4938-8711-f40cd1872ed3"],
Cell[101098, 2858, 16639, 468, 361, "Output",ExpressionUUID->"c8592312-538b-4e39-8ee0-edf0e3a24f67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117774, 3331, 226, 4, 30, "Input",ExpressionUUID->"67c0d4ab-0786-4519-b1af-3e7a19cf8a0e"],
Cell[118003, 3337, 15540, 426, 387, "Output",ExpressionUUID->"bfa79393-e617-44f2-83f8-4465e9145a85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133580, 3768, 439, 10, 30, "Input",ExpressionUUID->"eb36adab-d7c9-42a7-bbce-a9bfd709ba18"],
Cell[134022, 3780, 16585, 466, 361, "Output",ExpressionUUID->"af537325-0fe0-4dd0-9b52-2c15ad8ec69a"]
}, Open  ]],
Cell[150622, 4249, 345, 8, 30, "Input",ExpressionUUID->"c33131f0-478f-486b-b186-2a5a1a2976f0"],
Cell[CellGroupData[{
Cell[150992, 4261, 522, 13, 30, "Input",ExpressionUUID->"15c815e3-9e25-4db3-9ca4-2292c8c794b2"],
Cell[151517, 4276, 271, 6, 34, "Output",ExpressionUUID->"54c26e41-3a06-4778-b999-00e26c90afdf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151825, 4287, 150, 2, 30, "Input",ExpressionUUID->"c24a5c11-4b7c-4bfd-8f33-a4fdfd7a875d"],
Cell[151978, 4291, 17970, 497, 460, "Output",ExpressionUUID->"f9e4eea6-6178-482e-a846-0c99576ff7cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169985, 4793, 1539, 37, 52, "Input",ExpressionUUID->"4442aa7e-a576-4f59-b637-7f96e3bf458c"],
Cell[CellGroupData[{
Cell[171549, 4834, 252, 8, 25, "Echo",ExpressionUUID->"e1965e71-bab9-4d99-bf19-85b9b4c1eb6a"],
Cell[171804, 4844, 254, 8, 25, "Echo",ExpressionUUID->"3a9b11df-ac88-4955-9256-ed9589aad04a"],
Cell[172061, 4854, 251, 8, 25, "Echo",ExpressionUUID->"31f7f2a9-c6d6-4af1-a205-4c718f958e7d"]
}, Open  ]]
}, Open  ]],
Cell[172339, 4866, 128, 3, 30, "Input",ExpressionUUID->"535c5026-367d-4057-ae39-23eff2d57ec5"],
Cell[CellGroupData[{
Cell[172492, 4873, 1049, 27, 52, "Input",ExpressionUUID->"65c540b3-3257-4e45-af3e-4105e8f22fc3"],
Cell[173544, 4902, 15563, 426, 387, "Output",ExpressionUUID->"5225a11d-6d32-48f9-b545-0473275fa30b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189144, 5333, 210, 4, 30, "Input",ExpressionUUID->"3c6dde97-08c7-4313-b858-6ef65d2e5f23"],
Cell[189357, 5339, 16589, 467, 361, "Output",ExpressionUUID->"a4133707-55d7-40f0-87f5-6789c0db059b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205983, 5811, 425, 10, 30, "Input",ExpressionUUID->"4f8a7544-1919-4165-b10c-722d193f39b1"],
Cell[206411, 5823, 693, 18, 34, "Output",ExpressionUUID->"0ecef024-b4cb-46eb-bbce-9921885def42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207141, 5846, 1152, 25, 30, "Input",ExpressionUUID->"94e04275-0011-472c-9db3-4136f6c8690b"],
Cell[208296, 5873, 17919, 496, 460, "Output",ExpressionUUID->"bb1de249-4fee-4829-bf19-71473d6f1c22"]
}, Open  ]],
Cell[226230, 6372, 381, 11, 30, "Input",ExpressionUUID->"aa5a3f0a-f5ea-48dc-a21e-a9269c0d4f15"],
Cell[CellGroupData[{
Cell[226636, 6387, 378, 6, 30, "Input",ExpressionUUID->"6a322388-9e24-4331-a65f-39728e700008"],
Cell[227017, 6395, 16660, 467, 361, "Output",ExpressionUUID->"69448723-0d11-49e0-bac1-d63c4c83bc39"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243714, 6867, 616, 13, 30, "Input",ExpressionUUID->"38674d8e-ed32-4dc9-aa3f-f84be66368d4"],
Cell[244333, 6882, 1614, 43, 105, "Output",ExpressionUUID->"5003cce1-3f80-416c-8bb4-e3ff8a2cd008"]
}, Open  ]],
Cell[245962, 6928, 152, 3, 30, "Input",ExpressionUUID->"097fef6a-aa14-4b5d-affe-b36d0c2ecc13"],
Cell[CellGroupData[{
Cell[246139, 6935, 216, 5, 30, "Input",ExpressionUUID->"21a6df63-4543-4a03-b19c-d1a047fdb96b"],
Cell[246358, 6942, 21187, 580, 337, "Output",ExpressionUUID->"b1bee4d2-abef-422a-a1dd-256dace3b487"]
}, Open  ]],
Cell[267560, 7525, 151, 3, 30, "Input",ExpressionUUID->"b5ab9e8f-e149-40e1-939b-9f2c26f5cf60"],
Cell[267714, 7530, 154, 3, 30, "Input",ExpressionUUID->"9a3b361e-55b3-4bb5-9415-8bdf90e868b1"]
}, Open  ]]
}, Open  ]]
}
]
*)

